================================================================================
Changeset 338 @ 2015.01.09

Tasks Managers - by Hasha

General
    - Task managers are using directly Runnable interface, not nested class anymore.
    - Iteration methods are changed from for-each to iterator -> support element removal during iteration.

AttackStanceTaskManager
PvpFlagTaskManager
WaterTaskManager
    - Use of Map.Entry instead of keySet() / get(), leading to an performance boost on all existing tasks.

DecayTaskManager
    - Moved checks for decay delay to "add" method; iteration compares and doesn't calculate.
    - Added new method for corpse action (Corpse Drain Life, Harvest, Sweep).

GameTimeTaskManager
    - New manager created from 2 sources.
    - Implements old TakeBreakTaskManager, to notify long activity for players.
    - Implements ingame time system from old GameTimeController, to handle day/night cycle && spawns, plus Shadow Sense skill.

ItemsOnGroundTaskManager
    - New manager created from 2 sources.
    - Implements old ItemsAutoDestroyTaskManager to destroy items on ground.
    - Implements old ItemsOnGroundManager, to save dropped items on ground.
    - New configs, which are more logical and have better usage.
    - Reworked drop methods to support new interface of the manager.
    - The processes of save/load items to/from database are simplified.
    - Cursed weapons can be now picked by anyone, no longer drop-protected to killer/killer party.

KnownListUpdateTaskManager
    - Fix a bug which was forcing all regions to update knownlist, when at least 1 player was detected in a region.
    - Full update for NPCs is performed much more often now, since there are NPCs, which need it (e.g. Cabale buffers).
    - Cleanup/sort all knownlist classes.

MovementTaskManager
    - Created from old GameTimeController.
    - Handles only characters movement (keep max priority thread design).
    - Remove game time ticks system, everything is calculated using real time (attack, bow attack, cast break, movement, etc) -> leading to:
        - Improved accuracy of movement, thought there is still issue with it (requires next rework).
        - Fixed bow attack delay with high attack speed.
        - Fixed bow attack & skill cast/movement, skill is now casted/movement is performed after bow attack is completed.

ShadowItemTaskManager
    - New manager.
    - No longer 1 created task per equipped shadow item, shadow items are now handled by a single task.
    - Mana ticking is now handled with higher precision (each second instead of each minute).
    - Thanks to previous, equip/unequip/equip a shadow item no longer decrease timer by 1 minute per equip.
    - Fixed an inventory bug when equipped shadow item disappears.

TaskManager
    - Redesigned abstract Task class.

================================================================================
Changeset 337 @ 2014.12.31

Knownlists, Cursed Weapons, NextAction, Misc

Knownlists - ty Hasha
    - Drop getActiveChar() method which was creating a lot of calls/casts.
    - Complete //knownlist command.

Cursed Weapons - ty Hasha
    - Loading method is moved on a most appropriated class, leading to a drop of numerous methods and few Map .get(.

NextAction - ty Hasha
    - Remove all Lists types, handling only singles CtrlEvent / CtrlIntention.

Misc
    - Dropped items (and notably Cursed Weapons) can't be picked up when a private store is activated, ty dandilo && RooT.
    - Revert a code section introduced on rev 329, which was fucking range of attacks (adding 100 range no matter what), ty Hasha.
    - Few missing stuff about Geodata regarding admincommands are fixed, leading to miscalculations, ty Hasha.
    - Fix a missing internal check for reworked //gmliston, ty Hasha.
    - Based on FindBugs and UCDetector plugins:
        - Drop numerous unused methods.
        - Drop of ConditionInventory, ConditionItemId.
        - Drop some useless convert (like "long to long", "casted int to a Math.round() returning an int", etc).
        - _lastX, _lastY, _lastZ converted into Location _savedLocation. Drop of saveCurrentCoords().
        - Drop of Location _lastServerPosition (unused).
        - ObservationReturn(L2PcInstance) became ObservationReturn(Location).
        - Drop dozens of useless variables/configs in Config.java.
        - Edit 2 stranges Map .remove( arguments to match with the good arguments.
        - Drop _effectTemplates from Item (no uses).

================================================================================
Changeset 336 @ 2014.12.29

Stats cleanup, Misc

Stats cleanup
    - Cleanup few useless calcStat. It will save objects and calculation times.
    - Drop following Stats: ATK_REUSE, MP_CONSUME, BOW_MP_CONSUME_RATE, HP_CONSUME_RATE.
    - Rework the way SA Cheap Shot is handled. Deletion of ConditionWithSkill.

Misc
    - Fix an HTM issue with Q023, ty RooT.
    - Fix an issue with trade/private shops, ty RooT/UYFrank.
    - Numerous cleanups based on Eclipse warnings I switched on then off. Notably:
        - Delete another "Item" nested class, use ItemHolder instead.
        - ConditionPlayerBaseStats is dropped.
        - Fix 20+ so-called 'possible ressource leaks' (missing rset/statement .close()).
        - AdminHandler AdminUnblockIp (not even working...) is dropped.
        - Few unused methods parameters are dropped.
        - Method setLastCords(x,y,z) renamed for saveCurrentCoords(), as parameters were unused.
    - Typos fixed. Notably:
        - Pa'agrio and not Paagrio.
        - Galion and not Gallion.

================================================================================
Changeset 335 @ 2014.12.27

AdminCommands, UserCommands, GrandBosses && BossZone, Trainers, Misc

AdminCommands
    - Delete //manualhero, as it's a mirror command of //sethero.
    - Delete //saveoly, it's already handled by task or shutdown.
    - //gmliston && //gmlistoff are merged into //gmlist (which works as a toggle now).
    - Cleanup AdminMaintenance (new Integer.intValue(), really?!).

UserCommands
    - Delete command id check (pointless).
    - /time now benefits from GTC rework.

GrandBosses && BossZone
    - Baium town-teleporting waker issue is now fixed.
    - All GrandBosses scripts are cleaned up:
        - Variable names follow regular conventions (caps for static, etc).
        - Uses of SpawnLocation instead of int[] when it's possible.
        - Unification of variables names.
    - Cleaned up L2BossZone, fixing issues with registered players - ty Hasha.

Trainers
    - Add support for trainers no skills HTMs. Ty ArhsGr && ErHard.
    - Fixed numerous HTM typos, notably psychotic PNJ names (A single NPC had 3 different names...).
    - Remove npcIds 30926, 30927 from L2Trainer.

Misc
    - Reworked few scripts.
    - Added getStringHour() method into GTC, which return a formatted 00:00 String without having to go by a godamn Calendar object.

================================================================================
Changeset 334 @ 2014.12.25

GeoEngine rework - a big thanks to Hasha for this awesome piece of code!

The Readme.txt on "data/geodata" is updated with numerous important informations regarding geodata types && configurations. Consider to read it!

General
    - Moved all geoengine related stuff to one package.
    - Massive cleanup/split/rework of all geoengine classes.
    - Created geoengine.properties config file, removed unnecessary variables.
    - Certain variables merged with L2World.

GeoData
    - Removed unnecessary interface and SingletonHolder, pure inheritance is used now.
    - Dropped canEnterDirection() methods and Direction class, as replacement added getNSWE(...) method, which returns directly geocell NSWE byte (four flags) loaded from geodata files -> avoid getting same geocell data multiple times.
    - Regions are loaded according to config file definition.
    - Added posibility to load L2J and L2OFF geodata.
    - Implemented new geodriver with new geodata storage approach (kept in Blocks).
    - Removed method concerning LoS and movement, now geodata contains only physical description of the terrain.
    - Point3D and Location cleanup, NodeLoc now extends Location... for better usage in future.
    - Spawn Z coord is now compared with geo Z. When it differs too much, use spawn Z instead of geo Z -> fix spawn problems.
    - Slight rework of geodrivers, now they differ between each other only in storage system.
    - Geodata type is set by config, each geodriver loads correct geodata regardless geodata type.
    - Added geodata path to config (you can move them to specific folder, not only /data/geodata).
    - GeoDriverArray is fastest geodata container at the moment. Kept GeoDriverBlock for some test purposes. Both work just fine.

GeoDataConverter
    - Added native support for geodata converter.
    - Creates diagonal (*.L2D) geodata files from L2J (*.L2J) or L2OFF (*_conv.DAT) ones.
    - Converter can be launched using "GeoDataConverter.bat/sh" after pack building.

PathChecker
    - Various scrapes of code put together to create PathChecker class.
    - Additionally reworked, less code - better performance.
    - Performs "see" or "can move" checks for movement, attack and spelluse systems.
    - Splitted "see" and "can move" checks. "see" is way easier and faster.
    - Added Z coord calculations -> fixed problem with seeing over flat obstacles and floors.
    - PathPointChecker merged with into PathFinding package (more logical, better for future changes).
    - Recoded LoS checks, more durable, during one iteration checking both LoS directions.
    - LoS now taking object height in consideration, added 2 configs for LoS checks (percent of height of the object, where starts the LoS check line and max obstackle height, which can exceed this virtual line).
    - Using this inheritance structure Pathfinding -> PatchChecker -> CellPathFinding depending on geodata setting (GeoData: 0..door checks, 1..door and geodata checks, 2..door and geodata checks and pathfinding.
    - Big rework of canSee check, should be faster, more transparent and also fixes several wrong evaluated cases (thank you guys for report).
    - PathChecker is loaded correctly according to the config setting (standard/diagonal).

PathFinding
    - Removed GeoPathFinding classes, CellPathFinding is used as default.
    - Removed SingletonHolder, added support to load own pathfinding system.
    - All buffers are loaded during initialization.
    - Cleaned up path post-filter -> fixed famous NPE error, no javolution needed.
    - Equation for A* node weight corrected -> leads to getting better optimized path.
    - Fixed weird movement between path nodes.
    - PathFinding using same loading model as GeoData (Null... or Cell...), provides better usage of PathFinding (no need to check GeoData config setting everytime you access PathFinding).
    - Since we are in beta, remove debug system.out messages.
    - Slight adjustment of post filter when the path is calculated...should make now no world->geo->world->geo coordinates calculations
    - Big rework of coordinate containers. Point3D transformed to Location (world XYZ); Location transformed to SpawnLocation (world XYZ, heading); NodeLoc transformed to GeoLocation (geo XYZ, nswe); all are using inheritance, all can be combined together.
    - PathFinding is loaded correctly according to the config setting (standard/diagonal).
    - Reverted back a part of code, which causing path to lead 1 cell away of obstacle (helps to avoid corners), added new config "ObstacleMultiplier" to multiply weight of such cell by X.
    - Improved path post-filter to do all steps in one iteration -> cleaner, faster and drop of "MaxPostfilterPasses" config.
    - Created new A* pathfinding algorithm (CellPathFindingDiagNew), it uses dynamic lists, it is possible to construct path in difficult/multilayer terrains, available only for DIAG geodata now, though bit slower than current 2D array A* -> deserves cleanup/rework to gain better speed.
    - Created new JPS pathfinding algorithm (CellPathFindingJps), which is basicly A* with hefty rules. BE AWARE, it is for test purpose only, since it is semi-functional (only short and "easy" distances are OK) and available only for DIAG geodata. Possible to improve in the future.
    - Character no longer stop moving, but continue in execution of the path, when you click to un-reachable destination.
    - CellPathFindingNewDiag: now calculates estimated minimal size of open-list buffer and set it as initial value...should lead to less array resize.
    - Reworked several configs and config file.

AdminCommands
    - Following commands dissapear:
        - admin_show_path
        - admin_path_debug
        - admin_show_pn
        - admin_geo_z
        - admin_geo_type
        - admin_geo_nswe
        - admin_geo_los
        - admin_geo_position
    - Following commands appear:
        - admin_geo_pos
        - admin_geo_can_see
        - admin_geo_can_move_beeline
    - server_menu.htm ("Server" tab from //admin) is edited to reflect changes on geodata commands.

Misc
    - Updated the geodata Readme.txt with important informations.
    - Added a map with blocks names, and unsupported blocks (ty RooT).

====================================================================================================
Changeset 333 @ 2014.11.23

GameTimeController, Misc

GameTimeController
    - Apply latest L2J version, fixing the moonwalk issue. Keep the DE passive skill system.

Misc
    - Fix one NPE vulnerability on L2Buffer getScheme() method.
    - Add the "banned" effect on character selection if a character access is <= -100. Ty RooT.
    - Fix setNewLeader( duplicate entries (coming with rev 311). Ty SweeTs.
    - Fix database_installer.bat entries. Ty RooT && Fronex.

====================================================================================================
Changeset 332 @ 2014.09.14

Quests, Party, Misc

Quests
    - Q235: drop few qItems before the end of the quest. Add Mimir's Elixir skill effect. Cleanup hasQuestItems checks. Ty Root.

Party
    - Fix a ConcurrentException on L2Party.
    - Add disband and expel messages.
    - Add AltLeavePartyLeader config to edit the way the party lead change is processed.

Misc
    - Revert rev 313 bow change, cleanup calculateTimeBetweenAttacks().
    - Cleanup ClanHall.java, fix a ConcurrentException. Add removeAllFunctions(), which avoid to generate one db connection per deleted function.
    - Drop redundant BeginRotation serverpacket. Activate those packets on L2GamePacketHandler. Allows to rotate using arrows keys.
    - Cleanup AdminDoorControl handler, fixing redundant open/close process, pointless checks and making error handling more friendly.
    - Make Exception on client packets more informative, which avoid to look on logs.
    - Edit Zariche to be considered as NONE weapon instead of FIST (avoid double hit system).

====================================================================================================
Changeset 331 @ 2014.08.31

Quests rework (part 2), Misc

Quest rework - Ty roko91.
    - Addition of Q417, Q420.
    - Recode of Q605, Q606.
    - Fix the invalid reward id on Q405.
    - Previous commit got all details about what is added, removed, edited on existing quests. This commit is effective from Q401 up to latest quest. Compared to roko91 patch:
        - Drop useless exitQuest(true) on STATE_STARTED.
        - Q403: fix onKill for npcId 27038. Extract getItemEquipped( checks to avoid code repetition.
        - Q405: fix onKill (could infinitely drop the qItem), revert hasAtLeastOneQuestItem use (wrong logic, it's && and not ||).
        - Q415: addition of a missing Gantaki HTM, cond 9.
        - Q417: move cond 2 obtention (to avoid permanent setInt/sound).
        - Q419: improve Martin's STATE_STARTED case.
        - Q420: Wrap Mimyu talk in a cond 4 check (avoid an exploit). Fix an if/else in Maria. Fix a permanent setInt/sound on Byron, when "deluxestone" occurs. Drop useless items checks on dragons cond 6/7.
        - Q421: cleanup STATE_CREATED.
        - Q508, Q509, Q510, Q601, Q602: general cleanup.
        - Q617: revert npcId 31271 01 and 02 HTMs to handle STATE_CREATED easily.
        - Q618: cleanup cond/items checks on onAdvEvent(
        - Q644, Q645, Q646, Q647, Q649: general cleanup.
        - Q651, Q652, Q653: use Location[] instead of int[][] to hold positions.

Misc
    - Rename getIsSpoiledBy() to getSpoilerId(). Same for setter and _variable.
    - Fix the Class Master and simplify the code using ItemHolder, ty Hasha.
    - Create a dedicated Class Master, npcId 50006. Revert L2Class of 31228 to L2Npc.
    - Revert to initial buffer visuals. The amount of text generated by skill names is too big in few cases, leading to client crash.
    - Fix and cleanup Ketra/Varka buff system (the last buff was out of index check).

====================================================================================================
Changeset 330 @ 2014.08.12

Quests, Misc

Quests
    - Addition of Q230, Q233, Q327 - ty to sharers.
    - Addition of victory pose on quests completion in few quests. Ty roko91 for the list.

Misc
    - Fix spawn protection task NPE (shit happens). Ty sahar.
    - Drop a useless parameter on notifyDeath() method.
    - Drop methods && variables related to snoop system. Cleanup AdminGmChat.
    - Drop the svnversion check, cleanup both build.xml.
    - AdminEffects handler:
        - Move //para_all && //unpara_all commands higher to don't be overwhelmed by //para && //unpara. Paralize visual effect is now stucked to old effect 2.
        - Drop sendPacket when a broadcastPacket is also sent.
        - Multiple random cleanup, going from merging checks to messages addition.
        - //play_sounds is renamed //jukebox (to avoid to mess with //play_sound).

====================================================================================================
Changeset 329 @ 2014.08.09

Quests, Herbs, Misc

Quests rework by roko91 - part 1 (initial patch is splitted in 2, next part go from Q401)
    - Fix drop chances and/or logic at onKill using retail C4 rates.
    - Add (or even remove !) monsters IDs at onKill.
    - Fix few NPC spawn/despawn times delays.
    - Improved readability and/or performance.
    - Tryskell edition made on roko91 patch:
        - Q101, Q340: roko91 misconception.
        - Q102: invalid state where HTM couldn't be sent on cond 2/3.
        - Q296, Q345: invalid rate system.
        - Q348: didn't include changes, have to rework it.
        - Q369: deprecated variables should be dropped :P. Fix onKill section aswell, as it misses a check regarding other type of shards.
    - General cleanup made up to Q400 (was previously stopped to Q360).

Herbs
    - Addition of "deep blue" drop rule for herbs.
    - In case multiple herbs are dropped and AUTO_LOOT_HERBS config is on, the addItem is correctly made, but only one item is added. Drop the isFlying() check.
    - Fix herbs destroy time.

Misc
    - Unify naming convention between herbs and items destroy time configs.
    - Fix the spawn protection config, which now uses a task (+ different message when timer expires). Added a visual effect aswell.
    - Doors Func are dropped.
    - Dropped deprecated embedded svnversion for both DP and GS projects.
    - isOutOfControl() got more checks included (stun, paralized, sleep), and is overidden on L2Summon to add isBetrayed() check.
    - Replace RequestActionUse isMovementDisabled() pets checks for isOutOfControl(). Add a missing isOutOfControl() check on useSkill.
    - Delete EVT_ARRIVED_REVALIDATE AI event, as it isn't needed for anything. More to be done for movement, probably will go after geoengine rework.
    - Fix a Connection leak on //remove_clan_penalty admincommand. Ty SkyArg.

====================================================================================================
Changeset 328 @ 2014.06.19

"Stat" classes, Misc

"Stat" classes
    - Reworked HP/MP/CP players calculation, dropping 3 Func and overriding existing methods.
    - Random cleanup (drop null checks, use getActiveChar() directly, and other misc).
    - getPhysicalAttackRange(): range isn't calculated anymore for NPCs (template value is final value), and default value for players follows WeaponType (drop bow range Func).

Misc
    - Cleanup L2MultiSell, splitting it in different classes: MultisellData, and a model package holding few models.
    - Fix a ClassCastException, and rework Raid Boss Curse on skill cast.
    - Fix a NPE on L2PcInstance.doDie(): it wasn't verifying pk clan status.
    - Edit some values which got no use to be long (avoid some int > long casts).
    - getClosestTown(): added a Race check for teleport (D.Elf / L.Elf).
    - Fix FuncEnchant for S grade weapons, BigBlunt/BigSword types and drop NONE type - Ty Hasha.

====================================================================================================
Changeset 327 @ 2014.05.30

GrandBossManager, Misc

GrandBossManager
    - Edit GrandBossManager to use a singleton, to fit with overall project writing style.
    - "Allowed players" system:
        - Move the initialization AFTER zones loading (it wasn't making any errors, but the system wasn't working).
        - Reworked it to simply use .add(), instead to set it using a temporary List.
        - Use an index system based on zoneId to avoid to search/retrieve current L2GrandBoss zone info on every SQL raw (it's doable since we order the query by ZONE and not by PLAYER anymore).

Misc
    - Fix 2 NPEs on 2 quests, due to Trove drop (Trove was handling null by returning 0, while Java Map simply send null). Ty Root for fix.
    - Fix a NPE on itemid 8811. Ty sahar for report.
    - Add skill names on scheme buffer, using kdDer64 buffer graphic style. Also edit the extends in order to be invul. Ty sahar for patch.
    - Added few missing restock delays on Interlude spellbooks. Ty rebelstrik for report.
    - Move setPledgeClass() call leading to rank miscalculation for heroes on player restore, ty sahar.
    - Some Hasha TODO list:
        - Drop L2Skill._displayId, getter/setter. Replaced by getId().
        - getAvailableHenna() is edited from array to List. Drop external null checks, as it is empty at worst.
        - Rename few packets typos, such as ware*H*ouse / withdraw*AL*
        - Drop DoorTable.putDoor(), single use.
        - Edited TaskSevenSignsUpdate _log definition (task system needs to be edited anyway).

====================================================================================================
Changeset 326 @ 2014.04.23

Recipes / Craft, TradeController, Misc

Recipes / Craft
    - Drop L2RecipeInstance (use ItemHolder instead)
    - Fix a NPE on RecipeTable listItems method and rework it to use ItemHolder. All missing items for a craft are now listed, with good quantities (not only sending the first missing mat).
    - Merge RecipeTable updateCurMp() && updateCurLoad() methods into updateStatus() - from 2 StatusUpdate packets sent to 1.
    - Fix the "ghost" success message on crafting window when you simply open a recipe.

TradeController
    - Move TradeController into datatables and renamed it BuyListTable.
    - Drop merchants.sql table (unused).
    - XMLize 2 SQL tables, merchant_buylists && merchant_shopids. The dynamic content (aka limited stock) is still loaded/save on SQL.
    - Created a new package model.buylist, moved L2TradeList inside it and renamed it NpcBuyList and Product (that class was holding two classes, so it is splitted).
    - General cleanup and improvements, from latest L2J Nos changeset. No more 3min shutdown trying to save buylists stuff...
    - The data used is the latest aCis one, plus roko91 changes, minus few empty buylists linked to nothing, and the "Coin Collector Album" restock timer.

Misc
    - Rework AdminEditNpc adminhandler:
        - Drop stuff regarding pages generation (for shoplists and skills, as such commands never send more than 10 entries).
        - Secure user input (try/catch).
    - Drop L2Attackable.RewardItem (use ItemHolder instead), TradeItem (clone class existing in another class), move NewItem inside DocumentItem (just to keep it similar to DocumentSkill, but both needs a rework...).
    - Edit _sweepItems / _harvestItems arrays for Lists, make them final (heavier RAM costs, but avoid arrays based operations, Lists creations, null checks are replaced by !isEmpty() and .clear() is used instead of creating another object).
    - Rename and move few "items based" classes on 'model.item' package.
    - Rename ItemsAutoDestroy to ItemsAutoDestroyTaskManager and move it on 'gameserver.taskmanager' package.
    - Edit ItemHolder (drop the unused objectId int, add setters).
    - Drop unused stuff from DropData, isQuestDrop() being always false (quests items aren't handled by droplists, but scripts...).
    - [L2J 5962] Fix a possible deadlock on player charges.
    - [L2J 5374] Reset the delete task on charges add/remove (avoid to get your charges dropped like an idiot after 10min...).
    - canInteract() is used as check for onBypassFeedback() call, impacting all NPC bypasses. Before it was used only on L2Npc, meaning children classes bypasses weren't covered by the check (such as dead, sit and etc states).
    - Drop a double tempInventoryDisable() use, and move the method use after buylist checks (avoiding to freeze your inventory for nothing).
    - Fix QuestList() serverpacket implementation (could lead to some null), setting the current player as parameter. Ty SweeTs for report.

PS: RequestBypassToServer sends by default ActionFailed.STATIC_PACKET after a command call. It's not needed to call it.

====================================================================================================
Changeset 325 @ 2014.04.14

Misc

Misc
    - Add retail HP/MP/CP calculation for players. Biggest change is the mana pool, which is drastically lower.
    - Add retail breath multiplier (based on race).
    - Add support for player radius / height (based on sex). There isn't yet uses of that system (bored to edit everywhere...) and values would still be rounded for an int anyway.
    - Move actors templates classes, rename them (drop "L2"), private the variable and add getters (PcTemplate). _baseCpMax is dropped, as there isn't base value for players anymore.
    - Slight cleanup (CharStatus, QuestTimer). Drop checks on doRegeneration (useless, handled by setCurrentX()).
    - [L2J 6301] Herbs aren't supposed to be delayed. Drop the task.

PS: track eventual errors on Quest, I have to revert the drop of the try/catch otherwise.

====================================================================================================
Changeset 324 @ 2014.04.11

Scheme Buffer, Misc

Scheme Buffer
    - Addition of Dr House scheme buffer, remasterized by me. The big differences are:
        - Buffer buffs aren't loaded from a mySQL table, but from a Config line from npcs.properties (String split > register on Map).
        - There is no L2Skill storage anywhere, only Integers (skillId). The skillLevel is generated from SkillTable getMaxLevel().
        - The schemes loading/save is made GLOBALLY (understand, not on player login). Save is still done on server shutdown.
        - The players schemes buffs lists are stored on a single varchar, which is parsed with String split method (before there was one entry on the database per skill).
        - Fix all godamn typos and broken english.
        - Statified HTMs content when it could be.
        - Reworked the "Edit my schemes" button to be more logical: select a scheme, THEN a skill group, THEN a buff. The HTM content also scales with that progression to make it intuitive.
        - Added infos everywhere (such as current selected scheme, number of max buffs allowed, number of current buffs per scheme,...)
        - Added "Heal" and "Cleanup effects" buttons (affect your current pet aswell).
        - The HTM system uses getHtmlPath(), meaning a different buffer npcId can be linked to different HTMs (unique dialogues for each buffer instance).

Misc
    - [L2J 6498] Drop double iterations on pet/player inventories deletion.
    - [L2J 6382] FourSepulchersManager cleanup - drop Map .remove(), use Map.Entry instead of keySet() + .get(), format the class.
    - Addition of method broadcastTitleInfo() which uses TitleUpdate packet; complete RequestGiveNickName clientpacket (adding numerous messages). Ty Root.
    - Fix getMaxLevel() method, broken with Trove changeset.

PS: the Scheme Buffer is a first shot. If you manage to propose better/easier organization, I would eventually take it.

====================================================================================================
Changeset 323 @ 2014.03.31

Misc
    - Numerous cleanups (Javadocs, formatting, methods renaming, organizing classes, etcs).
        - AutoSpawnHandler > AutoSpawnManager (moved to instancemanager)
        - RecipeController > RecipeTable (moved to datatables)
        - SevenSigns / SevenSignsFestival (moved to instancemanager)
        - CursedWeapon (moved to model.entity)
        - model/partymatching folder creation (moved 3 classes inside)
        - Numerous "L2" drops on names (L2Item, L2Weapon, L2Armor, etc). More to come.
        - Item renamed NewItem (because of L2Item renamed Item), and internal Item (another one) class dropped for ItemHolder use.
    - Rework checkPvpSkill method. Ty Kingzor for the buff/heal fix.
    - Recipes lists are on Collection from now (avoids operations from/to arrays).
    - Drop _charId, getter/setter. Use of getObjectId() on the few uses.
    - Rework SkillDat (renamed for SkillUseHolder), avoiding to create a massive amount of objects (3 final objects per players refreshed on demand, instead of 1 created per casted/queued skill).
    - _currentPetSkill getSkill() is correctly setted to null after a pet skill cast.
    - [L2J 6477] fix a double login issue.
    - [L2J 6488] [L2J 6490] implements MaterialType, CrystalType enums. Cleanup ItemTable. Move and rename classes.
    - Addition of missing sounds for boats, ty Root.

PS: you have to replace all items/skills XMLs, and few quests/scripts aswell.

====================================================================================================
Changeset 322 @ 2014.03.28

Trove drop, Misc

Trove drop
    - Drop entirely usage of that library, as there is almost no impact on performance.
    - Basically:
        - TIntObjectHashMap: Map<Integer, Object>
        - TIntIntHashMap: Map<Integer, Integer>
        - TShortObjectHashMap: Map<Short, Object>
        - TIntArrayList: List<Integer>

Misc
    - Remove/add the SA if a weapon grade penalty occurs/doesn't occur. Ty KaL for the idea.
    - Cleanup sortHeroesToBe() method.
    - Fix map_regions.xml in order 20_25 and 21_25 teleport to Talking Island (fix Elven Ruins).
    - Fix a sit visual bug. Ty Kingzor.
    - Fix siege skills on subclass change, and drop a double use of restoreDeathPenaltyBuffLevel(). Ty Kingzor.

====================================================================================================
Changeset 321 @ 2014.03.20

MDT (part II), Misc

Monster Derby Track - part II - a big thanks to roko91 for odd calculation ^^.
    - Move MonsterRace in most appropriate section (instancemanager.games)
    - Add data persistance:
        - Current race state is saved on race end. The current race number is retrieved from history aswell.
        - Bets on lanes (from CURRENT race) are saved on ticket obtention. It allows to recalculate odds without errors.
    - Fix previous commit regarding "View Past Results" button (records should be shown from newest race to oldest).
    - Add odds rate calculation per lane (happens at "tickets sales closed" event).
    - The odd of the first place is now saved on HistoryInfo.
    - Drop double message on ticket obtention.
    - Implements "Calculate Winnings" button (3 different bypasses, with numerous checks).

Misc
    - Add retail HTM when you got too much quests. Ty Root.
    - Fix a ConcurrentModificationException; slight rework of L2SiegeClan. Ty sahar.

====================================================================================================
Changeset 320 @ 2014.03.17

Sieges, MDT (Part I), Misc

Sieges
    - Fix registration date end calculation (cf: Siege participation registration is closed twenty-four hours before the start of the siege.).
    - Registration date is now calculated on server startup, and based on siege date (it was missing).
    - Move siege logs when a new date is setted, not on server startup (well if your server had old dates and need refresh it will show, but otherwise it won't).
    - Rework startAutoTask() in order to avoid to cancel/set twice ScheduleStartSiegeTask (if date is too old and need to be edited).

Monster Derby Track - part I
    - Announcements aren't broadcasted twice anymore and are based on zone types, not on L2RaceManager knownlists.
    - Race informations are now refreshed on player teleport (can see properly monsters).
    - Set the default race number to 1 instead of 4.
    - Setup race announcements like L2OFF, using a 20min game cycle rather than 10min.
    - Move the entire race system logic from L2RaceManagerInstance to MonsterRace. Reduce the number of running tasks from 40 (20 per NPC) to 1.
    - NewSpeeds() isn't processed twice anymore (dropped from newRace() end).
    - NewRace() logic is rewritten (avoid to get NPC clones, better performance).
    - Implements "View Past Results" button (holding past races informations up to 7 races).

Misc
    - Fix few warnings spotted by new Eclipse version, ty SweeTs.
    - Fix previous commit regarding //enchant admincommand (was testing with only me online, so didn't see this coming), ty SweeTs.
    - Fix FuncMAtkCritical, ty sahar to point it.
    - Add 2 methods to broadcast crap, toAllPlayersInZoneType() and toAllPlayersInRegion(). Each allow numerous packets as parameter.

====================================================================================================
Changeset 319 @ 2014.03.06

GM commands, Skills / Formulas, Misc - Part I

GM commands
    - Addition of //knownlist: allow to check target's knownlist. Eventually, the use of that command would be extended later.
    - From now, //gm schedules the rollback of the previous accesslevel (allow easy testing without manual accessLevel drop/add + character relog). Default 1 minute.

Skills / Formulas
    - Rework Func and classes holding such data (notably moving from [] to List).
    - Rework Env to match with latest L2J (getters / setters, "div/mul/add/sub"Value methods, getPlayer() addition).
    - Drop numerous unused Conditions (9 overall).
    - Rework calcHitMiss method (roughly -10% success compared to before), add night and Z+- modifiers, lower behind and side modifiers (from 20/10 to 10/5).
    - Fix gladiators charge system. It matches L2OFF IL.
    - matkModifier && levelModifier ratios from skills % landrate are reworked, as it is currently totally breaking formulas.

Misc
    - Numerous cleanups (complete some javadoc, drop useless methods, reorganize checks in order to avoid to calculate not needed stuff).
    - Fix a NPE caused by selecting "show skills" chat option on a skill trainer NPC with no active target.
    - Doors getName() is correctly setted, while internal getDoorName() and _name dissapear.
    - Revert some sections of rev 239 concerning sieges dates. Drop 7 signs period check aswell (not existing on retail).
    - Fix few concurrency weaknesses.

Part I means there's a part II, it's UNSTABLE. Use it at your own risks. There were too much edits to be able to re-read what I edited, I decided to commit it like that.

====================================================================================================
Changeset 318 @ 2014.03.01

Quests, Skills, Misc

Quests
    - Addition of Q225, ty to sharer.

Skills
    - Drop TARGET_ITEM && TARGET_CORPSE_CLAN target types.
    - Cleanup few target types, in order to avoid to recalculate numerous times the caster<>victim distance (when handled by getKnownTypeInRadius).
    - Rework TARGET_CORPSE_MOB in order to drop a ClassCastException (you can't "corpse life steal" summons anymore).
    - Fix Mass Resurrection skill, ty sahar.

Summons
    - Add support for Sin Eater skill (suicide aura skill + few random chat).
    - All "betray" checks got their appropriate user messages.
    - Passive summons such as Sin Eater, Big Boom or Wyvern shouldn't be able to use Attack button.
    - Fix a ClassCastException when you tried to attack L2StaticObject (thrones, etc) using the Attack button. It's an invalid target from now.

Misc
    - Enchant boni are now refreshed if +4/+6 from admin panel. Decreasing enchant value also works.
    - Cleanup L2ArmorSet methods, allowing less inventory checks (up to 3 times with is6Enchanted method use).
    - Fix cellpathfinding geodata option (massive NPEs from javolution drop), ty Hasha.

====================================================================================================
Changeset 317 @ 2014.01.11

Quests, Misc

Quests
    - Cleaning up to Q360.
        - Numerous drop rate edits.
        - Fix one HTM not correctly shown on Q354 (case where QItems are superior to 100).
        - Fix class change quests to be not repeatable, and add the socialAction packet.
        - Fix Q357 reward system, and some HTM typos.
    - Addition of Q211, Q213 - ty roko91.

Misc
    - Drop SkillsEngine singleton; those different methods are now handled directly on concerned sections (ItemTable and SkillTable).
    - Split npcs.xml into multiple files, following Pauler (L2JPes) method (it was commited into a single big file because I didn't find a valid splitting method).

====================================================================================================
Changeset 316 @ 2014.01.05

Quests, Misc

Quests
    - Cleaning up to Q350
    - Addition of Q350 (+ dp/core support for crystals leveling). Compared to Hasha version:
        - Addition of the itemget sound on a success.
        - Change of % luck calculation (was messed).
        - Slight edit on DP side (addition of all T. rex IDs, drop of the dummy Antharas ID).
        - Slight edit on HTMs.

Misc
    - Drop getExpertiseLevel() method, hardcoding values directly on the array.
    - Add the possibility to script item usage for scripts (one use for Q350, but can be useful for your custom scripts).
    - Cleanup double checks on clan leveling.
    - Fix a NPE (death penalty, due to attacker being possibly null from last revision).
    - Add a missing break on RequestActionUse (cases 61 / 1000 were melted).
    - Add a security check on RequestShortCutDel (ty Root).
    - Fix an issue with static objects targeting (due to previous setTarget rework).
    - Sit stuff
        - Cleanup isSitting() check, avoid to send twice CharSit packet to yourself.
        - Methods unification for the different uses.
        - Delayed action for /sit is now implemented.
        - When a throne is targeted, the player runs to it, and sit on destination if it's too far.

====================================================================================================
Changeset 315 @ 2013.11.03

Quests, Misc

Quests
    - Cleanup up to q330.
    - Add setItemIds() method to replace questItemsIds = new int {}.
    - Add hasQuestItems(int...) to avoid "hasQuestItems(int) && hasQuestItems(int) && hasQuestItems(int) &&..."
    - Add hasAtLeastOneQuestItem(int...) to avoid "hasQuestItems(int) || hasQuestItems(int) || hasQuestItems(int) &&..."

Misc
    - Castles
        - Sieges loading is reverted back (was messing in different points)
        - Castles loading is only processed in CastleManager (avoid to split the loading on multiple sections).
    - L2DatabaseFactory is cleaned up, we dropped msSQL support and ConnectionCloser (handled by "try ()" Java 7 system).
    - Update the different libs up to latest (drop the debug message from C3P0).

====================================================================================================
Changeset 314 @ 2013.10.27

Sieges (part II), Extractable, Misc

Sieges (part II)
    - Doors
        - Rework doors upgrade system to introduce castleId column (avoid to generate StringBuilders).
        - Broken door/wall SystemMessage is now broadcasted to defenders (and not to the door knownlist).
        - Doors upgrades are correctly cleaned on midVictory (objects were holding old properties).
        - Drop of _doorUpgrades Map and uses. It can be directly handled looking the door value.
        - SpawnDoors method.
            - Split content between closeDoors (used at start siege) and spawnDoors (midVictory / end siege). It avoids to send x2 broadcastStatusUpdate
            - Drop of spawnDoors() to simply keep and use spawnDoors(boolean).
            - Dead doors are supposed to be revived during midVictory.
            - Don't process anymore doors upgrades loading during siege start / midvictory / end.
            - Starting a siege shouldn't spawn doors, simply close them. If you mess with doors, use //spawn_doors.
    - Traps
        - The traps damage task cleanup is made during its lifetime, not everytime a player leaves the area.
        - Add a message when a trap is broken, and another when it's triggered (broadcasted to defenders).
    - Fix concurrent issues (fix weird siege behavior on attackers/defenders lists and artifact cast NPE).
    - Drop the array on Siege constructor (getCastle() returns a simple Castle object), a Siege object is created with Castle object (created in same time). Avoid null checks/possibilities
    - You don't need 2 artifacts casting to midVictory Goddard / Schuttgart, only 1 is enough.
    - Cleanup L2ControlTowerInstance, the list is created with the object (avoids null checks and the synchronized crap).

Extractable
    - Rework Extractable handler
        - Avoid to create dummies L2ItemInstance - without counting those generated by addItem
        - Drop the check based on subclass
        - Avoid a second for loop.
        - Rework the 2 int arrays to be handled by a list of ItemHolder (addition of that holder, and creation of a folder for holders).
    - Drop L2ExtractableProduct and associated system from L2EtcItem (postIL stuff).

Misc
    - Cleanup few methods (uses aswell) - reduceAdena, addItem - which avoids visual issues, cloned sent packets, useless objects creation (dummies L2ItemInstance notably).
    - Cleanup L2Observation (avoid to parse 2 times the same String, shorter code).
    - Cleanup numerous (150+) String.valueOf( - due to previous revision introducing it directly embedded on NpcHtmlMessage. Probably some are left, but I dropped a good part already.
    - Drop of L2EtcItem _isBlessed parameter.
    - Revert some reduceHp( changes made on PcStatus, which was buggying falling damages and trap zones system (as attacker was null, it was returning).
    - Had to slightly re-position how things are loaded in Gameserver.java (Seven Signs are now loaded before Castles).
    - Drop the castle id check on (getCastle() != null && getCastle().getCastleId() > 0) - it is always > to 0... If it's not, you messed.
    - Move the castle doors upgrades loading from Gameserver to DoorTable (more legit).
    - Heavy cleanup of L2ClanHallManagerInstance.

PS: you need to edit castle_doorupgrade.
PS2: L2ClanHallManagerInstance cleanup is untested.

====================================================================================================
Changeset 313 @ 2013.10.13

Quests, Spawnlist, Sieges (part I), Misc

Quests
    - Cleanup up to Q300.
    - Fix an error on Q300 (missed a cond).
    - Add dropMultipleItems() method (used on Q108 && Q293 for the moment), ty Ailierynn.

Spawnlist
    - Add back artifacts spawns.
    - Add back 32030 spawn (Leopard's Dead Carcass).
    - Move 32090 spawn (Garden Sculpture, from Leopard's Dead Carcass location to guessed Broken Labyrinth location).

Sieges
    - SiegeManager
        - Drop the map storing artefacts and associated config (unused).
        - Use Config.java format for sieges configs (public static, no getters, THAT_WRITING_STYLE).
    - L2CastleChamberlain
        - Money for doors / traps is now took from player inventory, not clan warehouse.
        - Proper HTM for adena check on Castle Chamberlain (for doors /traps upgrades).
        - Drop of a double YOU_NOT_ENOUGH_ADENA message (already handled by reduceAdena()).
    - Rework Flame and Control systems (avoid to null/re-create maps, drop old SiegeSpawn class for TowerSpawn).
    - L2SwampZone && L2DamageZone inherits from a new zone, named L2CastleZoneType (inheriting itself from L2ZoneType).
        - L2DamageZone task is cleaned up (notably will cancel if value <= 0 instead of for looping doing nothing like an idiot).
    - Implements castle traps system.
        - You have to pay for activation.
        - Destroying a Flame Tower desactivates trap controlled by that Flame Tower.
        - Traps affect defenders aswell ("Once activated, the flames do not distinguish friend from foe.").

Misc
    - Fix AdminCreateItem handler (KaL you're fat), ty meX for report.
    - Rework setTarget(), in order it automatically sends MyTargetSelected (and StatusUpdate if the target can been isAutoAttackable()).
    - Fix splitting damage if you got a shield but are unarmed (should be considered as one handed, not fist), ty raphaelfersan.
    - Add 9 missing skilltypes in L2NpcTemplate addSkill(, meaning monsters will now use their whole skillset, ty xblx.
    - Cleanup almost all getSkillsArray() uses to use proper "skilltypes" maps when possible. Reduce the number of checks needed aswell.
    - Don't reward adenas in party if you're already maxed + slight method cleanup, ty xblx (didn't reuse the whole fix).
    - Fix guards behavior when they're under attack (you're supposed to be able to speak with them while fighting, n/c), ty Kenrix.
    - Fix next intention unlock while using a bow (must occur at 50% gauge). Didn't fix yet the casting intention (probably can be made editing intentions, instead of forcing it via a timed task).
    - Fix ShopPreviewInfo packet, ty Ailierynn.
    - More uses of getAttackType(), which reduces generated code (when only L2WeaponType was required).
    - Addition of replace(String, int/long/double) methods in NpcHtmlMessage packet (which avoids a lot of visual long code).

PS: new SQL table for traps.
PS2: zones XMLs are edited as traps zones need dedicated id. 70000 and 71000 ids are used.

IMOPRTANT: Some stuff are still bugged. More to be done / fixed / polished in next rev.

====================================================================================================
Changeset 312 @ 2013.09.28

Quests, Community Board, Misc

Quests
    - Cleanup up to Q280.
    - Fix 2 issues on Q039 (sound and drop rate), ty Ailierynn for report.

Community Board - ty Erlandys
    - Rework Community Board system to allow more inheritance uses (logger, error messages, etc).
    - Polish && cache all HTMs content (and that was fucking long).
    - "Clan" tab
        - Send different clan details following randomer, member, or clan leader status.
        - Implements clan mail panel.
        - Implements clan management panel (with working introduction system).
        - Completed the implementation of clan notices system, merging "clan_notices" table with "clan_data" table which avoids SQL queries.
    - "Region" tab
        - Two panels are added listing castles / CHs owners (custom as not existing on retail, but follow GoD vision).
    - "Friend" tab
        - Implements Blocklist panel.
        - Implements friend mail panel.
    - "Mail" tab:
        - Add the "girl voice" (sexy as a robot) when you receive a mail, and add a popup at Enterworld if you got unread waiting messages.
        - Cleanup core side.

Misc
    - Addition of missing use of SystemMessage 1761, ty Trance for report.

TODO: rework "Top" && "Memo" tabs (didn't touch at all), implement "Clan" forums.

IMPORTANT: need to add 3 columns in clan_data. The whole organization for CB HTMs is also edited.

http://www.youtube.com/watch?v=ZUHPVlaFQZk# (http://www.youtube.com/watch?v=ZUHPVlaFQZk#)

====================================================================================================
Changeset 311 @ 2013.09.19

Pledge rework, Clans Wars, Misc (ty KaL for the good work)

Pledge rework
    - Unecessary packets removal and packet flood decreased (clan tab doesn't need to completely be refreshed for every update).
    - Correct use of PledgeShowMemberListAll and PledgeReceiveSubPledgeCreated.
    - Fixed a bug where clan members would be shown in main clan - no matter what his pledge type was - after logging out.
    - Sponsor and Apprentice are real-time updated and have their name listed in yellow, except for themselves (client handled).
    - RequestPledgeReorganizeMember updated: you can't send captains out of main clan.
    - A clan member can only be assigned as captain of ONE sub-unit.
    - L2Clan loading: a single query cares about clans loading, instead of one query for IDs + one query per loaded clan.
    - PledgeReceiveWarList better sniffed and documented (now there's a new option of war display. They are: Declared, Under Attack, Declare War (new, so far unused).
    - RequestSurrenderPledgeWar checks for priviledges (avoid packet exploit), although it's not certain that this packet is still used by Interlude client.
    - The "Party" column located in Priviledges panel correctly works. Drop RankPrivs getParty() system (wasn't used).
    - RequestPledgeMemberPowerInfo and RequestPledgeMemberInfo are better documented.
    - Fix ManagePledgePower packet.
    - broadcastToOnlineMembers() supports array of packets (avoid to create a list of clan members on every use).
    - When a player is invited to a clan, he is setted to the correct affiliation rank.
    - Sub-unit creation costs are setted to 5000 for Royal Guards && 10000 for Order of Knights (instead of 2500 for both).
    - Update member's siege state on clan invitation / leave.

Clan Wars
    - Clan War request checks:
        - You cannot send war to your own clan anymore.
        - You can send war to clans with less than 15 members, but only if it has declared war on you first.
        - A clan cannot have more than 30 active wars.
        - Check is made on member's privileges instead of clan leader.
        - You cannot send war against a dissolving clan.
    - Clan War stop check:
        - Cannot be stopped if any clan member is in combat.
    - War info tab updated: Under Attack list supports pagination (13 clans/page).
    - Clan War penalty: ending a Clan War brings 5 days penalty to the clan, so it cannot send war to the same clan again until it expires.
    - Drop useless columns in clan_wars table (wantspeace1, wantspeace2).
    - Command handlers 88, 89 && 90 show proper message if there are no wars/attackers.
    - SystemMessage 247 typo ("S1" requiered, because it has parameters).
    - Exp loss calculation considers if there's one-sided war.

Misc
    - Fix some Q219 HTMs encoding (was UTF-16 instead of ANSI).
    - /clanpenalty usercommand is reworked:
        - Cache the HTM && default String.
        - Add Clan War penalty in the possible choices.
        - Fix content when numerous penalites are listed.
    - Addition of /siegestatus usercommand, I publically shared my implementation: http://www.l2jserver.com/forum/viewtopic.php?f=69&t=28345 (http://www.l2jserver.com/forum/viewtopic.php?f=69&t=28345)
    - Cleanup onKillUpdatePvPKarma( and associated methods.
    - Cleanup quests up to Q270.

====================================================================================================
Changeset 310 @ 2013.08.28

Quests, Misc.

Quests
    - Cleanup quests up to q250. Fix also few bugs/typos/logic on existing quests.
    - Addition of Q214, Q219, Q231.

Misc
    - Random respawn should be -+, not only +. Ty fernandopm for reminder.
    - Cleanup AdminCreateItem handler, and add create_set command (integrated in itemcreation panel). Open the inventory window. Ty KaL.
    - The champion reward system is now bound to regular level restriction (deepblue drop).
    - Add few missing teleporters spawns (catacombs related), ty dEvilKinG.
    - Fix two issues regarding boats (deviant boat walking in the mountain, "merging" boats in Rune docks), and messages/timers. Ty KaL.

PS: that revision has been delayed because I played a lot and I'm not sorry about it!

====================================================================================================
Changeset 309 @ 2013.08.09

Quests / scripts, Spawnlist, Misc.

Quests / scripts
    - Cleanup numerous quests (up to q170; rework edited quests from previous rev again).
    - Fix a NPE occuring in Q232 (ty roko91).
    - Addition of MissQueen script + 4 multisells. Spawns are also handled by the script.

Spawnlist - ty dEvilKinG
    - Addition of missing spawns for 2 catacombs (Heretic / Apostate).
    - Drop of Miss Queen spawns (handled by script).
    - Refresh fixed respawn time for L2OFF ones.
    - New feature: random spawn time (random + fixed = real respawn time). Edit npcinfo.htm.

Misc
    - Added the missing "1h cleanup task" for ground-dropped CW, ty KaL.
    - [L2J 6136] Drop _attacking implementation and associated condition.
    - [L2J 6131 / 6137] Fists are considered as a dual attack weapon (players only). Drop the "dual" boolean parameter on calcPhysDam() && isUsingDualWeapon() method.
    - "Characters donning Formal Wear cannot use skills and magic. If they equip weapons or shields, the Formal Wear will automatically be unequipped.", ty KaL. Drop the check from CW which was unequipping FW to avoid double checks.

====================================================================================================
Changeset 308 @ 2013.08.01

Quests, Spawnlist, Misc.

Quests
    - Rework Q005 (failed HTMs and quest logic; one of the first quest we commited ?)
    - Fix Q016 (qItem wasn't cleaned up on quest abort).
    - Proper qItem checks on q038.
    - Cleanup numerous quests (up to q050) to match aCis current standards (naming conventions and other misc). For info, scripts are WIP since 1,5y and since that time, my standards changed. I will cleanup them 50 by 50, or so.

Spawnlist
    - Refresh the spawnlist logging spawns from L2OFF; it notably will fix following issues:
        - Add monsters than L2J IL never had (20+ new species added).
        - Fixes any spawn which was under ground (Ant Nest for example), and fill empty locations (Orc Territory for example)
    - Credits to mcbigmac for loggerExt.dll, dEvilKinG for the SQLization.

Misc
    - Add numerous missing minions, using L2OFF spawnlist, ty dEvilKinG.
    - If you try to edit subclasses being registered on Olys, you become ineligible to fight, ty KaL.
    - Refresh overload penalty for //setclass command, ty KaL.
    - Addition of the clans ladder feature (schedule task + loading), ordering clans by their reputation score, ty KaL.
    - Fix typo on loginserver, when you drop GS more than one time, ty KaL.
    - Basic cleanup of GameServerThread. isBannedGameserverIP() now works using banned_ip.cfg (eventual workbench to split servers/client IPs + XMLization of the .cfg ?).
    - Arrows are correctly dropped/deleted (current equipped pack stays equipped), ty Erlandys.
    - Added missing HTM dialog for Metheus, ty KaL for report.

PS: Spawnlist *system* isn't retail-like, but L2J system will be kept as data doesn't suck anymore.
PS2: Some issues can happen with that new spawnlist, as it edits ALL existing spawns. Report on forums if any problem.

====================================================================================================
Changeset 307 @ 2013.07.21

Quests, Misc

Quests
    - Addition of Q215, Q216, Q217 (ty Erlandys * 3)
    - Fix //reload for quests; ty Hasha

Misc
    - Fix symbols, ty Hasha. Sidenote: the issue came from rev 189. Before that rev, it was working correctly.
    - Augmented weapons aren't shown anymore on NPCs sell shop.
    - Toggles are desactivated upon teleport, ty djdiablo. ONLY REGULAR PLAYERS ARE AFFECTED, NOT GMS.

====================================================================================================
Changeset 306 @ 2013.07.17

Quests, MapRegionTable, Misc (known in future generations as "Hasha commit" or "fuck you Bingo quests")

Quests
    - Addition of Q381, Q382, Q384 (ty Tommy, roko91, Hasha for sexy help)

MapRegionTable (ty Hasha)
    - Merge TownManager and MapRegionTable.
    - Fix an issue with regions, where dying from Valakas's Lair would lead to teleport back to TI Island (out of region array).
    - Multiple code improvements and data update.

Misc
    - Cleanup items consumption messages (destroyItemByItemId() got it embedded), ty Hasha.
    - Addition of scrambleString(string).

====================================================================================================
Changeset 305 @ 2013.07.14

Skills, Misc

Skills
    - Fix Polearm Accuracy (422), ty djdiablo for the fix.
    - Fix treasure keys, based on previous SoR rework. You will stop to harass me with this at least, for Elmoreden's love.
        - Drop DeluxeKeys skillhandler, add Keys itemhandler. DELUXE_KEY_UNLOCK is considered as a Dummy skill.
        - You can't consume a key on dead chests nor mimics ones (invalid target message).
        - Regular keys are debugged: can't use on doors, and it uses the deluxe handler. Add the 60% luck on Chests.java script.
        - ONLY regular/deluxe keys for treasure chests are debugged. Others (pagan keys ?) would eventually be fixed when I will know their uses.

Misc
    - Summons don't intention-stuck anymore if they're broken during a skill cast (they will either follow you back or continue attack).
    - Fix Anakim/Lilith "out" teleporters. Fix teleporters spawns, and players spawns to be centered on the "tile".
    - Avoid to refresh twice overload and penalty checks at character restore.
    - Fix package sell mode (must stay checked if previously checked), ty sahar for report.
    - Added retail penalty system, ty devilking for patch.
    - Edit config NoQuests for NoScripts, and make a use of it, ty Root for the idea.
    - Peace zone stuff:
        - Drop the different implementations of isInsidePeaceZone(), keeping one. As that method includes allowPeaceAttack() check, drop external checks.
        - Summons can't force attack anymore players on peace zone. Instead, it will follow target. Drop also the message, as there isn't on L2OFF.

TODO
    - Missing SAs / dual passive skills drop/add on refreshExpertisePenalty().

====================================================================================================
Changeset 304 @ 2013.07.08

Karma, Misc

Karma
    - [L2J 6074] added retail karma drop/gain system.
    - KARMA_PLAYER_CAN_BE_KILLED_IN_PZ does only what the name suggests. Drop redundant checks on isInsidePeaceZone().
    - Don't clean karma on death if ALT_GAME_DELEVEL is setted to False (as karma drop is related to xp loss upon death).
    - Don't earn a PK point on summons/pets kills (but still earn karma).
    - Drop 4 configs related to Karma calculation method.
    - Restoring exp (via BSoR / res skills / GM commands add_xp) don't clean karma. Ty Zerador for report.

Misc
    - L2CastleTeleporterInstance cleanup, also fix an HTM typo. Ty sahar.
    - [L2J 6070] cleanup calculateRewards(). Multiple fixes and performances tweaks.
        - Doesn't create an empty map if aggrolist was empty.
        - Avoid to calculate xp/sp gain if attacker is dead.
        - Limit the list of rewarders to L2PcInstance (avoid all checks regarding summons).
        - Fix issue regarding summons/summoner damages (one was overwriting the other, now it cumulates).
        - Calculations are based on total damage made, not on maxHP of the monster.
    - Don't earn a PvP point on summons/pets kills.
    - Cleanup L2Party (internal vars uses rather than getters/setters, party broadcast setted to 12s instead of 10sec).
    - Drop useless itemhandler ChristmasTree.
    - Beast ss/sps are desactivated on summon death + cleanup poor overidden use on doDie() (L2Summon, L2PetInstance, L2SummonInstance).

====================================================================================================
Changeset 303 @ 2013.07.01

Headquarters, Four sepulchers, Misc

Headquarters
    - HPs are now properly setted, but during flag spawn (as we refactored npcs.xml, the NPC got 40HPs following L2OFF).
    - HPs is currently doubled when Noblesse HQ version is used (and not, as regular L2J, damages mitigation).
    - L2SiegeFlagInstance cleanup.
    - Drop of SiegeFlagStatus.
    - Show skill cast error message even out of castle area.

Four sepulchers
    - Q620 rework (HTMs renamed, simplified structure).
    - Wigoth doesn't burn a Used Grave Pass anymore.
    - You can choose your recipe correctly.

Misc
    - [301] Fix an Integer > int issue: if parameter is an int, .remove( method of ArrayList removes by index, not by given object.
    - [301] Revert an experimental code for ss/bss effect, which has been commited by negligeance (and was buggy).
    - Fix a log warning related to a SystemMessage.
    - Slight edit in targetReconsider() method in order mobs don't attack doors or invisible GMs (+ a lot more checks). Don't make anymore movement checks for "regular" targetReconsider (reserved for skills checks).
    - Edit StatsSet logs, in order it gives info related to the missing stat.
    - L2CharTemplate/L2NpcTemplate got more values setted by default (if you have to create a custom template, you got minimum infos to care about).
    - Drop unrelated/inheritated stats from doors templates (as it inherits from L2CharTemplate, not L2NpcTemplate, no need of exp/sp/rHand/lHand/etc).
    - Add pdef/mdef of doors on admin shift click panel (more fashion).
    - Fix an error in calcSiegeRegenModifer() formula (wasn't taking custom in consideration). Move method from double to boolean.
    - Fix a concurrent issue on L2CommandChannel + basic cleanup.

====================================================================================================
Changeset 302 @ 2013.04.18

Quests, Misc

Quests
    - Addition of Q212, Q365, Q383

Misc
    - Fix a double animation on custom L2ClassMaster. Ty Kingzor.
    - Revert changes made on ExHeroList (not buggy anymore, but still not retail).
    - L2Clan (again)
        - Drop addSkill(L2Skill) method - unused.
        - addNewSkill(L2Skill)
            - Manages to regroup 3 others packet sending in an existing getOnlineMembers() loop (avoid creation of 3 clan members lists per skill addition).
            - Avoid to send skill refresh packet if the clan skill doesn't match your rights.
            - The message saying you earned a clan skill is now broadcasted to all clan members, rather than only clan leader (create some stuff to clan chat about...)
        - setReputation
            - Refresh members skill list (when an update is needed).
            - Fixes an error introduced in previous rev (rep points update has to be made even if an update isn't needed).

====================================================================================================
Changeset 301 @ 2013.04.15

Olympiads, Quests, Misc

Olympiads - ty Hasha.
    - Fix visual bug regarding participant HP bars.
    - Fix visual bug regarding participants buffs bar refresh (for spectators).
    - Wait time setted by default to 30sec.
    - Rework spectators system.
    - Drop ExOlympiadUserInfoSpectator packet (not used).
    - Add 2 configs (AltOlyWaitBattle && AltOlyWaitEnd).
    - Random cleanup.

Quests
    - Cleanup numerous quests (notably Q163, Q166, Q171, Q294, Q296).

Misc
    - Cleanup ClanTable - ty Hasha.
        - Avoid to use getter/setter inside the file.
        - scheduleRemoveClan parameter is changed for L2Clan not int (avoid to read 4 times the Map to find the L2Clan).
    - Cleanup L2Clan
        - Avoid to use getter/setter inside the file.
        - Integer parameter > int.
        - Drop of L2Clan version for setEnemyClan / setAttackerClan. Integer survivor > int.
        - Edit deleteEnemyClan(L2Clan) / deleteAttackerClan(L2Clan) parameters from L2Clan to int (clanId).
        - Simplify few methods (notably ".contains" which implicitely returns a boolean).
        - getAllSkills() is edited for getClanSkills().
        - Drop of _skillList, 2 removeSkill(int/L2Skill) and getSkills() methods (L2JIL unused) - ty Hasha.
        - Drop of addClanMember(L2ClanMember) method (private, 3 uses, 1 line method).
        - getOnlineMembers(int) loses his parameter.
        - addSkillEffects(), updateClanScoreInDB() methods are dropped.
        - Rework setReputationScore(int) method in order to avoid to create 3 times (!) clan members list, and regenerate getClanSkills() for every member. Use of Math.min/max.
        - setHasHideout() / setHasCastle() renamed for setHideout() / setCastle(). Variables are also renamed.
    - L2PcInstance
        - The Map storing subclasses is initialized with instance itself, and final.
    - Sorted maps for subclasses, macros and skill lists - ty xblx, Trance.
    - Fix beginner shortcuts (self heal was overidden sit icon) - ty Kingzor.
    - Fix one systemMessage, and 3 others (not used yet, so not visible) - ty Hasha.
    - Drop of L2TIntObjectHashMap (only one use before, not used anymore).
    - Fix an issue regarding clan skills give back once Olympiads are done, if clan reputation is <= 0.
    - Fix top/bottom; getting one OR the other doesn't mean you got both anymore (1 && 0 || 0 && 1 = 0, not 1). Ty Hasha.
    - Skills (need to do a lot more about skills...)
        - Fix Focus Attack (set to 1, not add 1).

====================================================================================================
Changeset 300 @ 2013.04.08

Scripts, Misc

Scripts
    - Addition of Q222, Q232 (ty equip, Junior).
    - Cleanup numerous quests (getQuestItemsCount > hasQuestItems, drop of "exitQuest(true)" on STARTED cases, misc). Need to do more, I was lazy to re-read all godamn quests...
    - Fix DoctorChaos respawn time (for regular RB time).

Misc
    - Fix revive animation, drop of _isPendingRevive and associated getter/setter - ty Kingzor / xblx.
    - Cleanup ItemSkills && ScrollOfRessurection itemhandlers (fix SoR consumption, made on skill call not on item call) - ty Kingzor / xblx.
    - Fix esc, target is supposed to be kept if you were casting a skill (but a second press on esc cancels the target)- ty dEvilKinG for report.
    - Drop GM bypasses regarding inventory capacity (avoid to be filled at 105/80).
    - Use of hasPet() when possible. hasPet() check doesn't check if != null (as instanceof is doing it).
    - Fix Olympiads zone ids 7 && 8, and move all spawn points farer to center (ty Rainbow Dash).
    - Fix the alert on console regarding Shadow Sense (ty Rainbow Dash).

To be perfectly honest I was lazy those days and some things haven't be tested, notably olys zones (if they're wrong, complain to Hasha :p) and quests changes (that's just code changes, shouldn't alter the logic).

====================================================================================================
Changeset 299 @ 2013.03.26

Quests/AI, Knownlists, Misc

Quests
    - Addition of Q218, Q223 (added Road Collector / Harpy Matriarch AI), Q348 (ty equip, fernandopm, Tommy).
    - Baium cleanup regarding statue animation, drop of _waker.

Knownlists
    - Cleanup KnownListUpdate: merging checks, merging method updateRegion with the task, do an action only if given object is an L2Character, checks moved out of for loops and "final"-ized, fix an issue of timer.
    - _knownList is moved from L2Object to L2Character. Items and L2Static aren't associated anymore to a knownlist object.

Misc
    - Fix a typo in getClosestTownName() method (S*c*huttgart).

====================================================================================================
Changeset 298 @ 2013.03.20

Quests, Misc

Quests
    - Addition of Q421, Q643.
    - FairyTree AI is melted with Q421: killed tree spawns numerous ghosts, and ghosts speak when tree is under attack.
    - Add 3 HTMs related to Q348, edit qItems to be qItems.

Knownlist
    - Knownlist is reworked; drop iterators, drop _knownPlayers and _knownRelation maps.
    - Cleanup KnownListUpdateTaskManager (drop _failedRegions, merge cases), ty xblx.

Misc
    - npcs.xml is edited for Fairy Trees case: they become L2Monster, can't move, and got 3 minions.
    - Fix ss/bss consumption for pets and summons, ty Tommy. No more sanity check.
    - Fix Corpse Burst (power table) and Arrest(should aggro) skills, ty xblx.
    - Fix StunSelf effect, ty Myazz.
    - Revert part of rev 274 in order to fix short animations when you cast a skill (ex: raging force).
    - Random misc

====================================================================================================
Changeset 297 @ 2013.03.14

Quests, Misc

Quests
    - Addition of Q344, Q660 - ty Junior.
    - Fix Q374/Q375, ty Tommy.

Misc
    - Drop setIsFlying() and setIsRiding() method, using inheritance.
    - Fix few skills: 6 summon skills (npcIds were messed up), missing nextActionAttack - ty Tommy.
    - Fix toggle stopping movement action and next action stopping current action - ty xblx.
    - Rename AI_INTENTION_X to X, and harmonize uses for CtrlIntention.X.
    - Avoid to send a FOLLOW intention when clicking on yourself.

====================================================================================================
Changeset 296 @ 2013.03.04

Antharas, RBs timers, Misc

Antharas
    - Addition of death cinematic (ty UnAfraid for the script).
    - Antharas use his skills following L2OFF script. And yes, the Rnd.get() fuckfest is retail-like.

RBs timers
    - Fix GBs/RBs timers to follow L2OFF values. The biggest change is regular bosses going from 12-36h to 12-60h (36 +- 24) && Zaken/Sailren timers.
    - Random timer is modified to handle hours by hours, not ms by ms (* 3600000 is made after the Rnd is selected).
    - Random timer on GBs is supposed to be +-, not only + (edition of all GBs AI scripts).
    - Drop of RaidMinRespawnMultiplier and RaidMaxRespawnMultiplier configs. I don't like them. Don't ask.

Misc
    - Addition of ZoneId (exemple: L2Character.ZONE_PVP > ZoneId.PVP).
    - Fix arenas XP loss, ty Root for report. You still loss XP inside arenas if killed by anything except playable (avoid RB exploits).
    - You don't lose XP while in siege, if you were involved by the siege (either playable or siege NPCs).
    - Fix new clan member "rank" (you are registered in main clan, not on 5th grade). Ty SweeTs.
    - Fix an invalid pvpflag scenario (summoner is out of the arena, but summon/pet is in: attacking the summon/pet makes you purple).
    - Reorganization of L2PcInstance isAutoAttackable(), which also fix 1 issue about clan member check (the clan member check was made on attacker's objectId, but attacker can be the summon...).
    - Bring isInsideZone in L2Object, allowing to drop all casts.
    - Addition of isInArena(), as it's often used (checks if a player is in a PVP zone but not in a SIEGE zone).
    - getWantsPeace() > wantsPeace(), modified for a boolean rather than int.

Notes:
    - getRespawnMinDelay() and getRespawnMaxDelay() are "overriden" on L2RaidBoss spawn to be used as fixed and random timers => (getRespawnMinDelay() + Rnd.get(-getRespawnMaxDelay(), getRespawnMaxDelay())) * 3600000.
    - isAutoAttackable is to test.

====================================================================================================
Changeset 295 @ 2013.03.02

Sailren, MovieMaker, Zone system && GrandBossManager, misc

Sailren AI
    - A wild Sailren appeared! Ty UnAfraid for the L2OFF script (leeched cinematic, oust location, exit gk locations, and inactive timer duration).
    - Addition of the blank NPC 32110 (for the animation), one L2BossZone, change of type for L2GrandBoss, one line added in grandboss_data.sql and edition of GrandBossTeleporters script to handle Shilen Stone / Teleport Cube behaviors.

MovieMaker enhancements
    - You can now see all parameters of sequences on main panel.
    - If you haven't a target, the movie takes you as target.
    - Addition of "Back" buttons on Edit and Add HTMs, returning to main panel.

Zone system && GrandBossManager
    - GrandBossManager singleton system is dropped (use static approach).
    - Cleanup and few method renames.
    - Few fixes:
        - Lists and maps from L2BossZone can't be null anymore (drop involved checks) and use concurrent versions.
        - GMs are now registered in _playersAllowed list - as regular players - if they used the "legit" way. They still have priviledges to teleport on such area and not being bothered by restriction.
        - Avoid to add a zone if it was already existing (just a security check, as List allows doublons).
    - Reintroduction on ids on L2BossZone zones, in order to correctly load/save allowed players (cause a problem notably if you add/remove zones meanwhile).
    - L2ZoneType variables concerning zones children are moved in zones children:
        - affectedRace > L2MotherTreeZone.
        - affectedLvlMin / targetClass > L2EffectZone.
        - Following parameters are dropped: affectedClassId, affectedClassType, affectedLvlMax.
        - Drop of internal flag _checkAffected, as isAffected() uses now inheritance.
    - All null checks concerning L2BossZone zones on scripts are dropped (as those scripts can't, anyway, work without those zones...).

Misc
    - Addition of door HPs view (happens in peace time or for siege defenders). isEnemy() is dropped and replaced by isAutoAttackable() for doors HP view.
    - All configs related to GBs are renamed. Hardcoded safeties are dropped, so don't edit configs when drunk.
    - Fix clan ranks for heroes and nobles + L2ClanMember cleanup, ty BaT for report.
    - All variables on individual AIs are organized as following: zone, private static final, public static final, public.

PS: while L2ScriptZone are using 10XXXX ids, L2BossZone will use 11XXXX ones. Remember about it while adding custom zones!

====================================================================================================
Changeset 294 @ 2013.02.24

Scripts, Misc

Scripts
    - Cleanup Core.
    - Addition of Q373.
    - Addition of StakatoNest AI. The whole behavior is postIL, but there are some evidences that AI was in preparation (perhaps fully working ? Who knows, it's the sort of definitively lost data) in IL time.

Misc
    - Fix previous commit regarding skill bar at restart (nice catch Trance).
    - Drop GlobalVariable system, as we got ServerVariables system.
    - Cleanup Quest (avoid to return L2ZoneType and others misc).
    - Fix few max quests number checks (25 quests max according client ingame quest panel)
    - Drop a double QuestList packet send at quest aborting.
    - Cleanup of show_skilllist (use a simple array of L2Skill instead of a Map, no iterator, StringBuffer > StringBuilder).
    - Drop null checks on NPC skills templates (never null).
    - Fix summons skill level at skill launch (was generated from summon level...). The data was ok, but the level was overriden for godamn known reason.
    - The generic addfuncs are initialized before skills addfuncs (there were no problems, it's just more logical to load regular funcs then skills funcs).
    - Gates level mod is reinitialized to L2Character one (potential problem about evasion), add 2 funcs for gates instead of overriden pdef/mdef (Ty masssttteeerrr :P).

====================================================================================================
Changeset 293 @ 2013.02.18

Misc
    - Numerous fixes on UseItem, mostly related to messages and readability. Unhardcode Calculator itemhandler.
    - ChristmasTree itemhandler wasn't loaded.
    - Effects affecting players are restored before Enterworld access (fix HP/MP/CP issues at restart)
    - Critical rate of summons is corrected.
    - Fix a concurrent exception on PcFreight as object access was followed by list clear inside the loop (? lol). _depositedFreight is also initialized with player instance and never null anymore (drop null checks).
    - Pets don't share anymore master reuse. Master don't receive anymore infos regarding pet uses (notably, icons-related stuff). Ty CreamCracker for report.
    - Fix pet pickup message (on multiple items).
    - 6 items are now considered as potions (etcitem type is potion), ty Root for report.

PS: as items reuse system isn't really developed on IL chronicle (potions only ?), I decided pets timestamps won't be saved in db.

====================================================================================================
Changeset 292 @ 2013.02.11

Misc
    - [L2J 5772] Moving effect flags out of CharEffectList into L2EffectFlag enum.
    - Cancels enchant process while moving.
    - Equipped shadow weapons are now correctly handled at player login/logout (armors as weapons). Tasks can be canceled now (before it was running even unequipped).
    - 40% of Inventory file has been splitted into listeners.
    - Fix //show_characters.
    - Fix PaganTeleporter. Statue don't react to faded mark, triol's mirror hasn't any checks and the zone with faded mark is implemented.
    - Added back handwritten ids for zone system. Dropped zone name (no use).
    - Reintroduction of ZONE_SCRIPT for... scripts. Use that XML for your custom scripts.
    - Drop merchant_areas_list SQL (unused).
    - Random cleanup.

Notes
    - Zones ids are still dynamically generated, but it will be replaced by a written id (if found). Scripts use ids 100000+.

====================================================================================================
Changeset 291 @ 2013.02.10

AIs, misc

AIs
    - Addition of the cursed ToIVortex script.
    - Addition of FirstClassChange script (mix of 4-6 scripts), ty to Fernandopm :). Compared to his version:
        - Addition of ids 32097 and 32098 (+56 missing HTMs).
        - Cleanup the advEvent (a single array is kept instead of making *8 map checks).
        - Pa'agrio and others typos.
    - Edit ShadowWeapon ids; it takes directly ids from scripts FirstClassChange && SecondClassChange (as second script isn't made yet, the array is still local).
    - Fix Barakiel minions AI.

Misc
    - Fix subclass crap (Maximilion/Jurek and others Mystic/Priest).
    - Fix dozen of typos on village_master HTMs, and harmonize links position (L2J team was dyslexic back in 2007...).
        - All first masters got a link for shadow weapon coupons exchange.
        - All second masters got a link for subclass. First masters who had one is dropped.
    - Addition of //show_scripts npcId: allow to see events affecting the given template.
    - Fix L2EffectZone concurrent exception. As L2EffectZone are always supposed to have a skillid, initialize the map directly in order to avoid null checks.
    - After a check on L2OFF, bring the speed modifier when you run in water from 0.5 to 0.41.
    - Revert canceling target fix but keep the cleanup (no whining anymore).
    - Fix an issue on summon window stats about runspeed (it was only visual). In same time, getMoveSpeed() becomes an int.

Note: I tested 6 IDs out of 20+, and obviously hasn't the will to test/fix eventual typos on the 800+ HTMs, if there is issues, you know where to complain.

====================================================================================================
Changeset 290 @ 2013.02.07

Summons, misc

Summons
    - Fix stats (they finally had to use funcs).
    - Fix base critical on summons (40 for all).

Misc
    - Fix an issue involving null objects on pet pickup action.
    - Minions follow distance is made using collision radius of both minion and leader (avoid weird 500 distance on rb minion follow).
    - Drop few methods on instances which are only knownlist stuff.
    - Fix skills 118 and 163 (nerf mages nudists ;p).
    - Fix order of tradelists' content.
    - isSeedable() implementation.

====================================================================================================
Changeset 289 @ 2013.02.05

Antharas, GBs / RBs, misc

Antharas
    - Addition of the script, fully reworked. Fast comparison with L2J version:
        - Highly cutted script (450~ lines of code instead of 950+)
        - Use of 2 SocialAction during cinematic.
        - Far less tasks used.
        - Use of a dummy id (29019) in order to register it in grandboss table (avoid 3 states).
        - Players are initially teleported far from where Antharas spawns.
        - Minions are handled by regular AI system.
    - Edition of the GrandBossTeleporters for the npcid 13001.
    - npcs.xml is edited to reflect behavior (had to edit type, add aggro on behemoths, etc).

GBs / RBs
    - Cleanup of RaidBossSpawnManager.
    - Initial HPs/MPs of GBs and RBs at first server launch are fixed (0 = getMax).
    - Following bosses are spawned, as templates are ok (manually fixed) now:
        - Boss Akata
        - Nellis' Vengeful Spirit
        - Rayito The Looter
        - Dark Shaman Varangka
    - GBs don't take summons nor invisible GMs in target anymore.
    - Valakas skill choose is improved (less spam of imba skills, clever use of FRONT or BEHIND skills).

Misc
    - getQuest() isn't case sensitive anymore.
    - Fix RequestBypassToServer (that treatorous index is -1).
    - getRandomPlayer(): returns a random player (must be alive and not a invisible GM).
    - getPlayersCountInPositions(): returns an array composed of numbers of players in front of, behind and on sides of a NPC.
    - Addition of FrenzyOnAttack script (5 orcs types).
    - Few messages added in SummonMinions script (Timak Orc Overlord case).

====================================================================================================
Changeset 288 @ 2013.02.03

NPCs template refactor part III, misc

NPCs refactor
    - Handle final stats calculation from template stats (formula: base * carac bonus * levelmodifier).
    - Fix pets evasion/accuracy

AIs
    - "FleeNpc" is moved to "group" folder, and is renamed "FleeingNPCs".
    - Split L2AttackableAIScript content into 2 layers: L2AttackableAIScript and AbstractNpcAI.
        - "group" and "individual" AIs extends AbstractNpcAI. That layer got methods dedicated to such AIs.
        - L2AttackableAIScript becomes a basic script, stored in "group".
        - That split prepares the eventuality of listeners system addition.
    - Random cleanup (SummonMinions, Orfen, etc).
    - Addition of BrokenLabyrinth script: http://boards.lineage2.com/showthread.php?t=146273 (http://boards.lineage2.com/showthread.php?t=146273)
    - Addition of PlainsOfDion script.

Misc
    - Addition of _scriptValue system. Drop of hasSpoken system.
    - AI timeout is setted back on 120sec (after L2OFF IL check).
    - Critical with barehands is correctly calculated (after L2OFF IL check: use DEX mod).

Notes
    - _scriptValue is unique to a spawn, you have to care about multiple scripts editing behavior of a NPC.

====================================================================================================
Changeset 287 @ 2013.02.02

NPCs, AIs, misc

NPCs
    - Few fixes on npcs.xml (few mobs being canMove when they shouldn't, etc).
    - Indent using tab instead of spaces = -600ko.
    - Clan system is revisited:
        - "clan", "clanRange" and "ignoreIds" don't need anymore a default value on NPC templates (drop of all clan="" clanRange="0" ignoredIds="").
        - If a mob hasn't "clan" parameter, "clanRange" as "ignoreIds" aren't parsed. A mob can have: 1/1/1, 1/1/0 or 0/0/0 (default, no need any write).
        - "clan" is now correctly parsed and used. It needed an important rework in order a template accept multiple clans.
        - "clanIgnore" is renamed for "ignoredIds". The system is now correctly parsed and used.
    - Addition of "ignoredIds" in shift+click panel.
    - L2AttackableAI cleanup.

AIs
    - Addition of GatekeeperZombies script.
    - Fix aggroReconsider() method (no more NPEs), which returns previous target if no new target fits. Simplify the method.
    - Fix Sprigants behavior. The task loop is now correctly stopped in case players die or leave the area.
    - Fix custom scripts in order they send back bug report/HTMs. Not really a fix, as AIs don't use any HTM, but better follow that rule.
    - Orfen AI:
        - General cleanup.
        - Edit initial spawn point of Orfen on SQL (happens only at first server startup) from her lair to 1st location (out of 3).
        - Edit her aggro range from 500 to 1000.
        - The 4 minions are handled by minion system instead of script (it generates decent random walking and minions follow Orfen).
        - Edition of the zone check system for a Valakas/Baium similar looking one (inactivity = reset). That check is made every 60sec, not 10sec anymore.
        - If inactive during 30min, Orfen randomly walks on 1 of the 3 locations (not lair). If she was already tagged as teleported, drop the teleport flag.

Misc
    - Fix rev285 henna issue, ty Hasha for report.
    - [L2J 5756] hasAtLeastOneItem() method. As it isn't limited to quest items, it is put on Inventory.
    - Cleanup Quest.java methods, avoid to retain unused variables.
    - Addition of Util.contains(array, array) for clan comparison cases. Return true if at least one element is common to both arrays.
    - Existing Util.contains methods got "==" edited for "equals". They also check if array integrity is ok (null or empty array returns false).
    - Drop of isParty(L2Skill) method.

Notes:
    - Orfen movement sucks because of the miss of geodata check, perhaps later it will be improved (or share if you found better way to handle it).
    - When a NPC got multiple clans, it uses the same clan range value for all of them.

====================================================================================================
Changeset 286 @ 2013.01.27

NPCs template refactor part II, Recipes, misc

NPCs
    - Fix missing teachTo infos (infos took from aCis, no reason L2J was wrong).
    - Add ACTIVE skills on all NPCs templates. Use of L2OFF GF (aCis skill list) for the ACTIVE skill list.
    - Fix custom names/titles (isCustom() uses).
    - Fix all Races using L2OFF GF "race" parameter. It uses only 4416 instead of 4290-4301 && 4416.
    - Addition back of the Wedding manager custom NPC.
    - Addition of shift+left click on NPCs. Addition of few infos (race, canMove).

Recipes
    - Fix an issue concerning recipes loading, ty Hasha.
    - Better performance overall (drop a map, avoid few generation of lists, drop synchronize keywords, drop of TempItem class, random cleanup,...)

Misc
    - Checks involving hpratio are unified (easier to read).
    - Fix TARGET_AREA_UNDEAD (rename it for AURA, as those skills are AURA not AREA; clean the target type; fix the mechanisms). Ty Hasha for report.
    - Cleanup GBs scripts.
    - Correct Extractable message, ty Sahar.

PS: As the old aCis skill list was using L2OFF GF, the gain of RAM is around 25mo between this rev and 3 revs ago. Now passive skills are the ones written in client description.

More parts to come, we still miss 53 templates and calculations of stats from core.

====================================================================================================
Changeset 285 @ 2013.01.15

NPCs templates refactor part I - Ty to devilKing for data parsing.

An important work has been made in order to merge, and then SQL -> XML all data related to NPCs.
That work is a first step and is commited to let me a clear view of next additions, see bottom for what is missing.

Following SQL tables dissapear:
    - npc_ai_data.sql
    - npc_skills.sql
    - npc.sql
    - minions.sql
    - skill_learn.sql

Following XML dissapears:
    - droplist.xml

Some new functionalities:
    - Addition of isSeedable() support.
    - Unhardcoded critical value (mobs got different % to critical: 1, 4, 8).
    - NPC shield support. Feel that sad feeling when your hits are blocked by a mob!
    - Debugged ss/bss usage for NPCs. You thought NPCs were stupid... And you were right. But now they're powerful.
    - Debugged stats system (was heavily affecting summons).

And, in the biggest capharnam:
    - Edit L2CharTemplate, L2NpcTemplate and L2PcTemplate stats names, and so by extension XMLs. For classes parsing, there is a noticable drop in weight removing "skill" from "skillId" and "skillLvl" (-200ko).
    - Drop from XMLs classes things which could be set by default on core, and shared amongst all templates, notably:
        - basePAtkSpd (default 300)
        - baseMAtkSpd (333, shared with mobs) - the stat just dissapears, replaced by flat value on the used formula.
        - baseCritRate (default 4)
    - Stats who were supposed to be boolean (but weren't due to the use of SQL) are now boolean.
    - Following methods (setters, getters, variable) dissapear:
        - getSex() - no use (I speak of NPCs, ofc)
        - getBaseHpConsumeRate() - no use
        - getBaseMpConsumeRate() - no use
        - _aiClass from L2Character - no use
        - getBaseMAtkSpd() - 333 for all
        - getBaseMCritRate() - 80 for all
        - isServerSideName() - isCustom() addition
        - isServerSideTitle() - isCustom() addition
        - getBaseShldDef() - 0 for all (affected by worn lHand)
        - getBaseShldRate() - 0 for all (affected by worn lHand)
        - Overidden getCollisionRadius() / getCollisionHeight() from L2PcTemplate (what was the point to store in another variable and not using the extended variable ?)
        - _staticAIData and its getter on L2Npc (can be easily replaced by getTemplate().getAIData(), avoid to maintain 65xx AI objects just for shortcuts...).
    - isCustomNpc() addition (compares if npcId and templateId are different, if yes, it is considered as a custom NPC)
    - Existing float are changed for double.
    - Base patk, pdef, matk, mdef are double not int anymore (keep accuracy for calculations).
    - Shift+click on NPCs is cleaned up (generated HTM is shorter, drop of (L2Character (this)), fix skill / drop / spawn views for custom NPCs (was using idTemplate instead of id), addition of missing infos (harvest, ss/sps count/rate).
    - _seeded L2Attackable internal boolean flag is dropped, as that state can be checked using _seedType (> 0 meaning it is seeded).
    - Config.CHAMPION_ENABLE is dropped. If frequency > 0, then we can have champions... So that config is useless.
    - Default values concerning champion configs are equal in Config.java and .properties.
    - Drop of admin_kill_monster command (unused) and drop of AdminKill handler (merged admin_kill on AdminAdmin).
    - Fix a NPE in Q111.
    - Fix shops animation while running (you still could run for 2.5sec before stopping). Ty UnAfraid for the report.
    - Fix few Double values in Config which weren't correctly parsed as Double.
    - getPlayersInside() && getPlayableInside() are dropped for getKnownTypeInside(). Cleanup of L2BossZone.
    - Fix systemMessages while missing a regular attack - ty Hasha for report.
    - Fix target cancel while attacking (pressing esc)
    - Fix a PHX exploit, ty PaganTemplar for report.
    - Fix polymorph issue, ty Sweets for report.
    - Fix an issue with henna addition, ty Silentium.
    - Fix a problem with quest parameters, ty povis111 for report and Hasha the Villain for fix.
    - Add few HTMs on default folder.

If you (think you) have better data, consider sharing. devilKing will surely be pleased to parse it, again, and again.

Things to do in part 2:
    - isSeedable() use for seeding purposes (atm only one check for harvest).
    - Debug rHand/lHand stats, in order mobs use shields.
    - Debug stats, all NPCs stats are very weak.
    - Active skills missing on all templates atm.

====================================================================================================
Changeset 284 @ 2012.12.12

Quests, misc

Quests - 320 scripts overall ;p
    - Addition of Q363, Q415 && Q418 (tested 2/6 ends). Ty sharers.

Misc
    - Fix L2ClanMember issue.
    - Revert one fix of [255] - L2Attackable drop edit back to regular L2J + cleanup.
    - MoveBackwardToLocation cleanup.
    - Drop admin commands related to NPCs edition (12 overall - preparing next commit), rework survivors.
    - Cleanup few TODOs.
    - Added 50 spawns in Orc Territory, 5 for Q415 (Aren and quest mobs). The L2J IL spawnlist is just ubber failed in fact lol, missing few hundreds spawns.

Note to myself: 37052 spawns before any refactor. The time will say if I was true or not :D.

====================================================================================================
Changeset 283 @ 2012.12.05

Quests, misc

Quests
    - Fix NPEs on Q602 and Q111. Drop null checks on Q607, Q608, Q613, Q614 (already handled by getPartyMembers()).
    - Few "Quest." and invisible typos cleanup (but well as replace works well... Why not ?). By typos, there were double "  ", space after/before "", etc...
    - Addition of Q402, Q404, Q405, Q410, Q411, Q412, Q601. Ty sharers.

Misc
    - Drop few stats and "uses": EXPSP_RATE, NONE_WPN_VULN, ETC_WPN_VULN, FIST_WPN_VULN
    - rewardExpAndSp(): exp parameter is a long instead of int.
    - No more calcStat use for exp/sp rewarding.
    - Fix a location in GM teleport, drop a line on Varika HTM.

====================================================================================================
Changeset 282 @ 2012.12.02

Quests, misc

Quests
    - Addition of Q407, Q408, Q409 && Q419. Ty sharers.
    - Reworked "PathTo" CREATED_STATE quests (easier to read), and set final exitQuest() to TRUE, in order to see HTMs.

Misc
    - Add a layer called ExProperties, improving readability/creation of Config.java
    - Drop StackIDFactory, making BitSetIDFactory the only choice. Related configs are dropped.
    - Cleanup BitSetIDFactory, dropping some synchronized.
    - Some Float had to be dropped; they're edited for Double.
    - Put default values for CH configs.
    - Fix various problems on CabaleBuffer instance. Delay autochat from 30sec to 60sec (not retail).
    - Random: add a missing rset.close(), put 2-3 methods static, use of getters and cleanup some crap in LS.

====================================================================================================
Changeset 281 @ 2012.11.25

Fishing tournament, GM commands && misc

Fishing tournament
    - The most awaited && acclaimed feature of 2007 finally added.
    - What more to say... Stfu && enjoy ?
    - Dedicated to sahar. He knows why.
    - Ty UnAfraid for some HTMs.

GM commands
    - //list_spawns now uses an HTM with clickable locations. It also uses current target if npcId entered as parameter isn't ok.
    - Added a button on shift+click NPC info list for spawns.
    - //list_locations command is dropped, as //list_spawns makes that job by default now.
    - Slight edit of main_menu.htm.

ServerVariables
    - Addition of a table dedicated to misc things of the server.
    - Probably will store more than current use (only fishing tournament atm). Events, 7S, olympiads ?

Misc
    - Rework StatsSet, picking up g1ta0's work. Probably more to come, it's a gold mine...

Report on forum about fishing tournament. As the system comes from a well known source, I didn't bothered to test too much. I added some HTMs, one missing SystemMessage, fix the custom length formula which now fits retail criterias, and observed the regular mechanism of load/save. For example, I didn't test reward period. So tests and reports, even if working, would be appreciated.

====================================================================================================
Changeset 280 @ 2012.11.25

Quests
    - Addition of Q326, Q330, Q376, Q377, Q380, Q622.
    - Fix last revision loop edit on Varka/Ketra scripts. Ty xblx for warning.
    - Fix Q624 party quest state.

====================================================================================================
Changeset 279 @ 2012.11.13

Quests, Misc

We reached a total of 300 scripts commited! Ty to all sharers!

Quests
    - Addition of Q273, Q292, Q293, Q340, Q602, Q604, Q610, Q616, Q625.
    - Cleanup the demote methods for ketra and varka (use a for loop instead of imbricated if/else).
    - Few HTMs "typos". Mostly to keep a shared pattern amongst all quests.

Misc
    - Add a restriction for newbie check based on class level (avoid to be considered as a Newbie as a Saggitarius lvl 12).
    - Drop a double message (reduceAdena() already got YOU_NOT_ENOUGH_ADENA included).

====================================================================================================
Changeset 278 @ 2012.11.11

Quests, AutoChatHandler, Misc

Quests
    - Addition of Q106, Q107, Q108, Q274, Q306. Ty sharers. Again.
    - Unify checks about races on quests HTMs.

AutoChatHandler
    - Drop AutoChatHandler system. It is only used for 7Signs, and it can't be used for a simple random npcid (or anyway must be scripted, as it must be setActive()).
    - Indirectly fix the issue introduced in auto_chat rework, where Preachers were spamming the whole block of text (bad split with " $ ", dunno why).

Misc
    - Classes folder use a better organized files, which also fix the Linux issue. Ty Root. I got few answers it works on Linux, and I tested some minutes on Windows.

====================================================================================================
Changeset 277 @ 2012.11.09

Quests, Misc

Quests
    - Addition of Q101, Q102, Q103, Q119, Q265, Q654. Ty sharers :3.
    - Echoes crystals aren't a Newbie reward (Q104 / Q105).

Misc
    - Drop the "karma drop" message (was flooding logs).
    - Change the severity of disconnected client message from "info" to "fine" (was flooding logs).
    - (Potentially) fix concurrent exceptions on updateHeroes() && activateHero(). For info, .put on a Map overrides the entry if it was already existing, making the .remove useless (and dropping the concurrent use).

Notes
    - Put back a concurrent version of ArrayList if Hero problem persists.
    - The "Rewards" var (flag used on repeatable newbie quests) will be kept until Tutorial is commited.

====================================================================================================
Changeset 276 @ 2012.11.02

Quests, misc

Quests
    - Addition of Q047, Q048, Q324, Q372, Q426. Ty to sharers.

Misc
    - "Quest." are dropped on any quest (Quest.getNoQuestMsg(), Quest.getAlreadyCompletedMsg() && all Quest.STATE_XXX).
    - Drop a double check on checkClanJoinCondition() method, ty Ashe.
    - Fix "ghost" aborted/completed quest issue on quest logs.
    - Few HTM typos.

====================================================================================================
Changeset 275 @ 2012.10.31

Enchant system, Quest system, Misc

Enchant system
    - [L2J Silentium 145] Add skill refresh when you enchant an equiped dual (to +4) or armor (to +6, if other parts of set are already +6).
    - Don't unequip item (it was visible if you failed a blessed enchant).
    - Avoid to refresh weight in case of a success or a blessed fail.

Quest system (Hasha)
    - Fix exclamation mark for NPCs with one-time quests.
    - NPC will now show correctly the "quest completed" message, when quest is completed.

Misc
    - Cleanup pathnodes loading.
    - Delete _isSpoil + setter/getter (can be retrieved with another variable). Cleanup spoil skillhandler && effect.
    - Cleanup 20+ generated TODO and content of those files (conditions mostly).
    - Fix an issue where 2 items rewarding the same skill drops the skill once you unequip one of those items. Addition of getPaperdollItems() method. Ty xblx.
    - Fix alliance creation/dissolution and clan dissolution if you're registered/participing in a siege. Ty Hasha. PS: it also avoids one connection with DB.
    - Cleanup xp/sp methods to reuse existing stuff. Ty Hasha.
    - EffectStunSelf correctly stuns effector, not effected. Ty xblx for report.
    - FriendList packet edited (again). Ty xblx.
    - Fix the last potential NPE (according Eclipse).
    - Fix a crappy NPE introduced in previous rev (see last comments on previous rev). Ty xblx.
    - Drop or edit few "_log.log(Level.WARNING, "", e);", as they send blank debug message. I only bothered about the most common.
    - AdminPledge is cleaned up, the following actions (dismiss, setlevel, reputation) are now possible on any clan member, not simply the leader. info and dismiss work as supposed (no need 2nd parameter) when used from admin panel.

====================================================================================================
Changeset 274 @ 2012.10.28

AI system part I..., pet inventory, Fear effect, misc

It is not yet the paradise, but I tried to cut the complexity, reuse existing stuff, and prepare AI data for future templates rework.
I still search ideas for new AI system (using inheritance, either for AI type and/or template type).

General AI behaviors changes
    - Checks concerning friendly/enemy clans verify confusion state (in case of enemy clan, it replaces).
    - Mages/priests AI handle following cases from now:
        - Will always launch skills.
        - In case they're muted, they 100% flee.
        - In case they're rooted, and can't launch skills (oom/muted), they will attack the nearest (if not possible to attack the current target) target using melee.
        - Switch automatically from high to short range skills if you approach (priority to short range, as retail), and vice-versa.
    - Mobs won't (re)buff if they're already buffed when you initiate a fight (as they can buff themselves random-walking).
    - Drop of the random forget time.

Mobs ARE SUPPOSED TO act as following:
    - Target checks:
        - Mob hasn't target/got dead target/got timeout; replace target in case mob is aggro type and continue execution or break the whole processus.
        - Mob is chaosTime type, switch target if possible.
    - Mob successes to launch a skill (10% default, 100% for healer/mages AIs):
        - Mob suicide below 15% HPs.
        - Mob heal allies who got the lowest HPs amount (activation at 75% HPs, priority to healer && mages AI).
        - Mob use a random spell - debuff (10%) - otherwise, by priority: short range && long range skills.
    - Mob is immobilized: if physical range is ok, attack, if not, pickup the nearest target and attack it.
    - Mob flee from player melee range if it is a mage/healer/archer AI.
    - Mob approaches the player if out of physical range.
    - Mob physically attacks the player.

L2SiegeGuardAI
    - Reorganized entirely the file, inheritating from L2AttackableAI.
    - Correct an issue introduced 10~ revs ago, where siege guards weren't attacking at all.
    - Drop TargetAnalysis && SelfAnalysis (was creating a huge amount of pointless lists for every siege guard).

L2NpcTemplate
    - Drop 13/19 skills lists and associated getters (here are the survivors: long range, short range, heal, buff, debuff, and suicide.
    - addSkill() method avoid to use "add" getters, allowing to drop them all.
    - Drop of FIGHTER and BALANCED AITypes. Those 2 AIs are now refered as DEFAULT (as basically FIGHTER types got and will use skills).

AbstractAI
    - _castTarget and _attackTarget are dropped. All is uniformed around getTarget().

L2AttackableAI
    - Drop of _lastBuffTick.
    - Reorganized entirely the file, and rework many methods.
    - Avoid to generate internal skills lists for AIs. It uses templates skills arrays.
    - The attack timeout is back to 30s, rather than 2min (/4). It now handles differently aggro mobs from passive mobs. Passive mobs will stop to attack if you don't attack them, when aggro mobs will continue to follow you until you're out of their "aggro range * 2".

L2NpcAIData
    - Drop many variables with their getters/setters/uses, in prevision of future NPC templates rework. The list concerns:
        - _primaryAttack
        - _minSkillChance
        - _maxSkillChance
        - _isChaos
        - _longRangeSkill
        - _shortRangeSkill
        - _longRangeChance
        - _shortRangeChance
        - _switchRangeChance
        - _enemyClan
        - _enemyRange
    - SQL is not cleaned cause it will soon disappear. As the useless data isn't loaded, it's not a problem.
    - Drop of %ai_enemy_clan% in shift+click panel on NPCs.

NpcWalkers (L2NpcWalkerInstance, L2NpcWalkerAI)
    - L2NpcWalkerInstance internal broadcastChat() -> L2Npc broadcastNpcSay().
    - Avoid multiple .get() operations updating a single L2NpcWalkerNode when the NPC goes to it (as we have, anyway, to retrieve the node, better make it automatically).
    - Drop _homeX, _homeY, _homeZ variables + getters/setters and uses on onSpawn() - unused.
    - _walkingToNextPoint getters/setters are dropped - unused.

Pet inventory
    - Fix a concurrent issue, ty Hasha.
    - Fix the inventory update when you transfer non stackable items.
    - Add player && pet inventory weight refresh. Pet can now be overweight (was working before, but only in few circumstances).
    - Items are cleaned from pet inventory list / from the world even if the owner doesn't exist.
    - checkItemManipulation for pet inventory (make checks on count). The string parameter is dropped for both inventory types. The count check is made on < 1, not on < 0 anymore.

Fear effects
    - Glitch is fixed, ty xblx.
    - Slight edit in order if you trigger startFear() it works in any case, and avoid pointless actions triggered by onActionTime().
    - Remove the visual effect when effect ends.

Misc
    - Modifier for L2Attackable concerning cast break has been removed. I still believe it should be reworked for monsters (75% or 50% of the final value ?).
    - Drop of Rnd.nextInt(int) method, which was calling Rnd.get(int) method.
    - Fix a ConcurrentException on CellPathFinding geodata module.
    - Fix lethal strikes messages. calcLethalHit() method doesn't return a boolean anymore (no use).
    - Fix a couple of skills values (lethal2 100% chance issue && few cancel resist/vuln chances setted to 40 instead of 30).
    - Drop of mAtkRange Stats. The only factor which entered in that Stats calculation was skillRange, so I simplified it.
    - Fix gameserver shutdown issue (ty Kenrix for reminder). I don't use L2J forum / Silentium fix.
    - Fix RequestHennaEquip adena amount message (cleaner method used than Silentium).
    - Fix a minor issue on /unstuck command - missing isSitting() check (ty Silentium).
    - Fix jail issue (teleport you forever in jail if you're //recall by a GM). Ty xblx.
    - [L2J 5684] hitTime lower than 500 are taken in consideration, _castInterruptTime takes in consideration the skill coolTime.
    - Cleanup of all getKnownXXX() / getKnownXXXInRadius() methods, replacing them by 2 using generic types (fuck yeah).
    - Drop few clone checks concerning isRunning() - as setRunning() internally checks it.
    - Fix FriendList packet, ty Root for report.

N.B:
Between 10mo to 15mo RAM are saved.
The think cycle is actually used more than once per second (called by itself on attack ?). This is the main issue about packet flood when numerous enemies follow you, and will end by a huge performance boost once corrected.
I search a mean to fix pet inventory weight number. Atm it only updates while overweight penalty is called. I dunno why.

Things to fix in AI part II:
    - Null crap on HitTask / callSkill.
    - Flee behavior if you're too near (mob stops to attack).
    - Siege NPCs mage weird movement.
    - Find a solution about mage with low/no mana, in order to avoid those weird movement.

====================================================================================================
Changeset 273 @ 2012.09.25

DEATH TO ANACONDA!

Jython
    - Is OFFICIALLY dropped from aCis (if that force ppl to make java quests instead of using outdated technologies, that's only a bonus).
    - All your previous .py files (quests, scripts) && jython tasks must be moved to java.
    - Such scripts problems (buffers, AIs, etc) are then OFFICIALLY unsupported.

Configs
    - Drop "LazyItemsUpdate" (dangerous, ends to unexpected behaviours).
    - Drop "AltGameMobAttackAI" (no core support anymore, ghost variable).
    - "RaidChaosTime", "GrandChaosTime" && "MinionChaosTime" are edited from 10sec to 30sec by default.

Misc
    - Update mysql-connector jar from 5.1.18 to 5.1.22
    - Drop of L2ScriptZone and ZONE_SCRIPT (if you want custom zones, just make your own type).
    - Update formatting for DP (I was using it, but it looks it wasn't commited) and validate files which weren't using that format (4 so far).

====================================================================================================
Changeset 272 @ 2012.09.23

SS/BSS system, Minions, Misc

SS/BSS system
    - [L2J 5637] SS/BSS system is reworked to allow inheritance.
    - Drop the ReentrantLock on Soulshot handler.
    - Cleanup ss/sps/bsps handlers (drop of switches, drop of synchronized, etc).

Minions
    - Fix UnsupportedOperationException on MinionList.
    - Drop _enableMinions boolean tag (always true).
    - Regular minions repop after "leader respawn time / 2".
    - Drop of a pointless list which was keeping references of dead minions.
    - If a monster is consider as a leader, don't make minion checks (and vice-versa).
    - _maintenanceTask is moved from regular monsters to RBs (used only for location checks). Drop of getMaintenanceInterval().
    - Cleanup MinionList (unused methods, methods calling others methods).

Misc
    - Addition of MMOCore jar, as it was cleaned up in last rev.
    - TeleToLocation boolean parameter is modified for an int. 2 configs are dropped.
    - addSpawn() from Quest.java can handle Location models (used in future for Benom).
    - Addition of the missing spawn id 35506 (used in future for Benom).
    - QuestJython model is dropped.
    - Drop of "this." uses on scripts.
    - [L2J 5413] Reuse delay stuff is cleaned up, getMReuseRate()/getPReuseRate() methods are dropped, _baseMReuseRate isn't generated for any Char template anymore.
    - Fix ConcurrentExceptions on ItemsAutoDestroy, ForumsBBSManager.
    - Cleanup of isBehind(), isBehindTarget(), isInFrontOf(), isFacing().
    - Reworked implementation of Miser SA.
    - parseGameCondition conditions are "else if" rather than "if" (understand who can...)
    - Fix CoV critical rate value, ty Stanus for report.

====================================================================================================
Changeset 271 @ 2012.09.15

Quests, Javolution, misc

Quests
    - Addition of Q111, Q359 && Q633.
    - Addition of the missing HTM for Kirikachin.
    - Revert positions of 2 multisell entries for Q633.

Javolution
    - Drop of that library, leading to a serious drop in RAM usage (-45mo at startup = -19%). As comparison, that memory drop equals *ALL* SQL > XML changes made so far.
    - Changes follow a simple scheme, listed here:
        - WeakFastSet / FastSet > HashSet.
        - FastList > ArrayList (in very few cases, LinkedList).
        - FastMap > HashMap.
        - All ".shared(true)" versions use Concurrent versions (CopyOnWriteArraySet, CopyOnWriteArrayList, ConcurrentHashMap).
        - TextBuilder > StringBuilder. There is no equivalence for ".clear()", I decided to use ".setLength(0)".

Misc
    - Rework GameServerTable (XML loading part).
    - Drop of the single use of Vector (replaced by an ArrayList in ServerStatus gameserverpacket).
    - Modify all uses of "new Integer(value).intValue()" for "Integer.parseInt(value)".
    - MMOCore is refreshed to use JDK7. The build is remade from zero, and avoid to create a zip.
    - L2FastList, which was a children of FastList, has been dropped. All uses have been replaced for ArrayList.
    - Rework a couple of Iterator uses to be more elegant (Duel, DuelManager, GmListTable, CharNameTable) - I kept Iterator *ONLY* when .remove was used (and so when Iterator was vital).
    - Cleanup AdminEditChar (drop of arrays which are not used, checks are glued, variables beginning by a minuscule, and others esthetic/performance stuff).

PS: I just thought, like 3min after, than I didn't update internal MMOCore JAR. So compile it and replace, in 271 I will add the new directly.

====================================================================================================
Changeset 270 @ 2012.09.05

Quests (Sailren questline), misc

Quests
    - Addition of Q123, Q125, Q126, Q127, Q367, Q413, Q641. Ty to sharers!
    - Fix rewards for Q631.
    - Rework rewards Map to use int[][] instead (Q631, Q640, Q642, Q644, Q645, Q646).
    - checkPlayerState() and checkPlayerCondition return the QuestState (avoid to create anew a QuestState). Not affecting party quests.
    - Fix Q241 NPEs.

Misc
    - Addition of fail enchant messages, ty dEvilKing.
    - Fix stopWaterTask(), ty xblx.
    - Drop a double message when you use TP, ty sahar for report.
    - [L2J 5584] calculatePledgeClass() is now static.
    - [L2J 5584] Fix Noblesse/Hero status icon for clanless characters.
    - [L2J 5584] L2ClanMember uses a ResultSet / the player instance directly. Can't create a L2ClanMember if clan is null.
    - One of stopMove() parameters is dropped. Avoid to send x2 broadcastPacket(new StopMove) on L2TamedBeastInstance. Add a stopMove on /unstuck.
    - Addition of 4 missing spawns for Q125/Q126.
    - Addition of missing HTMs for npcid 32109 (needed for Q126/Q641), implementation in GrandBossTeleporters script with retail HTMs.
    - Fixed numerous retail typos: Siren > Sailren, Elkrokhi > Elroki, ax > axe.

====================================================================================================
Changeset 269 @ 2012.09.03

Quests, misc

Quests
    - Addition of Q337.
    - Fix critical issues appearing in last revision, and impacting 80+ quests (boolean stuff, custom scripts && objectId).
    - Drop the max level on all quests, and harmonize all HTMs about "you need level X in order to make the quest". Remove hardcoded versions and add HTMs for Q042/Q043/Q044.
    - Fix Q656 min level.
    - Fix Q341 repeatable state.
    - Addition of a couple of missing "st.exitQuest(true);" (Q338, Q354, Q356)
    - Q371 party system is now ok.
    - Rework Q027, Q028, Q029, Q030 STATE_CREATED.
    - Use of Race model rather than ordinal, it's easier to read/debug.
    - Complete rework of Alliance/Clan java. HTMs are harmonized following 7Signs ones. Probably more to do (like moving all events on scripts directly).
    - Custom scripts (-1) are out of queststate checks when not involved by db edition or variables save/load/checks.
    - Rework endQuest(), only one db query is made to drop all (on L2J, one db query per variable).
    - L2PcInstance: _quests FastMap is changed for a FastList, _notifyQuestOfDeathList is directly initialized (avoid synchro shit and null checks).
    - Drop missing SQL stuff about character_quest_global_data.

Misc
    - Rework regen skill in order Valakas doesn't cast it at all, but got directly the effect. Add a random timer aswell.
    - Drop slow effects on 4 bleed augment (postIL behavior).
    - Fix "Heart of Pa'agrio" radius effect and icon (more skills to come later, I know SweeTs I KNOW).
    - Fix all silence times and chances (basically 80% 30sec for one target, 40% 30sec for aoe).

Note: //reload quest is currently not working correctly.

====================================================================================================
Changeset 268 @ 2012.08.29

Hasha quest engine cleanup.

Quest
    - QuestEventType class to its own class.
    - Sorted all methods by groups (I suggest to create "//INFO: this is some info for text below" tag for the GS,DP pack projects).
    - Dropped "character_quest_global_data" table, since it only written in 2 quests (never read).
    - Removed "class_index" column in "character_quests" (never used).
    - Global quest variables methods unified for simpler usage.
    - Dropped some method concerning quest load/close (not used).
    - Added isRealQuest() method to separate scripts from live quest. That means every live quest needs to have _Id > 0.
    - Method changes:
        - Player handling filters player with desired quest state or condition:
            - getRandomPartyMember() now includes a range check.
            - checkPlayerCondition/State() last hit drops.
            - getPartyMembers/State() full party last hit (can be used directly in FOR loop).
            - getRandomPartyMember/State() party random.
            - getClanLeaderQuestState() concerned range check set to NPC, not player anymore.
        - Spawn, timer handling:
            - Cleaned up, unified usage for these methods.
            - Dropped methods with same name and different parameters (now you have one method and fill all necessary params in it -> clear usage).

State
    - Added in QuestState class.
    - Changed quest state storage type in "character_quests" table from String to Byte.

QuestState
    - These methods created/modified
        - Item handling (usable during quest):
            - giveItems() simply remove specified amount of items.
            - takeItems() simply remove specified amount of items.
        - Drop handling (usable for quest item drop):
            - In order to support rate of dropping quest items, added drop type parameter to these methods (see javadoc tag).
            - dropItemsAlways() amount is affected by Config.QUEST_RATE_DROP.
            - dropItems() amount/chance are affected by dropType param and Config.QUEST_RATE_DROP.
        - Reward hanling (usable for quest rewards):
            - rewardItems() rewards player with items (config applied).
            - rewardExpAndSp() rewards player with exp, sp (config applied).
    - Removed spawn and timer methods from this class, everything is handled in Quest directly (it wasn't necessary to use QuestState for it).

General
    - Fixed onTalk bug, where player could start quest from another NPC, than registered

---- IMPORTANT ----

For existing database, use attached SQL command:

USE acis;
SET NAMES cp1250;

DROP TABLE IF EXISTS character_quest_global_data;

ALTER TABLE character_quests DROP COLUMN class_index;

UPDATE character_quests SET value='1' WHERE var='<state>' AND value='Start';
UPDATE character_quests SET value='2' WHERE var='<state>' AND value='Started';
UPDATE character_quests SET value='3' WHERE var='<state>' AND value='Completed';

---- EDIT TRYSKELL ----

Those are additions to original Hasha's notes'n'patch.
    - Added a check for custom scripts to avoid the reload state when they load, as they all use the same id.
    - Fix giveItems() behavior (was completely buggy, Hasha...).
    - Add few final keywords (cause I like them).
    - ArrayList initializations are changed for primitive List, it's a bad use to use an "evolved form", as it limits possibilities. In the same spirit we could use directly "HashMap = new HashMap" for maps, but we don't.

====================================================================================================
Changeset 267 @ 2012.08.28

HtmCache/NpcHtmlMessage cleanup by Hasha.

====================================================================================================
Changeset 266 @ 2012.08.23

L2OFF droplist, misc

Droplist
    - Parse L2OFF IL droplist. Go from 26881 to 29767 drops. A big ty to dEvilKinG for that work.
    - Core side goes from SQL to XML aswell.

Misc
    - Fix AQ minions paralyze/silence.
    - DatapackRoot config is dropped. I don't find any point to put your DP in another folder, added to that the config is probably bad integrated.
    - Fix a possible NPE if a RB got suicide skill (happen only when sahar got events ideas).

====================================================================================================
Changeset 265 @ 2012.08.23

Misc
    - Fix GoldenRam issue.
    - Fix 2 CW issues (when player drops it).
    - Correct implementation of shift click, with use of inheritance.
    - Addition of item shift+click possibility for GMs, HTMlize static object shift+click for GMs.
    - Fix mercenary tickets pickup (probably, couldn't test as we're in wrong 7signs period), optimize item pickup check aswell.
    - Move caches section upper than clan section, in order to avoid clans crests being deleted at server startup (as crest cache isn't yet initialized).

====================================================================================================
Changeset 264 @ 2012.08.20

Misc
    - Fix a MysqlDataTruncation on shortcut save (max number by page = 10).
    - Fix previous CW refactor about max stage level.
    - Cleanup AdminMammon adminhandler.
    - Add a variant of "admin_list_spawns" named "admin_list_positions", and move it from AdminMammon to AdminSpawn.
    - Fix mass summon cubics radius for party members.
    - Fix CrestCache getCrest() (couldn't return null and so issue to clean invalid crests), ty Java-Man.
    - Cleanup of getTargetList() method. Multiple improvements (FastList > ArrayList, variables initilialization in the shortest scope).
    - Fix SSBoost usage for BLOW skillhandler.
    - Cleanup a couple of skillhandlers, in order they use the inheritated list of L2Object rather than calculating a new one.
    - Fix harvest system + harvest messages aswell.

====================================================================================================
Changeset 263 @ 2012.08.18

Dimensional Rift, misc

Dimensional Rift
    - Fix some methods leading to broken "start".
    - Revert some start checks in order items check and consumption aren't made in same time (check first, then consume).
    - XMLize and merge loading process of "dimensional_rift.sql" (rooms infos) with "dimensional_rift.xml" (rooms spawns infos).
    - Fix room 7 of Hero rift (cf rev 178).
    - All FastList are changed for List.
    - Add an HTM for "rift is full" behavior, drop the "cheater" htm (return directly).

Misc
    - Fix a MysqlDataTruncation with macros (255 chars max).
    - Remove a check about CW and pets (the used sysstring was wrong also...).

====================================================================================================
Changeset 262 @ 2012.08.17

Cursed weapons, misc

Cursed weapons - ty hasha for critical error support nunu, was making me crazy :D
    - Fix the visual glitch on inventory when you lose a CW.
    - Drop of duration lose when you kill a player (couldn't verify with NCSOFT patch notes / forum if such feature exists).
    - Added overall expiration timer of 72h.
    - Added hungry expiration timer (24h by default) - must kill someone before the 24h are gone else CW disappears.
    - Added random victims number per stage (between 5 and 15 with default configs).
    - When a player drops the CW, resets the stage to 1. The overall timer is kept, and hungry timer is dropped too.
    - Decreased the drop chance from 1/10000 to 1/1000000.
    - No issue anymore when you assimilate a CW with another CW.
    - //cw_info is updated in order to get a complete control of stats.
    - Infos are saved on DB every minute (mostly for timers). Drop the save on Shutdown.
    - Activation of //reload cw.
    - You can't rank up a CW on a summon anymore.
    - The 2 active skills are now linked to items directly.

Misc
    - Add missing Manor priviledges on L2CastleChamberlain.
    - Debug L2CastleChamberlain about clan members who couldn't access it, even with priviledges.
    - Fix 2 possible NPEs with getCurrentFolk(). Probably more to add.
    - Drop ExtractableItems.java itemhandler (unused, ty sahar).
    - Fix lethal chance of 3 skills (it's a base 1000, not 100): Banish Undead, Turn Undead, Banish Seraph.
    - Drop of FORCE_INVENTORY_UPDATE config (unused + buggy + fat code).
    - Fix a NoSuchElementException on L2WeddingManager.

PS:
    - //reload cw will clean existing CWs (as it setups default values, we can't keep current CWs, else we got issues).
    - CWs should be cleaned if they stay 1h on ground, currently it's not implemented.

====================================================================================================
Changeset 261 @ 2012.08.12

Knownlists cleanup, Treasure chests, Valakas & Baium fixes, misc

Knownlists cleanup
    - Drop of getKnownSummons system and associated map (unused stuff).
    - Better use of inheritance, use of protected key instead of private in order to use variables instead of getters (slight performance boost).
    - Maps are now directly initialized, which mean RAM usage is more important at startup, but one check is dropped on a overused command, and we get ride of any null case (it can be only empty).
    - Addition of getKnownNpcs() method, move getKnownSiegeGuards() from L2Door to ObjectKnownList.
    - Drop all null checks from knownlists. It is explained because getKnownXXX checks "if obj instanceof XXX", which means if it is instanceof XXX, it can't be null.
    - getKnownXXX return a Collection, not a Map anymore. For Map, use getKnownXXXMap() (used only in getKnownRelationsMap() and getKnownPlayersMap()).
    - Drop of MOVE_BASED_KNOWNLIST config and system (unused).
    - Change all getKnownXXX in order to use the most appropriate choice (avoid cast from L2Object to L2Character, for example).

Treasure chests
    - Unlock skillhandler has been fully reworked (drop of SocialAction, fix aggro on mimic, etc).
    - The trap system has been dropped, as chests use only one type of skill (suicide type one).
    - Drop of _mustGiveExpSp and associated getter/setter/use. doDie(null) means the monster doesn't give any xp/sp.

Valakas and Baium fixes
    - Use their NPC knownlists rather than zone knownlists (to avoid out of range issues).
    - Addition of a random number in order they pick another target after a while.
    - Valakas only: don't bother with L2Pet anymore && raise by 2 the radius to count ppl for AoE skills behavior.

Misc
    - Cleanup some doDie methods (drop of a useless broadcastStatusUpdate(), cleanup in L2Npc (fusion stuff + try catch) and L2Character (fusion + pointless PhoenixBlessed stuff).
    - More uses of getFirstEffect() method instead of retrieving all effects and looping on them.
    - Mobs who die by suicide skill don't reward any XP/SP.
    - Drop 2 logs concerning "invalid clan id for player xxx" and "unknown skill for summon: xxx".
    - MoS AI see if you're a male/female in order to use "Brother or "Sister". Yes, I know. But it's like that.
    - Water flag is stored back in L2PcInstance.

====================================================================================================
Changeset 260 @ 2012.08.10

Skills rework (elemental, cancel, negate), misc

Skills rework
    - Implementation of following methods: ssUncharge(), spsUncharge(), isSoulshotCharged(), isSpiritshotCharged() && isBlessedSpiritshotCharged(). Move ss/bss checks out of targets loops.
    - Fix Cancel/Banes skillhandler:
        - Formula rework: addition of level diff, baseRate (80% for single target, 40% for aoe), and vuln is now applied on the good section of formula.
        - Toggles aren't counted anymore as possible effects to cancel.
        - Failed attempts are now counted (before effects were looped until 5 effects were dropped).
    - All (L2Character[]) casts have been dropped in order to avoid ClassCastException using skills.
    - Cleanup BalanceLife skillhandler; store valid targets in another list rather than using old list and make twice same checks (...).
    - CombatPointHeal doesn't heal dead targets anymore.
    - Addition of suicide stuff on PDAM skillhandler (potential use for antharas minions).
    - NEGATE L2SkillType (part of Disabler skillhandler) is heavily cleaned, and not affected anymore by calcSkillSuccess().
    - Fix "SKILLS" elemental vuln/pro (revert to IL, was using postIL formula).
    - Addition of "WEAPONS" elemental system (fix skills such as Holy Blade toggle, Holy weapon PP buff). Vuln/pro affect damages TOO!

Misc
    - Cleanup && addition of missing PaganKeys, ty sahar. No clue if it's retail-like, they're added here for the moment.
    - NPCs social animations are divided by 2.
    - L2Npc: drop of _isBusy / _busyMessage and associated getters/setters + drop of the HTM.
    - Fix issue from previous commit about hpRatio impacting earned XP/SP (I HATE DOUBLE).

====================================================================================================
Changeset 259 @ 2012.08.07

Fishes rework (ty Java-man), misc (ty xblx for random fixes and sahar for reports)

Fishes rework
    - Handles differently load and get fish process (regroup data in 1 array instead of 3, avoid to create multiple arrays and new FishData objects)
    - Fix fishTable skills levels, ty 100500.

Misc
    - If identical jewel is currently worn, then replace the other slot if different (explanation is messy, but just test ingame and gtfo).
    - Fix an exploit using clan warehouse when you left your clan (active warehouse could be clan, and wasn't cleaned).
    - Fix previous knownlists update (int cast was affecting only 1.5 value). It is rounded aswell.
    - Fix pets pickup, which are now affected by party distribution modes.
    - Fix Goblets NPC.
    - Fix double click on dead monsters (avoid to be stucked), cleanup those methods aswell. Drop of canTarget() method.
    - onActionShift() use L2PcInstance rather than GameClient as parameter.
    - Add skillId on callSkill exception log for easier debug purposes.
    - Fix 2 issues on Valakas AI and 1 on Baium AI, related to skills priority and offline target. Rework Baium getRandomTarget() method to be faster.
    - Fix a ClassCastException on RequestRecipeShopManagePrev packet.
    - Fix a NullPointerException on RequestPledgeSetAcademyMaster packet.
    - Fix an NumberFormatException with CrestCache system ("Crest_Large_" were cutted as "Crest_", and so the id was containing "Large_".
    - getCharactersInside() has been changed for a FastList instead of FastMap, as there is no interest to keep Map format. Use of _characterList rather than the getter.
    - sendPacket() implementation for L2Summon, which refer directly to owner.
    - L2GoldenRamInstance cleanup, the FastMap has been changed for an int[][]. Updates the related HTM.
    - Forgotten to add on timeline = xp/sp of monsters are affected by their HPs ratio.

====================================================================================================
Changeset 258 @ 2012.07.31

Siege/castles rework, misc

Siege/castles rework
    - Fix possible targets on siege summons skills (one siege summon can only aim L2PcInstance, others can only aim L2DoorInstance).
    - Fix doors issue (doors not respawning at siege end). At siege end, they revive, fully HPregen and close if opened.
    - Doors don't respawn if destroyed during a midVictory, but they will respawn at siege end.
    - Castle chamberlain instance is fully rewritten, HTMs names have been shortened and content is harmonized. Many privileges checks have been added.
    - When a castle wall is destroyed, the correct message is displayed.
    - Skill cast on Artifacts is fixed (changing target before the end of "Seal Of Ruler" won't stop the skill)
    - Addition of retail-like castle gate upgrade system via castle chamberlain.
        - It uses 2 "cursors" to calculate the price:
            - Type of door (basic doors, additional doors or walls)
            - Power of the reinforcement (x2, x3 or x5 HPs).
        - The cost of doors updates, as their pdef/mdef, are infuenced by Seal of Strife owner.
        - The upgrade is instant, and is loaded/saved through server restarts aswell (as I need _doorUpdates being fed for the hp ratio check on chamberlain).
        - All retails HTMs have been added, and checks are ok (not enough money in CWH, door already updated with a similar or better level, etc).

Misc
    - GMs non-aggro state has been moved from //invul to //hide command. Ty Pleasure for the good idea.
    - Drop some GMs "privileges" which could lead to "false alarms" reports from users (like GMs not being ported when a siege begins).
    - All variables are (and will be from now, no matter how sad Java-Man will be) initialized in the shorter possible scope. Fix an ugly issue where DoorTable was adding all left doors to latest castle _doors (so Schuttgart had 50+ gates). Castle gates aren't verified anymore for CH purposes.
    - Drop String.valueOf() on getNodeValue() - as the result is a String, it doesn't need further operation...

NOTE: TRAPS SYSTEM ISN'T MADE AT ALL. DON'T COMPLAIN ABOUT IT.

====================================================================================================
Changeset 257 @ 2012.07.26

General tasks, misc (ty ipxs for some reports)

General tasks - ty jurchiks for the idea
    - Following tasks are now handled by a unique task rather than using one task per player: PvpFlagTask, WaterTask && TakeBreakTask.
    - Those tasks use a Map in order to stock individual timers.
    - For 100 players, 100 TakeBreakTask were created, and as much tasks if (let's say) those 100 players are pvping (+100) under water (+100) = potentially 300 tasks. Now only 3 tasks are running, no matter how many ppl are online.

Misc
    - Add the Teleportation Cubic exit section for Baium (supposed to be handled in another script, moved in GrandBossTeleporters).
    - You aren't flagged anymore casting positive effects on guards (both siege and regular).
    - Fix castlewarehouse && castleblacksmith "busy" HTM, and add a clan right check for blacksmith (+ cleanup for both instances).
    - Fix Pa'agrio's Fist (must restore 100% CP, not simply 800).
    - Fix Fatal Counter (based on your own HPs, not enemies' + formula rework) - ty Duma. getPower() method loses one parameter.
    - Singletons on PetitionManager && AutoSpawnHandler
    - Revert some ArrayLists for FastList (fix concurrentException errors on sieges)

====================================================================================================
Changeset 255 @ 2012.07.14

Addition of Noblesse quests.
    - Q241, Q242, Q246, Q247

Knownlist conflict
    Idea is coming from Tukune from L2JForum. The Forget task got a lower radius than the Watch task (concerning AttackableKnownList and players, which is... 70% of scenarii), leading to attaching and detaching the AI of the mob if you're between both ranges.
    More infos and my answer on original topic: http://www.l2jserver.com/forum/viewtopic.php?f=77&t=24091 (http://www.l2jserver.com/forum/viewtopic.php?f=77&t=24091)
    - Tweak all radius in order Forget Task is - almost - always 1,5x/2x > to Watch task.
    - PcKnownlist dynamic range is even more dynamic (based on actual knownlist's size, begin from 3600 - 20 per ppl, minimum 1800).
    - Castles doors had some difficulties to be seen from far, now it's fixed.

Baium
    - Angelic Vortex (Baium gatekeeper) edition: add a missing HTM (baium state = dead), HTMize an hardcoded HTM, blooded fabric check occurs in good position.
    - Slight rework of Baium AI in order to chain animations faster and show the roar animation for the waker.
    - The waker probability to die has been fixed.

Misc
    - Add static SOUND_FANFARE in QuestState.
    - Addition of 3 locs for admins (GM goodies panel). Ty Pendragon.
    - Items 7677, 7678, 7679 are considered as qItems.
    - Fix 2 potential NPAs.
    - Titles regex pattern is dropped.
    - Addition of 2 missing tables on database_installer.bat.
    - Drop of PRECISE_DROP_CALCULATION config, which was affecting both drop chance and drop quantity. Now only drop chance are affected by server rates (avoid 5 RB jewels per boss).
    - Cleanup of calculateRewardItem and 2 almost same-looking methods from L2Attackable.
    - Fix the CW when wearing a FW. The FW is unequipped before equipping the CW (affects the admincommand aswell).
    - Fix a critical issue I added 2-3 revs ago concerning items which couldn't be picked up.
    - Fix a critical issue introduced by Hasha rework about Quest party system (NPE on fastlist). Change FastList for ArrayList.
    - Use of isClanLeader() when possible.
    - Missing singleton on L2World.
    - Fix the message when you're in a party: "blabla took +2stem", instead of "blabla took 2 stem".
    - Addition of a save noblesse option, as the noblesse status wasn't directly saved (so let's say server crashes before you delog at least once, you would lose it). Ty Hasha.
    - Drop following methods to use their regular counterparts (they're shorter to write, lol) and fix all occurences:
        - CursedWeaponsManager.announce( => Broadcast.toAllOnlinePlayers(
        - QuestState.getRandom( => Rnd.get(

====================================================================================================
Changeset 254 @ 2012.05.29

Java7 invasion! The summer is coming: cleanup on the code? Tale of an Eclipse come back!

Under that title which worths best animes', come some cleanup and use of java7 features:
    - Diamond for constructor invocations (+ activation of associated warning to be sure old system is correctly cleaned)
    - Try-with-resources block (also known as 'ARM block'); drop of apache commonsIO jar, drop of L2DatabaseFactory.close(con).
    - Fix all possibles methods when they can be static (+ activation of associated warning)
    - Fix all QUESTS STATIC maps (almost all...) to be "private final static" and "HashMap" instead of "FastMap".

If you got issues: download LATEST Eclipse (a 2011 eclipse isn't LATEST, as my previous Eclipse installation learnt it going to trash) and be sure your compliance level is setup to 1.7: http://www.cs.utexas.edu/~scottm/cs307/handouts/Eclipse%20Help/comp_Setting_1.6.jpg (http://www.cs.utexas.edu/~scottm/cs307/handouts/Eclipse%20Help/comp_Setting_1.6.jpg) (=> IN THE SCREEN IT'S PUT TO 1.6 PUT TO 1.7 AND IF YOU HAVEN'T 1.7 OPTION THEN GO DL LATEST ECLIPSE NUNUNU <=)

And if you're really dumb or drunk or just want to read more about it, Google it: "java compliance level 1.7 eclipse".

Here are the features of Java7, with Eclipse "changes" to support it: http://www.eclipse.org/jdt/ui/r3_8/Java7news/whats-new-java-7.html (http://www.eclipse.org/jdt/ui/r3_8/Java7news/whats-new-java-7.html)


I had to fix 1500+ warnings, so if you find something bad, you know where to find me.

====================================================================================================
Changeset 253 @ 2012.05.27

Multiple cleanups aiming better stability/performance.

Following Zoey76's (better known as "L2J cleanup guru") path, I decided to follow my (hidden) master.
    - Activation of 3 Eclipse settings, leading to:
        - Cleanup synthetic accesses warnings by dropping private for protected.
        - Cleanup 20+ "true" and 50+ "false alarms" potential null pointer accesses, leading to handlers reworks.
    - Cleanup synchronized lists/maps which got no reason to be synchronized.
    - Cleaning gsregistering (for a "not-RU" english).

TODO: make my eclipse accepts java compliance 1.7 in order to use Diamond and ARM Java7 features (currently greyed, dunno why). Else you will go to trash, you understand, Eclipse ? Bad, bad Eclipse!

====================================================================================================
Changeset 252 @ 2012.05.23

EnchantSkillsTree table rework, misc related to skills.
    - Addition of enchantType in enchant_skills_tree, where shared infos are loaded. The DP size is cut by 2, and we earn back 10mo RAM at startup.
    - The different used lists aren't synchronized anymore.
    - giveAvailableSkills() execution time is divided by... x15. You're right, from 3sec it goes to 200ms. From 300~ sent packets (for a DWARF, race which got the lowest numbers of skills), it goes to 12~. No lags anymore for the player, no hundreds packets sent / operations launched for nothing.
    - removeSkill() correctly clean toggle effects.
    - Multiple security checks are added on acquire && enchant (skill, skillInfo) packets.

Ty Hasha (aka Rainbow Dash) for the good work.

====================================================================================================
Changeset 251 @ 2012.05.23

Misc
    - BlockBuff / BlockDebuff core support + fixes on skills (Mystic Immunity, Day of Doom, Heroic Berserker). NPC passive aren't yet supported.
    - Clan is now instantly dropped if config is setted to 0. If clans are loaded, the task is now setted to 1min rather than 5min.
    - Clan notices are dropped when clan is destroyed.
    - Partial cleanup of beginCast( methods.
    - [L2J 5365] addition of hasPet() and hasServitor() methods + fix range in which the pet can get XP.
    - [L2J 5373] rechargeAutoSoulShot( method doesn't use anymore switch about itemId, but items' L2ActionType.
    - Creation of a .txt if user changed his name (ty Java-man).
    - *possible fix* _owner / getOwner() NPE (isAutoAttackable(), HitTask, etc). setOwner(null) was introduced when we had summon ghost issue, but since that time I found the real problem and so I revert this "fix" which probably make the cleanup hard.

====================================================================================================
Changeset 250 @ 2012.05.18

5 quests, misc
    - Addition of Q049 (untested as c/p of Q046), Q371, Q374, Q375 && Q603. Ty to sharers.
    - Fix songs panel (drop "back" button), ty AntiViruZ.
    - Drop useless skillhandler.

====================================================================================================
Changeset 249 @ 2012.05.17

Primeval AI, misc

Primeval AI
    - Addition of primitive system for following behaviors:
        - Pterosaurs and TRex-es can see through Silent Move (core support needed).
        - Ancient Egg, when attacked, will call all mobs in a range of 2k (guessed... as 1k is the aggro of a lot of dinos, I x2'ed it).
        - Sprigants will launch a task every 15sec if someone enters in their aggro range (AoE skill). Task stops if sprigant is dead or if none is inside anymore.

Misc
    - Addition of Q629
    - Fix summon sieges skills for "Siege Golem" and "Swoop Cannon".
    - Fix Sprigant's fruit and Primeval potion.
    - "String = "" > isEmpty()", "boolean == false > !boolean" && "boolean == true > boolean".
    - Fix a critical issue about quest check (added in previous revision).
    - MagicSkillUse packet is completed.
    - Addition of ConditionTargetHpMinMax, used for Trap Skills (avoid the ugly system of onSkillSee).

A lot needs to be done for PI (full trap system mostly), and it goes by gathering as many as possible informations.

====================================================================================================
Changeset 248 @ 2012.05.15

Misc
    - Add the missing Ketra/Varka AI petrification support (allied player helping - through positive effects - neutral/enemy player which attack a friend mob). It makes the difference between who casted it aswell (pet or player is paralized depending who casted). Unfortunately, it doesn't break the cast (because onSkillSee works when skill is already launched, else it would need an ANTICIPATION of the mob).
    - Fix Raid Curse stuff (too much c/p kills the c/p), and improve a little the coding.
    - Drop all "Util.contains(" checks on Monastery. Those checks are made way before, and aren't necessary on that script, as arrays and behaviors aren't melted... Mobs are individually registered.

====================================================================================================
Changeset 247 @ 2012.05.14

Misc
    - Fix GandBossTeleporters script (HTM/SQL side). All IDs are supposed to be ok.
    - Add a check for groups on Quest for radius (ty Hasha). Ideally, it needs to be spread to any solo quest.
    - Cleanup (L2SiegeGuard, 2 itemhandlers with postIL stuff, AttackStanceTaskManager).
    - Colors of title/name is corrected (ty TheEngo)
    - Toggles are desactivated when taking a CW.
    - Drain skills HP gain effect now effects monsters (+ rework of the skillhandler).
    - Correct Lotto ticket (ty Pleasure).

*normally* fix AutoChatHandler issue.

====================================================================================================
Changeset 246 @ 2012.05.08

Community Board (CB) part I, misc

CB is mostly cleaned up.
Some efforts have been made in order to use static stuff (like static strings && static ShowBoard objects).

A LOT of work is needed to complete it correctly (in disorder: cleanup hardcoded HTMs, recode HTMs to fit with IL CB dimensions (on IL, CB is more little...), add missing code, add GoD region tab)

CB
    - Custom region tab has been entirely dropped.
    - Friends panel is 50% implemented.
    - Clan notices system is implemented, but not tested at all (and probably not working).
    - Mail system is implemented, but check previous sentence for more infos.
    - Clan forums aren't created anymore if CB isn't enabled.

Misc
    - addReputation / takeReputation are the only commands to affect reputation (setReputation is used only for loading and as "core" for the 2 previous commands). They save *only* reputation from now, not the whole clan infos.
    - getHasCastle() and getHasHideout() have been renamed getCastleId() and getHideoutId(). Creation and use of hasCastle() and hasHideout() boolean methods.
    - getActingPlayer() uses on SiegeGuardKnownlist, GrandBoss and RaidBoss instances.
    - Many random methods are cleaned up in order to create less objects, adding checks && readability.
    - Addition of getClanAllies() method, used to retrieve clans in alliance.
    - Addition of AllianceInfo serverpacket (untested)

Reminder for future: it's better to initialize variables INSIDE a loop (in order to reduce scope range). The logic consisting to think to initialize it outside is better is false and is even worst.

====================================================================================================
Changeset 245 @ 2012.04.29

Retail enchant system, quests, misc

Retail enchant system
    - Differentiate fighters && magic weapons (ty rocoder for the DP parsing). Implementation of isMagical() in L2Weapon.
    - Drop config related to jewelry.
    - Different rate when weapon reach +15.
    - Max limit is set back to unlimited.
    - The chance is now a double, not an int anymore, in order to keep accuracy (for armor).

Quests
    - Addition of Q632 && Q642, ty Hasha && EnDmOsT.

Misc
    - Some packets rework, ty Java-Man. Addition of isForThisClass() method. Hennas packets should be tested deeply, but from my few tests, they work.
    - Merge of HeroSkillTable and NobleSkillTable with SkillTable, ty Java-Man.
    - You can't PM yourself anymore (ty xblx for suggestion). It's not retail-like.

====================================================================================================
Changeset 244 @ 2012.04.28

43 quests / quest engine, misc.

Ok, that does 3 weeks I didn't commit. I worked IRL 3 days, I reinstalled OS and softwares for 2 days, I played 1 week. So yeah, in 3 weeks I worked on project only 1 week. I don't apologize, I just let you know (yyyeaahhh, changeset used as autobiography, problem ? Want to fight ? ^^).

43 quests / Quest engine
    - Sagas are implemented.
    - Varka / Ketra alliances + related quests (except magical blabla part 2) are implemented.
    - All quests sounds (6 so far, the complete amount is 8 but the 2 missing are never used) are now hardcoded and static. Ty Hasha for the idea.
    - Varka / Ketra alliance system (killing ally friend drops alliance level) is moved to KetraOrcSupport and VarkaSilenosSupport. Two checks are common to 10 different quests, on regular L2J you got 10 checks (so yeah 5x2 clone arrays of registered mobs).
    - Addition of dropAlwaysQuestItems(int, int, int). That method is used when quest item drop is 100% (avoid to generate random number)
    - Fix - when possible - every onKill section in order to use dropQuestItems / dropAlwaysQuestItems methods.
    - Drop of the parameter in getNoQuestMsg() and getAlreadyCompletedMsg() methods.

Misc
    - Mob attack stances has been harmonized through the different uses (Baium, L2AttackableAIScript, etc).
    - Paagrio => Pa'agrio typos fixes.
    - Rework of broadcastPacket() method. It will use now the static system from Broadcast class. Added to that, the particular system from L2PcInstance regarding CharInfo is dropped. A special method is now used to broadcast it (named broadcastCharInfo()).
    - When you interact with a shop player, you will turn yourself in front of the player.
    - TargetSelected packet isn't sent to yourself anymore (only broadcasted to others).
    - Random tweaks on multiple methods (cleanup, checks imbrication, deletion of pointless stuff, and so on).
    - Addition of many informations regarding "sell, buy, warehouse" packets. Generally all regarding Inventory. Additions of many null checks aswell.

====================================================================================================
Changeset 243 @ 2012.04.03

Quests - ty to sharers.

    - Addition of Q316, Q325, Q329, Q422 && Q627.

====================================================================================================
Changeset 242 @ 2012.03.27

Quests - ty to sharers.

    - Addition of Q266, Q313, Q345 && Q631.
    - Fix a little issue in Q619.

Special mention to Q345 which was missing one NPC, 50% of HTMs and 2 options of urn.

====================================================================================================
Changeset 241 @ 2012.03.25

NPC Skills

Go from 20852 skills loaded to 67807 (x3 skills). 20mo RAM usage added.
Based on L2OFF Gracia, ty agurkasz for the parsing.

If you find aberrations, please fix and/or report.

====================================================================================================
Changeset 240 @ 2012.03.20

Caches rework by Java-man.

HtmCache && CrestCache:
    - Cleaner code (avoid to create 1 FastMap per type of crests, avoid CrestCache instanciation using static stuff, drop the LazyCache config)
    - Reduction in memory usage (drop of FastMap usages for others types of lists - Trove and ArrayList).

PS: new JAR to add.

====================================================================================================
Changeset 239 @ 2012.03.19

Seven Signs refactor, AutoChatHandler rework, quests, misc.

Seven Signs refactor
    - Update the main engine, adding multiple missing things:
        - Seal of Strife effects (blocking siege summon, debuff/buff, limit uses of mercenary tickets)
        - Can't have sieges and seven signs in same week (+1 week for sieges if the same)
        - Dawn/dusk crests are now correctly handled.
        - Anakim / Lilith GKs are now correctly handled (via teleports scripts). They spawn 10sec after RB death, and despawn 15min later. Old autospawn lines are obviously dropped.
    - CabaleBuffer rework.
    - Split of L2SignsPriest in 2 others entities, L2DawnPriest and L2DuskPriest.
    - Additions of 3 teleports in scripts folders.
    - Complete rework of HTMs, based on latest L2J (itself based on L2OFF Gracia). HTMs are harmonized; understand I tried to follow a generic "template" when I corrected HTMs - as the translation was approximative sometimes (Record of the Seven Seals != Record of Seven Signs)...

AutochatHandler rework
    - Migrate SQL => XML. Drop of 2 SQL tables, addition of 1 XML.
    - The engine can now read one single message and register it for multiple NPCs.

Quests
    - Addition of Q113, Q319, Q320, Q341, Q385, Q634, Q637, Q638, Q647. Ty to all sharers for their initial work.

Misc
    - Fix a ClassException at TamedPetInstance when they tried to retrieve skills list.
    - L2DungeonGatekeeper instances are now invincible.
    - Fix "Rift Post" teleport option ("I want to go back to my world") via added teleports scripts.
    - L2Npc showChatWindow() method cleanup, using inheritance (split in L2FestivalGuide, L2SignsPriest && L2Auctionner).
    - Auctionners don't show anymore actual bid.
    - Observers can't use force attack anymore to target players.
    - GMs aren't hidden and invul anymore if they were observing.
    - Addition of isSiegeSummonSkill() method on L2Skill.
    - Partial rework of methods to correct siege date, mainly to improve performance (all actions from while loop made on a local variable, then registered in getSiegeDate(), drop of the hour from the loop).
    - Addition of startQuestTimer(String name, long time) method (no NPC nor player registered for it).
    - Fix an Augmentation issue: gemstones weren't used... I still don't understand why.
    - Addition of 100500's patch about a couple of items (L2EtcItem => L2Armor).
    - Some null checks on Collection (2 on Baium), and "fix" (deleting) one logged NPE on L2AttackableAI.

PS: Q635 doesn't exist on L2J. Content is on OracleTeleport script.

Due to numerous changes, some things haven't been tested: Seven Signs complete game cycle, Festivals, AutoChatHandler uses (only when a side win, with cabale buffers). If you find errors, make a unique topic about it with all types of errors (broken HTMs, broken game cycle, or whatever). Ty in advance.

====================================================================================================
Changeset 238 @ 2012.03.05

Movement rework, misc

Movement rework
    - This is a code I found on L2J forums. I searched for initial post, but didn't find back, lol. Haven't clue about credits, I just can say the guy is russian. Sorry stranger for the no-credits :/.
    - This code is EXPERIMENTAL; I didn't find strange issues after 2 days, but report if any occurs.
    - Fix the "ghost attack" when you move and a mob attacks you. Now the complete attack animation occurs. And yes, it's normal the monster does the animation even if you are running far from him. Works the same on L2OFF. Before the attack was occuring but you didn't see the animation and the monster was still moving.

Misc
    - /unstuck doesn't work anymore when you are afraid. Drop a double check aswell.
    - Fix NPEs on augment exploit. Happen when you don't sleep a lot.
    - Drop the old intention when you cast a skill (exemple, when you were moving). If a particular intention hadn't to be dropped while casting, report on forum.
    - Reflect damage skills type don't kill you anymore (stuck at 1). Well, shouldn't.

====================================================================================================
Changeset 237 @ 2012.03.03

L2Teleporter && L2DungeonGatekeeper, misc.

L2Teleporter && L2DungeonGatekeeper
    - Teleporters night price is implemented (price /2 when real life night occurs).
    - Split L2Teleporter to 2 distincts entities. Avoid to use a big switch about npcId.
    - Gatekeeper Ziggurat conditions are now implemented (must be from the winning side).
    - Fix Giran Harbor GK (drop one location, fix prices).

Misc
    - Static packet for ShowMiniMap (case of regular map).
    - Static packet for EnchantResult, and fix the previous commit (switch from 0 - considered as a success - to 2 - abort).
    - RBs are now automatically concerned by MANADAM and MDOT type skills (but still got regular resistance from mobs).

====================================================================================================
Changeset 236 @ 2012.03.03

Formatting rules, took from latest L2J, both for DP (java scripts) and core.
    - Indent all files correctly, and remove useless spaces.
    - "for" loop enhancements when possible.
    - Put final keyword when possible.
    - Fix 1600+ warnings on Javadoc (at hand...).
    - L2DabaseFactory.close() addition.

To be honest, I'm not trully satisfied about arrays type, mainly when used in int[][] or in maps - results become unreadable. Perhaps later I will change it.

I will use an Eclipse feature (=> http://stackoverflow.com/questions/234594/eclipse-can-you-format-code-on-save (http://stackoverflow.com/questions/234594/eclipse-can-you-format-code-on-save)) using those new templates, which mean there shouldn't have anymore commits with empty spaces, commas change, indentation and others misc. If I redo a change it will be general (like array exemple said higher).

"if/else", "for" brackets aren't automatically edited. There wasn't the rule I currently use.

====================================================================================================
Changeset 235 @ 2012.02.27

Olympiads && Heroes, misc

Olympiads && Heroes
    - Partial addition of L2J fix 5188. Ty Zoey76. Read it on L2J timeline for more infos.
    - Split one check in 2 for checkNoble( method, and retail systemMessages for both of them.
    - You can't see inactive heroes anymore on Monument of Heroes.
    - You can't activate hero state if you're on a subclass or are less than level 76 on you main class.
    - Following values have been modified to fit with IL - using PMFun infos - (the previous refactor has been made from C4 infos):
        - Length of a match: 3min to 6min.
        - Divider for non classed matches: 3 to 5.
        - Number of needed matches to pretend to Hero status: 5 to 9.
        - Waiting time before Stadium teleport: 30sec to 120sec.
        - Preparation time: 45sec to 60sec.
    - Buff section is now handled 20secs before match beginning.
    - A second full heal is applied during buff section (the first occurs at teleport).
    - Shops, as sit state, are broken when you teleport IN and OUT of an stadium. Addition of forceStandUp() method on L2PcInstance for easier use.
    - Buffs are cleaned up only at teleport OUT, not directly after the victory/defeat/tie of the match.

Misc
    - AdminMovieMaker: IOOB exception catched (ty SweeTs report), 2 typos fixed in commands (bro'a'dcast, not brodcast), don't create intermediate variables "val" && "id".
    - Cleanup of L2AttackableAI/L2NpcTemplate: drop of useless code, add of public getters, use of !isEmpty() instead of != null. Should drop the NPE when a mob tries to use a skill.
    - Revert magic fail formula (custom L2JFree => L2J). I kept the accuracy at 2 decimals.
    - Break enchant process and send systemMessage BUT CONTINUE the action in following conditions:
        - You give / take an item from your pet.
        - You give / take an item from warehouse.
        - You are pressing any type of bypass link from a warehouse NPC type (castle / normal).
    - Can't interact anymore with any NPC if you're on transaction process.
    - If you're actually in transaction process, break following actions:
        - You give / take an item from your pet.
        - You give / take an item from warehouse.
    - Fix Chant of Victory issue with rCrit (basemul != mul).

Report any issue on Olympiads, and CLEAN CORRECTED ISSUES in the dedicated thread, ty in advance.

====================================================================================================
Changeset 234 @ 2012.02.23

Misc
    - getType() is dropped both for clientpackets and serverpackets, ty java-man.
    - L2HennaInstance is dropped, we work only with templates from now, ty xblx.
    - All serverpackets sending only opcodes (triggers packets) got a STATIC_PACKET system. Triggers packets structure is harmonized.

====================================================================================================
Changeset 233 @ 2012.02.20

AQ, commands and misc

AQ
    - Fix Queen Ant death NPE; avoid to register infos if AQ is supposed to be already dead (you can summon it manually and kill her, but it won't change anything in database, such as respawn timer and others).
    - Drop of onAggroRange() stuff (probably postIL stuff).
    - Drop of double code on spawnBoss().
    - Addition of missing minions (nurses and Royal Guards).

Commands
    - spawn_monster: drop that deprecated command, and rework of incriminated HTMs to use regular //spawn command.
    - npc_edit: drop of "armor" and "absorbLevel", addition of "enchant".
    - npcinfo: addition of "corpse delay" and "enchant".

Misc
    - autoAttackCondition() method rewrite.
    - Update of EffectParalize and EffectPetrification (use of effect flag), now you will stop to move.
    - Cleanup in Raid curses; a skill will put you silence no matter what skill type it was (as silence is both for physic and magic skill), drop of some code (handled by effects due to effects rework).
    - StaticObjects cleanup (drop of the map storing objects, no more instanciation). Ty Java-man.
    - Drop of giveRaidCurse() method and uses (was always true); used only once in a postIL quest.
    - An academy member haven't to see wartag clan enemy member, and vice-versa.
    - NPE corrected in RequestActionUse and unsummon actions are harmonized between servitors and pets.
    - Rewrite of my previous commit about karma/pvp flag on summons. There's a special packet made for that, RelationChanged, instead of SummonInfo/CharInfo. Addition of broadcastRelationsChanges() method on L2Playable, overridden in L2PcInstance && L2Summon. Normally from now, the relation between summons && players (autoattackable when pvpflag/karma/siege) should be ok.
    - Cleanup Broadcast.java, adding multiple null checks and put Collections with "final" key.
    - Fix one RB location, ty 100500.
    - Fix a stupid error I included myself; 2 mobs from different clans could help each others... Ofc only same clan can help each other. Rehabilitation of the faction name check.

====================================================================================================
Changeset 232 @ 2012.02.18

4 quests, misc.
    - Addition of Q291, Q303, Q347 && Q354.
    - Fix Judgment (can't be used with dual sword).
    - Fix 4S NPE at shutdown (drop existing tasks before bossZones cleanup).
    - Correct /gmlist check (my fault)
    - RequestManorList packet under static format.

====================================================================================================
Changeset 231 @ 2012.02.17

Quests, misc

Quests
    - Addition of Q023, Q364 && Q378.
    - Fix 2 issues in Q021.

Misc
    - Fix 9 SoEs and 5 others items (needed core support aswell).
    - Don't launch a pvp flag task if one already exists.
    - Don't autoattack (some skills got that behavior) if target isn't autoattackable.
    - Cleanup valueOf => parseInt/Long/Boolean (surely more to do, only in Config atm).
    - You don't lose your buffs anymore if you cancel the autoress from PheonixBless type skills (but you still lose PhoenixBless effect && Noblesse).

====================================================================================================
Changeset 230 @ 2012.02.14

Numerous cleanups on clientpackets, misc

Clientpackets
    - Addition of null checks (around 20, if not more), "final" keyword.
    - Drop of the personal Logger for each clientpacket, they share the same now.
    - Reworked a couple of packets: checks better placed, better use of variables when possible, etc.

Misc
    - Addition of TradeItemUpdate serverpacket, based on L2JBroken one (and surely based on another russian pack), ty Kenrix.
    - Fix the problem with olympiads tokens and fix the message aswell (ty McMaGo, Brucutu, SweeTs for reports).
    - Some XMLs tables are refreshed; less objects created.

====================================================================================================
Changeset 229 @ 2012.02.11

Henna rework, ty xblx for the good work.
    - XMLization of hennas; 3 SQLs are dropped and their infos are written in a unique file: henna.xml.
    - Fix an issue with Human Mage class (class n10), which could wear dyes - but shouldn't be able.

====================================================================================================
Changeset 228 @ 2012.02.10

AbstractNpcInfo, polymorph, summons/pets, quests, misc.

Implementation of AbstractNpcInfo
    - SummonInfo, PolyInfo and NpcInfo share the same Abstract layer.
    - CharInfo code about polymorph is cleaned. All is made with knownlist.
    - Addition of a config to on/off NPC crests (when a clan own castle linked to a town). Ty SweeTs for inspiration.

Polymorph
    - Drop of 3 admincommands (polyself).
    - Polymorph commands work by default on yourself if no target is found.
    - Addition of success messages on command uses.

Summons / pets
    - Addition of a config to on/off owner's clan crest on summons.
    - Fix titles: summons (blue color) and pets (green color).
    - Fix team circle (duel), karma and pvp flag (summons color name, based on owner's).

Misc
    - Addition of broadcastNpcSay(String) in L2Npc, and fix all uses for that new method.
    - Drop of setKarmaFlag(int) and broadcastTitleInfo().
    - Addition of 2 quests (2/5 FoD quests made): Q021 && Q022.
    - Addition of retail chat windows for Mysterious Wizard (located near spawn of FoD).
    - Addition of minions infos for 2 mobs in FoD.
    - L2CharTemplate rework (private variables, public getters).

====================================================================================================
Changeset 227 @ 2012.02.07

Addition of 8 quests, ty to all sharers.
    - Q124, Q299, Q300, Q328, Q352, Q353, Q355 && Q366.

TO SHARERS:
    - If you made one of those quests, please READ and ANALYZE the differences between your old share (they are kept in Archives section, you normally got access) and the current rewrite. From looking differences, you can learn what I dislike as typo, what, why and how I corrected.
    - I would like to repeat, as Inner Circle you got access to some internal infos, such as L2OFF HTMs. Use it!
    - And ofc, read a walkthrough of concerned quest when you code the quest. The reward formula is one thing, the complete walkthrough is another! :D

====================================================================================================
Changeset 226 @ 2012.02.06

Quests and minor fixes - ty to the numerous contributors.

Quests
    - Addition of Q298, Q317, Q368, Q370 && Q432;
    - Fix a couple of existing quests (correct solo => party quest statut, and deletion of useless checks).

Fixes
    - Addition of a missing NPC spawn.
    - Correction of an HTM.
    - 2 items fixed.

I must apologize about current project's progression. I played a lot those days.
I got an Othel rogue lvl 86 40% (with 3 subclasses, 75 HE / 75 ES / 65 Pal) on Core server, so don't search where was gone my time...

====================================================================================================
Changeset 225 @ 2012.01.27

Raid bosses minions update.

Ty to 100500 for his detailed work.

====================================================================================================
Changeset 224 @ 2012.01.27

isMagic / staticReuse, typos.

Fixed hundreds of skills using L2OFF infos about isMagic / staticReuse system. Ty dEvilKinG for the good job.
Typos for classes folder. Nothing special.

====================================================================================================
Changeset 223 @ 2012.01.27

Addition of 7 quests - ty to sharers.

Addition of Q104, Q257, Q331, Q351, Q431, Q623 && Q644.
Fix a couple of typos and rewards on Q105.

====================================================================================================
Changeset 222 @ 2012.01.11

Quests and misc
    - Addition of Q350, Q618, Q645 && Q646. Ty to sharers.
    - Fix the systemMessage about double summon.
    - Addition of a systemMessage when pet pickups a full item.
    - Eventual fix of a NPE.

====================================================================================================
Changeset 221 @ 2012.01.08

Misc
    - Addition of missing skills for 3rd class summons.
    - Fix //polyself, adding check on templates.
    - Remove the useless button "Diet" on admin panel.
    - Addition of Ketra/Varka support. Ty fernandopm/Kenrix for their work.
    - Correct some things on " chat (GMs aren't blocked anymore), and send systemMessage when possible.
    - Porta skill (GetPlayer) is now retail-like.
    - Fix an issue about BossZone (L2Summon != L2SummonInstance)
    - Avoid to stuck client if you try to exploit augment panel (trying to drop weapon/gemstones/LS).

====================================================================================================
Changeset 220 @ 2011.12.23

Pets update, misc.

Ty to all contributors - Sikken, xblx, Junior, MC.

Pets are now normally fixed.
    - When a pet raises level, his stats and HP/MP infos are corrected shown.
    - Fix an issue when you give a name to your pet.
    - Pet control item is now correctly updated, both on name update and pet level raising.

Misc
    - Fix 4 skills.
    - Addition of Life Stones in GM shop.
    - Monastery AI sends now only one type of chat, but it is retail-like (better 1 retail than 3 customs).
    - Fix 2 teleports location - untested.
    - Addition of a check to see if entered id is a valid NPC template for //polymorph. In addition, you can't transform if you're already mounted.
    - Fix an unvalid SystemMessage.

====================================================================================================
Changeset 219 @ 2011.12.17

MASSIVE UPDATE - YOU NEED TO USE JDK 7 FROM NOW.

Well it's a really huge update. JDK 7 is now needed. Ty xblx for the libs update.

GENERAL
    - Updates of all existing libs, leading to heavy changes (mainly Trove-based codes).
    - Update of base64 code.
    - Update of internal Java-engine (scripts engine) which needs JDK 7.
    - build.xml will now check if you use JDK 7 or no. If no, build will fail, and an error message will invite you to dl latest JDK.
    - Addition of L2TIntObjectHashMap on util.

NCPS RELATED
    - NpcTable code is fully reworked, utilitary "getters" aswell. More infos on GS start aswell.
    - Update of npcskills (ty to old DiNoR rework), using L2OFF values. Changes are huge and correct known issues (ex: Prismeval island):
        - Active skills => from 15894 skills, it now loads 20844 skills.
        - Passive skills => 7k~ skills added.
    - L2NpcTemplate values are now private. Creation and use of "getters". Addition of isType("").
    - Aggro value is now loaded from AI (instead of npc.sql). All aggro ranges > 1 and < 500 have been changed for 500.
    - Sieges guards AI has been updated.
    - Overhit flag is reseted when the L2Attackable dies.
    - Creation of _staticAIData on L2Npc, which avoids to refer to template each time.

PETS && SUMMONS RELATED
    - Baby pets are fully reworked (addition of conditions such as mp consumption, pet mental behavior (betrayed, blabla), etc).
    - Tamed beasts got a little update, as getSkillsArray() exist now.
    - Levels of pets skills are now correctly calculated. It can use lvl 1-12 skills levels following pet level.
    - Fix an issue about items consumption @ SiegeSummon, leading to "ghosts" summons. Ty xblx for fix.
    - If you try to use a skill than a summon should have but haven't, it shows you the missing skillId to add on npcskills.
    - When you try to use a pet skill but difference of lvl is > 20, you can't control the pet.

MISC
    - Harvest/Sow skillhandlers are reworked, and Seed system too.
    - Addition of _skillMaxLevel in SkillTable, preloading max level of skills in a map for future uses (before it was made on the fly).
    - Orc mages are now considered as mages, not as fighters anymore (should fix the SpellForce issue).
    - Fix Orfen messages for retail ones.
    - Correction of a couple of items. Ty SweeTs for patch, it is *untested* but should work at first look.

I'm aware there's an issue about pets. HP/MP are not working as intented (not readed from PetDataTable). It leads to problems like a lvl 15 wolf got same HPs than a lvl 55 one, or a pet can't use properly a skill because asked MP consumption for skill use is higher than maxMP. Others stats are correctly working.

====================================================================================================
Changeset 218 @ 2011.12.13

Pets big update, accessories debug, little npc.sql update.

Okay, that's it. I'm first sorry for the delay. I was taking a little break trying GoD on EU server (btw my name is Tryskell, /friendinvite me if you see me ingame). I reroll a lot to make a lot of money, enjoy the free exploit...

Second, the update is quite "big", even if it's not really awesome. I had to check many things about pets, because they were entirely messed up. I hope the biggest part, if not all bugs, are now corrected. I tested almost all possiblities (force delog, etc) and all seems fine.

I had to check aswell the npc.sql Darth sent me. After a couple of checks I had to ask to Darth to split data in 2, because it was really messy (collision system is a little stupid in L2J...).


Pets updates.
    - Fully fix pet weapons and armors equip, and "race" condition (hatchling/wolf/blabla). I decided to keep the old system as it was really easy to understand it. The core changes automatically the bodypart for "chest" or "r-hand" following type of item.
    - Addition of a feature (dunno if it's custom, and don't report because it won't be changed): if you right click on a pet weapon/armor from YOUR inventory, it automatically TRANSFER && EQUIPS it to your pet's inventory if you got a pet summoned. Previous equipped item is desequipped and stays on pet's inventory..
    - Fully fixed stats modifiers of summons (seriously it was a pure mess, many buffs just did nothing before, pets had 0 accu/evasion).
    - Decreased amount of packets sent compared to current L2J (-1 packet per 10sec, and that fix too a minor bug targeting pet window every 10 sec)
    - Off-like (if not retail) transfer system at unsummoning pets. Ty SweeTs for the report. Inventories of pets are cleaned at delog/unsummon, transfered to your. There is no check about slots/weight, as it is used for DELOG (and imagine at delog that don't transfer, you lose items lol).
    - Fix RequestPetUseItem behavior. Now only one itemhandler is readed (using a pet food you had twice the code readed before o_o).

Misc
    - Fix the mythic accessory bug aCis got since 100+ revs (about 2 slots accessories). Now all is fine. Enjoy Wizard's Hat.
    - When you pickup arrows and it fits with your bow and you are arrowless, arrows are now automatically equipped. Ty bomj for report.
    - Improvement of npc.sql, with the addition of retail decay system. Now all mobs got their particular timer. It debugs mobs like Gigantic Chaos Golem. Only L2Attackable are concerned, as they are the only ones supposed to die. Others use the hardcoded in core as a default, which is 7 secs (still, the SQL is correctly filled anyway). Addition of all missing weapons (some can still be wrong, but it should fill a lot of templates).
    - A couple of NPE fixes (itemhandlers).

====================================================================================================
Changeset 217 @ 2011.12.02

Addition of 6 quests.
    - Q264, Q338, Q356, Q621, Q649 && Q651. Ty to sharers.

HTM typo fix, ty vl4d to pointing it.

====================================================================================================
Changeset 216 @ 2011.12.02

4 quests, many misc. Ty to FighterBoss, Sikken, EnDmOsT, dEvilKinG, Vhalior && SweeTs.

4 quests
    - Addition of Q296, Q636, Q640 && Q659.

Misc

    - Fix many skill reuses and hitTime to follow L2OFF. Some skills are more balanced, and globally classes which suck, suck less.
    - Corrected 2-3 HTMs typos.
    - Fix some items (Potion of Revenge && Endeavor potion, Shining Bow reuse delay,...).
    - Unhardcoded Olympiads item restriction. Drop of the previously added isOlyAllowed system, to use "is_oly_restricted", added long time ago by DiNoR. Understand now any item can be used on Olympiads, but is limited by "is_oly_restricted" when setted to True. If you find an item with/without that check when he should haven't/have it, consider to share diff patch about it. The related config is dropped.
    - Added "Blessed spiritshot for pets" in the restriction list, aswell as the autoactivation. Removed Star Shard (elven firework) from restrictions.
    - Fix Pagan Teleporter about Faded item.
    - Fix Linux DB installer (missing from previous commit). Ty DarthVader to pointing it.

====================================================================================================
I decided to let anyone check detailed version of that topic, like that eventual testers can test things more accurately. I'm a whore, but not a sadist.

Changeset 215 @ 2011.11.29

Olympiads (part I), misc

Olympiads

Well that was kinda long and I'm fed up to test all again and again (tri-boxing). Part I will be followed in future by part II when/if problems are found. For the moment, I know one "major issue": one of player (the second registering so far) see his own HP bar instead of enemy's.

The implementation is supposed to be FINAL. Report anything which isn't retail-like in order I correct it. If you're Inner circle member you got access to my notes about Olympiads. So consider to use them, and try to find infos on others websites if you think something is wrong.

So here is a mini list of features:
    - Freya Olympiads downgraded to IL, including damage amount count (summons too), retail uses of olympiad zones, improved timing system, pretty organization splitting.
    - Retail olympiads observation system, with updated state (in progress, counting time, terminated,...)
    - Heroes diaries and hero message (@Monument of Heroes).
    - Retail items usage (firecrackers / echoes crystals / energy stones allowed - addition of isOlyAllowedItem() -, autosoulshot/manual BSS are forgiven).
    - Retail Hero pickup at the Monument (leeched from Sigmo, which leeched from another pack surely).
    - Reorganization of admin commands based on Olympiads in a particular handler, AdminOlympiad. Some commands are refactored (setnoble, sethero) to be far lighter.

Misc
    - The pet's name on summon item is now updated when you choose a pet's name.
    - Improvement about clientStartAutoAttack (when your summon hits an enemy, you're in attack stance; now it sends far lesser packets)
    - More uses of getActingPlayer().
    - Logout packet doesn't update items anymore. It seems it wasn't needed at all (even crashing client, that was saving amounts).
    - IdFactory deletes many more infos if character was previously deleted (so better cleanup is made).
    - Addition of dropAllSummons() in L2PcInstance - do as the name says.
    - Correction of a couple of SystemMessageId (hi5 => back to IL).
    - Fix the problem with sendPacket(SystemMessageId) from L2PcInstance.
    - L2SkillTeleport cleanup.

====================================================================================================
Changeset 214 @ 2011.11.17

Q295, Q297 && Q362 - ty fernandopm && EnDmOsT.

====================================================================================================
Changeset 213 @ 2011.11.17

Six quests, misc.

Quests
    - Addition of Q117, Q262, Q617, Q650, Q652 && Q653. Ty fernandopm && EnDmOsT for the good work.
    - Q652 && Q653 are partially rewritted compared to L2J. The initial spawn and respawn of NPCs are handled by scripts directly. HTMs have been improved too, as L2OFF itself seems wrong.
    - Q650 needed a multisell change, as rewards were wrong.
    - Some minor typos on existing quests.

Misc (L2Party)
    - A bug concerning messages when your party member obtain an item with > 1 amount has been corrected. Ty Sikken for the report.
    - A message about obtaining enchanted item has been added (missing on current L2J trunk...)
    - Some eventuals NPEs have been fixed (3-4), and a general cleanup has been made (sometimes coupled with code improvements).

====================================================================================================
Changeset 212 @ 2011.11.17

3 quests, Tutorial core side.

Quests
    - Addition of Q105, Q116 && Q260, ty EnDmOsT.
    - Fix Q158, ty Vhalior.

Tutorial core side
    - Addition of 4 missing clientpackets.
    - Addition of missing events.
    - Name of the quest will be "Tutorial". It will be perhaps even dropped of quests folder if there is no need for it to be here.

====================================================================================================
Changeset 211 @ 2011.11.11

Little summons update
    - Fix the ghost summon issue.
    - Aggro is given to summoner at summon's death (not on pets).
    - Summons are protected at spawn (if spawn protection config is activated).
    - Summons use the correct value of beast ss/sps instead of regular 1 value.

Misc
    - HTMs typos on previous commit.
    - Typos on Q619, ty Vhalior.

====================================================================================================
Changeset 210 @ 2011.11.11

Shadow weapon restrictions.

Ty to RaphaelFersan and Alexa tries.

However, that wasn't enough :P. Added to L2J, addition of a link with Coupon Ticket multisell (as L2OFF, surely the same than village masters offer to you). As Alexa suggested, multisells are seperated by grade (btw a black hole in a multisell means you messed it, Alexa ;p).

====================================================================================================
Changeset 209 @ 2011.11.10

Quests slight rework.

All quests using a COMPLETED state have been included back in the switch case, due to the "new way" of quests (main switch about states, not anymore on NPC). Added to that, some variables are now initiliazed where it's needed (aka in case.STARTED), and not before or after.

====================================================================================================
Changeset 208 @ 2011.11.10

Retail Newbie system.

The first character of an account reaching lvl 6 is considered as a Newbie character. Others characters - even if they're older in term of creation but never reached lvl 6 - aren't considered as newbies. At level 25, the newbie character isn't considered as newbie anymore.

System includes:
    - Addition of newbie state (objectId of the "Choosen One") in accounts.sql.
    - Drop of the newbie state of characters.sql.
    - Modified methods uses:
        - isNewbie() - boolean type, makes the check about BOTH level (6 to 25) and newbie state. Use it fr regular checks.
        - getNewbieState() - int, returns the objectId (useful to check player objectId with registered objectId without level check)
        - updateNewbieState() to register newbie state (happens in PcStat)
        - restoreNewbieState() to restore newbie state (happens in CharacterSelected)

Ty to Alexa for initial patch.

====================================================================================================
Changeset 207 @ 2011.11.08

SystemMessage rework, misc.

This commit needs far more tests than I actually did, anyway I commit it (that's 250+ files edited... 2,5k errors to correct).

SystemMessage is refactored following actual L2J. The enum is replaced by an array, and a fast build system is included. Some SystemMessageId descriptions are actually wrong (as it's a raw copy/paste), but that doesn't influence the process, until you use the correct id, whatever name it got, it sends the correct msgId...

I decided to use the short version when possible. Aka, you can do "player.sendPacket(msgId)", if "player" is a L2PcInstance it will work. I just generalized to all possible cases that writing system.

Misc
    - Siege golems as normal summons are attacked by siege guards from now.
    - You can't summon a siege golem inside an sieged castle anymore. Tested only on Gludio... No reason it bugs for others until zones suck.
    - CreatureSay got support to use SystemMessageId.
    - Many typos on multiple files.
    - A recent L2J commit about .shared() on recipes and quest timers fastmaps (atm, haven't access to L2J timeline).

====================================================================================================
Changeset 206 @ 2011.11.07

Dr. Chaos, KKnD Movie Maker, misc

Dr. Chaos - fully revisited (x2,5 code compared to L2J).
    - Addition of a status checker. This status leads the spawn of one or other NPC (Dr Chaos - NPC version - or Golem - boss). This timer reset the boss if he isn't killed before 30min. When killed, the regular boss timer is applied, and will respawn the NPC version. Et caetera, et caetera.
    - Addition of 2 ways to make him crazy: staying near him lower a timer (base 30sec, -1sec each time you stand near him). If you speak to him, it reduces that timer too (1-5 seconds). He got 3 different HTMs following crazy state.
    - Complete rework of the animation, the NPC type will show 3 animations in a defined order, and the golem will show one aswell.
    - Addition of 6 out 7 chat speech (3 random when he attacks, 1 at death, 1 when paranoia timer reaches 15secs and 1 when you make him crazy).

KKnD's Movie Maker - added to normal code found on L2J forums, here are the changes:
    - Unhardcoded HTMs, and graphically enhanced. A mini-tutorial explains to you the basic behavior.
    - Correction of all typos, both on HTMs/code style.
    - Exceptions are catched when needed (index bound of exception).

Misc
    - Fix the "spawn protection" config (ty djSt3rios for report and fix).
    - Modify the way to select player slot (harder, better, stronger, lalalalala~).
    - A banned player is now really banned (check is made before the L2PcInstance object is loaded).
    - Pets are correctly stored/saved at player's save.
    - Addition of addAttackActId() method. Part of a previous add.

PS: Obviously, as there are 0 infos about Dr. Chaos (2 useless topics on official forums, 0 videos, and such), I made an enhanced CUSTOM version. I prefer a custom WORKING version than a custom BROKEN version personally. Actual L2J code is broken (needs server restart to work correctly once dead).

====================================================================================================
Changeset 205 @ 2011.11.03

Quests, regex pattern, misc

Quests - addition of 3 quests.
    - Q020, Q046 && Q661. Ty fernadopm and M4N0LIS.
    - Numerous typos on Q045, and light typos everywhere (enjoy "replace" tool).

Regex - I feel greeks will howl like werewolf at midnight.
    - Name pattern is now hardcoded (generic regex is replaced by hardcoded pattern). It means related configs have been dropped.
    - Those useful methods (isValidName / isValidPlayerName) have been cleaned up then put on Util, as it can be used on many places.
    - settitle and setname have been secured using isValidPlayerName method. It means you can't give anymore a stupid name with strange characters. You can thank SweeTs. PS: you still can attribute yourself a stupid name editing database directly. Well if you decide to pull the trigger, I can do even better (like kicking all noobs with not regular names at Enterworld).

Misc
    - Fix CH doors issue (coming with XMLization of doors). I don't get why it works like that and not before, honestly.
    - Addition of an actionFailed packet when you massclick on doors, to avoid to be stucked.
    - PetNameTable has been dropped (as 50% of that file has been put on Util with regex change, only one method was left... I decided to move it).
    - The correct message is shown when you create a character with invalid name (before, only "16 characters" message was shown).

====================================================================================================
Changeset 204 @ 2011.11.02

Quests, misc

Quests
    - Addition of Q294, Q403, Q406 && Q508 (ty fernandopm and Alexa).
    - Little corrections on Q401 && Q509.

Misc
    - No more ghost messages between 2 blows (ty RaphaelFersan).
    - Tamed Beasts correctly debuff (inverted check, I thought it was a npcskills issue but not).

====================================================================================================
Changeset 203 @ 2011.10.29

Feedable/Tamed Beasts AI rework, 3 quests, misc.

Feedable/Tamed Beasts (changes compared to L2J).
    - Drop of the invisible timer (20min). The only timer is the check of 1min to consume food.
    - Tamed beasts don't attack you when you kill others pets (faction clan lol), nor when you hit them (they still buff themselves, dunno why).
    - Tamed beasts disappear if they go out the Wild Beast Reserve (13k radius compared to central tower).
    - Tamed beasts don't buff you if you already got the buff it wanted to buff with. Understand you won't be buffed 4 times with Guidance.
    - Mana recharge is seperated of the heal condition. There's now a HP and MP condition for each case.
    - The AI of Tamed Beast is as following: 25% heal, 25% mana recharge, 25% debuff, 25% nothing. It replaces all others random chances. The fact it goes on the "heal" option doesn't mean it will heal you. The pet must have the skill in his skill list. You must be low HP/MP aswell (50%).

Quests
    - Addition of Q038, Q039, and Q263. Ty Fernandopm.

Misc
    - Addition of "//reload acar", acar stands for "admin command access right" (ty DjSterios).
    - "quest" option is only for single quest. Previous "//reload quest" has been changed for "//reload scripts".
    - "server_menu.htm" got a combobox listing all reload options from now. As "quest" need a parameter, I couldn't include on it.
    - You can now restart during a fight as a GM (ty DjSterios).
    - Old changes on MyTargetSelected have been reverted.

====================================================================================================
Changeset 202 @ 2011.10.26

Auction, spawnlist, misc

The commit was long to come because my first idea was to implement siegable CHs. Unfortunately, only 4/6 are actually made on L2J, and BigBoss still work on it. So I prefer to wait and use my time in other things (pointless to do the same he is doing, plus he does it well).

Auction system
    - The structure is corrected, and improved. HTMs are corrected following L2OFF (minus the size problem).
    - Initial auctions list is OFF-like. You can directly see actual number of actual bids aswell (number in []).
    - All bypasses which needed a security check (about clan and/or with warehouse check) are secured.
    - The maximum of retail messages have been used (which avoids string uses).
    - One unused table dissapears, and auction.sql got 3 columns dropped.
    - The lease is correctly removed when you put an auction in sell. As retail, you receive back your lease only if the CH is sold.

Spawnlist
    - Added 12~ spawns (Fortress of the Dead, mainly).
    - Dropped all mobs initially spawned on Siegable Clan Halls (around 100+). They must be spawned via their own SQLs.

Misc
    - Baium's Archangels aren't invul anymore. After all, they each got 50% Baium's HPs and a heal skill. Who would be stupid to kill 3,5 Baium.
    - Autosoulshot behavior is OFF-like.
    - CP/HP/MP are correctly filled at character creation (0/max/max).
    - L2DoorInstance onAction behavior is OFF-like.
    - Mini tweak in L2AttackableAI, I hope it won't fock something.
    - CharSelected serverpacket cleanup (2 infos added, and 8 empty/useless writeD are dropped).
    - Addition of formatDate method to format the date as you want on a String (avoid String.valueOf and easier readability).

PS: I'm aware there are stills issues on auction (like the 7 days period where you can't put back an auction, missing comment use).Let's say from 80%, I moved to 90%.

====================================================================================================
Changeset 201 @ 2011.10.21

Doormen, misc

Doormen
    - Castle doormen are now retail-like (possibility to teleport in and out, drop of "open/close all doors" function).
    - Addition of 56 teleports location.
    - Unhardcode all CHDoormen HTMs.
    - Addition of many missing Doormen (Siegable CHs ones, 2 at Frontier Border) and fix some templates (Doormen of Hell were bugged as hell).
    - Drop of all useless HTMs.

Misc
    - GmListTable is moved on datatable section.
    - 2 spawns of Squashs have been dropped (in 4s...) Ty Vonak.
    - TaskPriority is dropped (useless crap).

This commit doesn't fix yet CH doors issue.

====================================================================================================
Changeset 200 @ 2011.10.21

Three new quests, ty Fernandopm.

====================================================================================================
Changeset 199 @ 2011.10.20

Formulas fix, quests, misc

Formulas fix (skill success)
    - Those formulas are now based on L2JFree, and then tweaked (pure custom following my own tastes). The "pure custom" can afraid you, but both L2JFree and L2J are custom, from IL to hi5. And both don't fit with my own knowledge of L2 (L2JFree doesn't impact enough, L2J impacts *far* too much as some of you correctly warned me - fighterboss :p).
    - Difference of levels got a real impact (negative is even bigger than positive) from now. Enchant and matkModifier doesn't break the harmony of the formula. I can't assure you won't have 10% luck with +500 weapon ofc...
    - Skill success is now 1% to 99% max.
    - Magic success is now heavily affected by level of skill or level of player. You can't do 100% damage using Wind Strike at high level for exemple.
    - The whole calculation has been seriously reduced for the best performance (as MEN/STR squares precomputed).
    - calcSkillVulnerability is now a %, not a fockin addition anymore. Previously 50% base - 40%. Now, 50% base * 0,6. Simple.

ALL USED FORMULAS ARE FULLY EXPERIMENTAL. I TESTED THEM FOR ONE DAY, BUT PERHAPS I MISSED THE BEHAVIOR OF A SPECIAL SKILL AND SUCH.

Quests
    - Use of a new "system" to make quests. Many quests are now faster (avoid to read deeper in quest) and consumes less RAM (avoids int[] uses)
    - Some corrections have been made (3-4 little bugs, some typos).
    - Addition of 6 quests, ty fernandopm for the good work (and me aswell to correct muhaha :P).

Misc
    - Fix an eventual rare NPE (ty SweeTs for report).
    - Addition of an AI for speaking NPCs (hit/speak and death/speak types). More NPCs will come with time, and surely that new original AI will be modified (NpcString ?).
    - Fix of quest monsters wrong spawns for noblesse quest (I think ? lol), and fix SoDA spawns on deepest central room (with Merkenis, one of the new speaking NPCs).
    - Deletion of minChance, maxChance && pvpPower from L2Skill (unused stuff and/or hardcoded from now).
    - Fix an issue on admin panel (ty Sikken for little fix)

====================================================================================================
Changeset 198 @ 2011.10.12

Doors XMLization, doors/siege misc && quests

Doors are XMLized from now.
    - Both castle doors (SQL) and general doors (.csv) are now melted in a unique doors.xml. Ty DiNoR for the good work on DP (using L2OFF values) and Treaser for initial patch (including only normal doors).
    - Implementation of isWall (only siege summons can break walls from now). Can be seen through SHIFT + left click door panel.

Doors/siege misc
    - Fix of a bug where you could hit a door CTRL + skill it.
    - Walls/doors are now invul when siege isn't available (in case of...).
    - Flame and normal CTs don't make you buggy anymore if you spam click on them.

Quests
    - Addition of Q267, Q271 && Q619.
    - Q267 needed the move of a NPC spawn (wrong spawn).

====================================================================================================
Changeset 197 @ 2011.10.10

Baium, Archers AI, quests, misc.

Baium is now almost retail like*
    - Angel AI has been implemented. Angels stop to attack when you disarm your weapon, and they got a chaotic behavior (shuffle targets).
    - Angels are put as raid minion (avoid champion behavior for example) and are setted to running mod by default.

Archers AI: the behavior of archers is now OFF-like.
    - They got bigger probability to dodge, they dodge always according to your position (never cross your path), and the new position is not random anymore, they go now farer ("300 fixed" instead of "random 100", leading to stupid behavior such as moving near you).
    - As the behavior is only for archers, the npc_ai_data as been cleaned up of dodge infos (all is hardcoded). Check is only made on the AI Type.
    - L2J topic: http://l2jserver.com/forum/viewtopic.php?f=69&t=23743

Quests
    - Addition of Q158, Q159 && Q160. Ty fernandopm, as always :).

Misc
    - You can now attack NPCs. Restriction is removed as now NPCs are immortal, and skills don't effect them aswell.
    - canTarget method is moved from L2Npc to L2PcInstance.
    - The target system of pets as been cleaned up. It was kinda messed.

*There's still an issue about teleToLocation (waker doesn't see complete animation).

====================================================================================================
Changeset 189 @ 2011.09.04

2 quests, many misc.

    - Addition of Q276 and Q509, ty fernandopm for initial share.
    - Addition of getClanLeaderQuestState() method (see Q509 for the use).
    - Paagrio -> Pa'agrio typo in all HTMs and quests.
    - Better use of Quest stuff. Now consider to use isCreated() / isStarted() / isCompleted().
    - Fix all NPCs instances who weren't yet invul + immune to effects. If you find a mistake, please tell it fast (so far no issue for Artefact, perhaps signet stuff ? I don't think so.)
    - Fix the sex save at player's restart, ty Vhalior (I don't miss you emo).
    - Added retail-like Dance of Protection core + DP (30% resist to terrain-type damage).
    - Added Plague Golem (activation + some little fixes).

Once again for quest helpers, consider to CHANGE "st.getState() == State.BLABLA" for related stuff (isCreated() / isStarted() / isCompleted()). This is just more clean.

====================================================================================================
Changeset 188 @ 2011.09.02

Golden Ram Mofos.

    - Addition of Q109 && Q628.
    - Golden Ram crews got their own instance, showing htms following state quest (3 different HTMs for 2 NPCs, 2 diff for 2 others).
    - Addition of a missing NPC (corpse).
    - Mercenaries sentries can't speak. Move the check from "chatWindow" to "onAction" method (avoids stuff such as random animation, and so on).

I'm aware the corpse is flying. All collisions values will be tweaked later, at the same time, during NPCs refactor. From the moment you can click on it at this moment... Not a big deal.

====================================================================================================
Changeset 187 @ 2011.09.01

Deletion of Telnet, addition of DeadlockDetector.

    - Telnet was crappy and not really user-friendly; let's see for alternative ways :).
    - DeadlockDetector is a tool to see when tasks aren't correctly synced. When it mustn't be used on a live server, I invite to use it on your test lab, as much as you can, to eventually see errors and report.
    - Some typos.

====================================================================================================
Changeset 186 @ 2011.09.01

LoginController rework, misc.

LS / LoginController
    - Added a config to on/off all LS logs (off by default from now to avoid to waste performances filling a .txt)
    - Improved the login method (I hope it didn't destroy anything as many synchronized dissapeared, so far trying to dual login leads to the same fail)
    - The general look of LS messages has been refreshed.
    - You can't add twice the same IP on ban now (better said, avoid to fill if already existing).
    - Some code reorganization (drop of useless Log, move of printSection method).
    - Many typos.

Misc
    - One table has been dropped (merchant_lease). The uses of it were useless aswell (DELETE type commands on empty table...).

====================================================================================================
Changeset 185 @ 2011.08.30

L2Multisell rework, misc.

L2Multisell rework
    - Added a check to avoid enchant exploit.
    - Added a check on inventory slots/weight. PS: it doesn't take in consideration your quest items slots. Cry on forum if different (if you got PROOFS).
    - Corrected an issue about buying multiple reputation items and only the reputation price of one item was taken (both check, message, and amount decrease).
    - Added a check on the NPC you're talking. If you're in a strange state (dead, masturb...), or if you're too far, or if the NPC isn't the good type of NPC, OK button doesn't answer to your frenetic mouse clicks.
    - Cleaned all multisells lists which don't need maintainEnchantement statut (minimize exploits -- if it's still possible).
    - Added a message which make a sound when you success! * AwESoMe ding *
    - L2Multisell instance is now loaded at server loading, under Items tab. Added to that, Singletonization.
    - L2Multisell doesn't load anymore broken XMLs.

Misc
    - Cleaned up some methods on L2Character (experimental stuff, as some synchronized stuff have been killed). Consider report any retard things on stats changes and stats broadcast.
    - StatusUpdate cleanup. Only one way to call it from now.
    - Some HTMs typos. Death to <br1>.
    - RequestSellItem packet (some checks added as L2Multisell, and general refactor).
    - RequestBuyItem got his NPC check improved (on L2Multisell idea).
    - No more message/method launched when you take Clan Imperium skill (as repu cost is 0, pointless repu calculation and message).

====================================================================================================
Changeset 184 @ 2011.08.29

Items reuse (again), quests, misc.

    - Items reuses are fixed (both scrolls and potions). I hope it's final implementation.
    - Elixirs-type skills now display successfully the reuse in shortcut bar.
    - Addition of Q018, ty Richijs4 for share.
    - Little fix on Q037, ty Vhalior for testing.
    - Correction of some HTMs typos, and 5 emptys bypasses.

====================================================================================================
Changeset 183 @ 2011.08.29

Q017, 258 & 626. Ty fernandopm && Richijs4 :).

====================================================================================================
Changeset 182 @ 2011.08.29

Quests little refactor, misc

Quests little refactor
    - All quests got their COMPLETED check moved to top of the onTalk method (previously, it was put on the switch case of the quest giver). There are 2 reasons so far:
        - One is a bugfix reason (when NPC got numerous quests, it shows even quests done, so when you click on a secondary character, this guy won't have proper html sent => "I have no tasks for you right now, emo" instead of "you already made that quest, dumbass").
        - Other reason is optimization: it avoids to read a part of the quest, launching variables/switch case for a simple result. So from now, it is fastest and use less checks.
    - All quests with reward items on monsters kills (onKill method) got a unique "template" from now (if the reward type fits with the default behavior, ofc...)

FROM NOW, HELPERS, CONSIDER TO USE THE NEW IMPLEMENTATION (there is near nothing changed as you can see, but you will save my own time doing it directly good).

Misc
    - Formal wear isn't considered anymore as heavy armor (passive skills from tanks and such were applied...).
    - Dimensional Rift is (normally) entirely debugged. I rewrite my own rewrite to fit with Vonak's experience. Ty to him.
    - "dist" folder on DP build dissapears. That avoids 1 useless double click... Lol.
    - Q009 and Q010 have been added. Ty to the numerous contributors (4 !) for those 2 worthless quests :D.
    - Subclass checks: addition of summon check and "inventory bigger than 80% in term of slots availability". The existing check about overall weight has been hardened aswell (from now, even with one level of weight penalty, the village master smashes your face down to the ground). Reason I hardened the wight penalty is simple: imagine you're a dwarf, with 79% weight(50k of soulshots ftw). Now decide to sub Elven Elder. I think you got the picture.

====================================================================================================
Changeset 181 @ 2011.08.27

Command Channel, usercommands cleanup, misc

Command Channel has been refactored
    - The little window is now correctly working, showing party details aswell. "Quit" button works too. Ty Hellish for report.
    - Addition of missing packet, && correction of existing ones.
    - Correction of a hi5 L2J bug related to CC (issue when inviting a party leader by the way of a party member).
    - All custom messages (around... 15 ?) have been replaced for retail ones.

Usercommands
    - Channels commands (creation, delete, info) have been cleaned up.
    - Clan penalty has been improved (use of StringUtil instead of TextBuilder).

Misc
    - L2LvlUpData has been dropped (useless stuff).
    - L2ArmorSet and AutoChatHandler have been cleaned up/refactored.

====================================================================================================
Changeset 180 @ 2011.08.27

Formal Wear quests serie - Q033, 034, 035, 036 && 037.

    - Endquest rewards items have been put as qItems aswell.
    - Ty Treaser for initial share. I can't say it was free-bugs... Like adding 20 HTMs and so on.

====================================================================================================
Changeset 179 @ 2011.08.25

npc_ai_data, and some misc

npc_ai_data
    - Spring cleaning on variables names, deletion of some booleans (behavior can be handled differently, so...)
    - Some behaviors disappeared (resskills, floatskills (?)).
    - Addition of suicide behavior for NPCs (activation at 30% HPs -- need surely to tweak it depending of skill/monster later), not a general skill anymore.
    - Addition of a minimum and maximum skill luck (between 7 and 15% by default from now, before it was 15%).

Misc
    - Addition of a timer on pickup action.
    - Tweaked existing animation timers, based on speed run now.
    - Fixed a typo in Q006.

====================================================================================================
Changeset 178 @ 2011.08.20

Dimensional Rift, HotSprings IA, misc

Dimensional Rift -- fully refactored using Freya.
    - Addition of EarthQuake effect at room changes.
    - Give possibility to have more than 1 party in same rift, without interacting between them.
    - Correction of an misfunction using jump cards (4 jumps, not 5).
    - Fixed/verified values to be retail-like (2 players minimum, 480-600 sec, 4 jumps).
    - Fixed issue where you can spawn directly in Anakazel room (at startup or during jumping).
    - Added message for tokens consumption.
    - Fixed spawn of one Rift ziggurat teleporter.

HotSpings IA
    - Added a fully working HS IA, which upgrades the disease when the mob hits you.
    - Corrected durations of diseases (from 10 min to 1 hour).
    - Added core implementation for that new stuff, under OnAttackAct (perfect for your custom events :P).

Misc
    - Corrected Q153 typo, and fixed html -> htm (ty Vhalior).
    - Cleaned postIL stuff related to epic jewels (ty Sahar).
    - Added the 3 missing L2PetTown (ty extel).
    - Fixed some links in htmls.
    - Added SuicideAttack behavior on "NPC Death Bomb".
    - Fixed eventual NPEs at quest engine.
    - Fixed previous rework on items reuse durations. It now take the longest time between items reuse and skill reuse.
    - Some cleanup at L2Npc onBypass.

====================================================================================================
Changeset 177 @ 2011.08.17

Zones refactor, items on character templates, misc

Zones refactor
    - Core implementation and DP activation for "reuse" and "initialDelay" for DamageZone;
    - Addition of the warning icon for DamageZone.
    - Deletion of ZONE_ALTERED (pointless).

Items on character templates
    - Addition of items at character creation.
    - Only first classes got those datas, which is not the actual L2J way (actual loads items even for post 1st class transfer o_o). Consider reporting if you find an issue.

Misc
    - Addition of (a tweaked version of) L2TownPet instance, ty Sentinel/Vhalior for initial share.
    - Mini clean on items (those datas are already implemented).
    - Drop of the duplicate spawns for Orfen, Queen Ant and Core. Valakas big teleporters have been dropped aswell (handed by future AI).

====================================================================================================
Changeset 176 @ 2011.08.16

Four Sepulchers part I + misc

Four Sepulchers (4S) has been implemented. Plenty of bugs still exist, but will be corrected at part II (waiting for you to make reports). For the moment, following has been added:
    - Main instance + the 2 NPCs instances.
    - Spawnlist "spawnlist_4s.sql", and HTMs "sepulchers" folder (ripe of "default" folder).
    - Addition of missing NPCs spawns on spawnlist.sql, minus spawns of 4S mobs (handled in "spawnlist_4s.sql").
    - Q620_FourGoblets has been added.

Misc
    - Tyrannosaurus aren't lethalable anymore.
    - //invis, //vis, and //invis_menu => //hide command.
    - GS shows "used" memory, not "free" memory anymore.
    - Refactor of SocialAction packet.
    - "Patrols" guards chat window has been corrected.

====================================================================================================
Changeset 175 @ 2011.08.12

XML, XML, XML, XML, XML...

And XML. That was long, and the DP side still needs some corrections/verifications. I ported 6 SQLs to XMLs. 3 SQLs have been merged, the data has been splitted according to class ("data/xml/classes" folder). The 3 others SQLs => XMLs have been moved under "data/xml/skillstrees" folder. An effort has been made on informations loading (drop of useless stuff, enlighten XMLs structures) aswell.

Added to that:
    - 22 enchantement skills (IL ones) have been added. Those datas are unique - as handmaded by me - so enjoy :P;
    - A packet exploit on skill acquire has been fixed;
    - A useless message has been dropped when you close enchant/acquire skill windows;
    - Lucky skill isn't shown anymore on trainer skilllist;
    - 2-3 methods are improved (no checks on shortcuts when a passive skill is removed, Lucky skill check method doesn't remove skill at any level);
    - Mobs are supposed to do magical critical now. At least, they got a default stat now.

The memory drop is around 10mo. The pack has been tested in the installation process aswell.

====================================================================================================
Changeset 174 @ 2011.08.10

Zones system, 3 quests, misc

Zone system
    - Players aren't effected by NPC skills zones;
    - Mobs aren't effected by L2EffectZone/L2DamageZone (BigHead zones, castle traps, Blazing Swamp,...);
    - Activation and core implementation for isEnabled feature (mostly used on script for 4S).
    - Drop of L2BigHeadZone (using L2EffectZone since some revisions).

Quests
    - Addition of Q015, Q031 && Q121. Ty to contributors!

Misc
    - Addition of missing HTMs for a couple of NPCs. Ty Pofka/seRiousLy from L2JBroken project for their contributions.
    - Correct skills XML 3500-3599.

====================================================================================================
Changeset 173 @ 2011.08.05

Enchant, reuseDelay for items, Skills / Items fixes

Enchant
    - Fix enchants, which are now possible on equipped items (not only inventory).
    - Fix success enchant message.

reuseDelay
    - Items use from now the reuseDelay of their template; if nothing is found it will use skill item reuse delay (as previously). Simple example on CP potion: reuse delay is 500ms on item, 50ms on skill. It will use 500ms. If item hasn't delay it would use 50ms instead. Before this commit, it was using 50ms. http://www.l2jserver.com/forum/viewtopic.php?f=69&t=23069
    - Delete message on skill's use (post-IL stuff)

Skills / Items
    - Fix some SAs values (Miser, Cheapshot and Quick Recovery mainly), and add some missing SAs.
    - Fix Triple Slash (ty sa_"theXMLdev"_har :D) power values.

====================================================================================================
Changeset 172 @ 2011.08.04

XMLs, XMLs, XMLs... And misc!

XMLS
    - XMLization of NpcWalkerRoutesTable && AdminCommandAccessRights.
    - NpcWalker system have been slightly refactored/updated aswell.
    - Cleanup in all existing XML tables, for cleaner coding style.
    - Cleanup some XMLs (to reduce length and improve readability).
    - Ty DiNoR for SQL -> XML work on walker part. And death to NPEs.

Misc
    - Addition of 2 quests, Q032/259. Ty fernandopm && Richijs4!

====================================================================================================
Changeset 171 @ 2011.08.03

2 XMLizations, typos fixes & Misc.

XMLizations
    - access_levels && spellbooks (previously skill_spellbooks) are now XMLized.

Typos fix
    - Many typos fix on GS logs. That's nothing more than esthetic issue. That's 80% modified files of that commit.
    - Some "counters" (TableName: Loaded xx blabla) have been reworked.
    - Drop of the timer (GS started in xx seconds).

Misc
    - qItems are now "no destroyable". When it's not retail-like, it goes the good point to avoid exploits, such as deleting your qItems and continue the quest as if nothing appears. Doing retail will ask to remake each quest, adding checks for any qItem.
    - Cleaned the few qItems which were "no_destroyable" (as handled directly by core), and clean the CWs enchant stuff.

====================================================================================================
Changeset 170 @ 2011.08.02

MapRegion XMLization
    - SQL -> XML;
    - Corrects Prismeval Wharf teleport issue (one PZ becomes a TZ);
    - Clean TownManager postIL stuff.

====================================================================================================
Changeset 169 @ 2011.08.01

Buffs system, Enchant system, misc

Buffs system
    - Reverted to be IL-like. Ty stanus for report.
    - Dances aren't put anymore at end of buffs bar, and aren't "saved" compared to others buffs.

Enchant system
    - Refactored the enchant process, adding many checks and securities (warehouse, can't enchant during store,...).
    - Added retail messages.

Misc
    - Addition of Q019;
    - Fix messages when a player/summon hit an invul NPC. Split that message in invul / invul paralyzed (medusa type) aswell.
    - Typos, and revert noquest.htm content for IL type.

====================================================================================================
Changeset 168 @ 2011.08.01

Deletion of GeoEditor and ManaPotion handler.

As mana potions haven't any existing skill (verified both on 3 months old L2OFF IL sources and on a running L2OFF), I decided to link potions with mana herbs effects. Mana drug give back 12% mana, mana potion give back 18%.

MPots aren't supposed to be usable, so from now, end of chatting about MPots.

====================================================================================================
Changeset 167 @ 2011.07.31

Me, ashamed ? Nevah. My Ohlolol account depends of that commit :D.

Special thanks to "Advanced Find and Replace 6", haha.

====================================================================================================
Changeset 166 @ 2011.07.31

Misc, misc, misc

    - FakeDeath is now OFF-like (once activated, toggle is locked, until you type /stand or click on sit/stand button.)
    - Visual effects have been added for 8 seals/fire skills (ty SweeTs for idea).
    - Skill mastery is calculated only for players (waste of ressources for other L2Character than players, as stat is 0).
    - Fix \n on chat, ty manoell for the 1 line fix :P.
    - Continue previous work on resistance calculation (better said, I forgot 2 of them in previous commit).
    - Added a 2,5sec paralyze task on ressurection (FD is concerned too), which force ppl to get the "wake up" animation (based on sitTask paralyze stuff).
    - Renamed/clean some packets

====================================================================================================
Changeset 165 @ 2011.07.30

XMLFactory, Formulas rework, baseStats deletion.

Ok, that does 3 days I didn't commit but there was a good reason (as always when I don't commit) ^_^". I was testing some experimental features, and some revert back. Some formulas have been corrected aswell, or "tweaked". Here's the list of changes:

baseStats
    - Reverted baseStats.xml to IL stuff. Why ? Values/tables are calculated on the fly from core (no use of external technology = less ram/cpu consumption), and are more accurate (no rounded values).
    - saveVs from skills have been deleted, and replaced by core side formula (= less data from skill as all skillTypes use same stats, aka MEN or CON, to be calculated). Many XMLs are concerned.

XMLFactory
    - That's EXPERIMENTAL feature. All XMLs are now loaded from a single instance. That means clean code (some XML refactor codes are cut per 1/3), and normally less objects created. The use is very simple aswell. From the moment, no problem has been discovered using it.
    - armorsets' XML got a new structure (must be updated).

Formulas
    - A big rework has been made on Formulas.java. All Func have been moved in the folder named "funcs". Old funcs have been moved on a new folder "basefuncs".
    - Many formulas (mainly magical) got now proper logs. You can see them activating "Developer" option in server.properties. I hope it will help you to find eventual issues.
    - Some formulas have been reworked from scrap:
        - calcAtkBreak (renamed calcCastBreak) has been improved and the use is more simple/generic. Mobs casts aren't broken so often (depending of IA, goes to 10% to 30% of player rate).
        - calcHitMiss uses retail infos (verified from l2guru 2007 forum post / L2p bravehost).
        - calcMagicEffect has been tweaked (because effects weren't noticeable at all: 10% fail only on a red mob). Effect has been x2. I think the formula is still "too kind" with players, anyway.
        - Resistances are now directly applied instead of lolcalculated (understand than 20 resist = 20% now instead of 24%, etc).

====================================================================================================
Changeset 164 @ 2011.07.27

Quests! Moar!

    - Q014, Q162 && Q688. Ty to Ventic, TLH and DiNoR.

====================================================================================================
Changeset 163 @ 2011.07.26

Quest stuff & misc

    - Q171 added
    - Add the possibility to reload a single quest, overloading existing command (//reload quest number). If you type "//reload quest", all quests are still reloaded (but AIs and boats path aswell...).
    - Add the possibility to add a script without server reboot. "//reload quest" wasn't made for that, as it could bug boats and such.
    - Delete postIL stuff about instances.

====================================================================================================
Changeset 162 @ 2011.07.25

Quests & misc

    - Addition of 3 quests: Q004, Q379 & Q401.
    - Add a missing SQL about global quests variables ;o.
    - Clean correctly a deleted character (addition of character's raid point & global quest variables to cleaning)
    - Fix Mass Gloom (should be on the summon).

====================================================================================================
Changeset 161 @ 2011.07.22

Skills and Misc

    - Correction of MANADAM effects, which now support MDOT. Effect is really supposed to burn some initial mana then to do a MDOT.
    - Fixes the teleport skill from Blade of Splendor (VoS), which had 2 skillType (o_o).
    - Fixes attack button on pet betray mod.
    - Bypass shield's check on Hydro Blast's use (2007 L2Guru topics)

Misc
    - Fix macro items use deleting the itemUse fP. Even put at 1, it was making it bugging.

====================================================================================================
Changeset 160 @ 2011.07.22

Skills
    - Magical critic rate is now corrected, and fit with http://l2p.l2wh.com/wildmagic.html
    - Old CONFUSION behavior was useless. CONFUSE_MOB_ONLY have taken this position.
    - Both effects EffectConfuseMob and EffectConfusion are corrected. An random aggro number has been added, allowing mobs to change of target each tick. It can add more aggro on same target with some unluck... And this target can be you, ofc <_<.
    - Valakas Necklace Wild Magic effect is corrected.
    - The only use of old CONFUSION skillType was on a potion (Critical Escape). This potion skill has now a mirage type effect. That's surely 100% custom but old effect was custom aswell, lol. And the effect is working at least...

====================================================================================================
Changeset 159 @ 2011.07.21

Teleports.

Added the 6 following teleporters, fully working.
    - ElrokiTeleporters (added the no fight check, as explained in the NPC's dialogue);
    - NewbieTravelToken (fixed HTMs and added HTMs if player hasn't token);
    - NoblesseTeleport (fixed HTMs);
    - PaganTeleporters (retail way, gates are opening. Fixed all HTMs, and fixed 2 qItems' issues);
    - RaceTrack (as L2J Freya did - lolscoria is fully bugged);
    - TeleportWithCharm;

Misc
    - The Pagans' statues are now L2Npc, not L2Teleporter anymore (as all actions of teleport are handled by quest). For so, their htms have migrated on default folder.
    - HTMs of an non-existing gatekeeper have been deleted.
    - 2 Pagans teleports have been removed, as they're now handled by the quest (and it's not teleport anymore).

====================================================================================================
Changeset 155-158 @ 2011.07.21

Well, basically both (this and 3 past) commits were lolcommits.

It will allow people to checkout directly in good directories. If you manage to get a personal project, and same issue than me (aka repo folders' names are different of your local project copy), avoid to do it like I did (Voqus, grrr ;p), aka don't do it from SVN repository. But do it using package explorer view > Refactor > Rename (ty Trance for the too-late solution -.-"). You can commit all of them in one commit, and that will change .project directly instead of doing manual crap.

If you got issues, I invite you to drop all your aCis stuff and to checkout again.

+4 useless commits. Beat that L2JBroken/Loop/XG!

Since it's the most useless commit I have (and will) ever made, I would like to thank all helpers which helped me (in one or another way) since the beginning of the project. You have to know major updates are coming those days (on DP side, we prepare something big). Quests refactor will take a big time aswell (expected time for a complete quests folder is around 3 to 4 months).

aCis is on faCebook. Type "aCis" on the facebook search tool, you should find it easily. It's the best spot if you want to know hot news, like actual works, tests, and so on. At 25 members I can put a damn normal link instead of this dynamic crap. So join the community.

More you help, faster the project will move on, and faster you could use it for your own server project.

What can I say more... Anticonstitionnellement.

====================================================================================================
Changeset 154 @ 2011.07.21

Skill fixes && misc.

Misc
    - builds.xml have been formated and cleaned. DP doesn't create a .zip anymore, nor try to update/clean it (faster compilation).
    - .project is supposed to correctly "link" dp and core (you don't have to make manually the fix anymore). Ty Voqus.
    - 2 items are now considered as quest items ("seductive whispers" and a "game of cards").

Skills
    - Once sitted, you can only disable a toggle, not activate it anymore. Issues like using fakedeath during private shops weren't so cool... The initial feature (and bugs) has been introduced at revision 50.
    - Slow reuse time is 7sec, not 2sec.
    - Seal of Disease acts like a seal, not like a one man target && far-casting spell (Gracia behavior), ty Vonak.
    - Cancellation and such CANCEL skillType are now corrected. Formulas were linking to another skillType, CANCEL_DEBUFF, which isn't the good effect ;p. So from now, Mental Shield and such buffs should correctly add resistance to cancellation type skills. CANCEL skillType is now 100% effect success aswell. Ty Vonak and Sim for report.
    - confusionVuln is now handled directly by derangementVuln. This property (confusionVuln) doesn't exist anymore.

You have to update skills XMLs.

====================================================================================================
Changeset 153 @ 2011.07.19

Shadow sense && misc

    - Add Shadow Sense support (without use of thread), which was in sleeping mode.
    - Remove recall_npc button in NPC+shift click on NPC.
    - Remove StackTrack warnings on //forge2 and //forge3.
    - Added some sounds, such as: chatban, unban chat, gmlist/petition (if none GM online).
    - Fix a PM's NPE. Ty L2J's user DareStrike for report.
    - Add ClientSetTime serverpacket.

====================================================================================================
Changeset 152 @ 2011.07.19

PartyMatching system (that smells the leeching suckers at 100km around :D).

Added to the Freya update, following fixes (made by your servitor - me, myself, not you ugly leecher who read this text) have been made:

    - Player room's kick:
        - LFP title is now correctly removed.
        - The player is register anew in the waiting list.
        - The partymatching panel is updated automatically (not simply closed like before)

    - Waiting list
        - Now it doesn't show your own name in the list (verified on a L2Off C5, plus, do you think it's normal to send to yourself partyinvite/whisper ?)
        - The waiting list works NOW ONLY FOR ROOM'S LEADER, or (as before) for people without room. It allows to (read next):

    - Addition of the 2 missing packets to invite someone in your partyroom.
        - Use of FriendInvite for the main idea :D.

L2J topic about: http://www.l2jserver.com/forum/viewtopic.php?f=69&t=22857

Die leechers :D. I got one step more than you each time.

Consider to report if any problem occurs.

====================================================================================================
Changeset 151 @ 2011.07.18

FloodProtector rework.

    - Added the less useless FP (dropItem, multisell).
    - No more instantiation.
    - Possibility to add punishement, duration, numbers of actions before punishement.
    - Before ppl were put in an array, once this array limit was reached if it didn't fit with max players limit, only hell knows what could happen :D.
    - FP settings have been seperated from server.properties.

Report if errors.

====================================================================================================
Changeset 150 @ 2011.07.17

Quests.
    - Added 3 quests: 122, 261 && 272.
    - Removed the few existing credits.

About credits: none cared about to add initial authors, and after all, there are far more than one or 2 authors. Should I add my name on each file because I corrected your own errors too ? Should I find the initial author, and all others who corrected the quest since the time without adding their own credits ? Guess no. Added to that do you think leechers will let right credits ? So let's remove the credits and let the whole crap anonym :).

This is a community work, not individual :). As a brick, you're part of the house, but you can't be the house itself :).

====================================================================================================
Changeset 149 @ 2011.07.17

Quests.
    - Deleted the unset("cond"), as it's handled directly when you use exitQuest(false). You still have to cleanup it if quest is repeatable (or I guess so).
    - Added GNU licences on fernando shares. Erm.
    - Added Q013, Q153, Q277 && Q357. Ty Ventic, fernandopm, TheLastHero && DiNoR.

====================================================================================================
Changeset 148 @ 2011.07.16

Alliance/clan "quests".

I had to pick back HTMs from rev 44 for rename bypasses/HTMs. Ty Ventic for initial share (there was some rework to do, you don't use last qEngine...). Consider testing all options and report if something misses, normally all is supposed to work. Moved a HTM from village_master to default (again a DE). Added a NPC missing in original quests (id 31336).

====================================================================================================
Changeset 147 @ 2011.07.13

Misc, misc, & misc

    - Q002, ty DarthVader (and the dark side of the force).
    - Corrected pole targets calculation (http://www.l2jserver.com/forum/viewtopic.php?f=69&t=22796) using Diego Vargas post. Non polers targets are back to 4 (instead of 9 targets). Current Freya is still wrong at the time I talk.
    - Fixed few jewels which had problem on enchant (ty Zerador for report, and DiNoR for fast fix).
    - Fixed CoV effect, supposed to give back the amount of HPs (20%).
    - Deleted limitation system. It was crappy. I only kept the retail cap limit of 500 on critical.
    - Fixed the drop protection, only party must be affected, not clan (ty Finito for report and "the ride" :D)
    - "Fear" graphical effect added back (which is confusion effect aswell).

"Game of Thrones" TV serie is just awesome <_<". Sex, blood and conspiracies, what do you want more ?

====================================================================================================
Changeset 146 @ 2011.07.12

Quests, spawn protection, crests packets

Quests
    - 3 quests added, Q112, Q157 && Q161. Ty Fernando for good work.

Spawn protection
    - Spawn protection config has been corrected;
    - The trigger was activated even when player was simply invul (gm invul, skill invul), which launch code for nothing;
    - Some packets were activating the trigger from their own (Appearing, etc), which basically focked up the protection at enterworld;
    - A message has been added if you move before the protection ends;
    - The only possible action is now Say2. So yeah, you can flame the campers until protection ends. Awesome, no ? :)

Crests packets (client/server)
    - Cleaning, packet structure simplification when there is no crest.

====================================================================================================
Changeset 145 @ 2011.07.12

Quests 006, 008, 110.

====================================================================================================
Changeset 144 @ 2011.07.08

Two new quests, 5 && 7. Tested from A to Z.

Ty to fernando and DiNoR for initial commits. HTMs have been corrected using L2OFF (L2J was/is wrong about HTMs conditions of 7, and some HTMs use were missing after condition is successed on 5). Tip of the day for awesome Freya c/pers: never think L2J make perfect quests :). Better c/p aCis quests, all remade with love :D.

====================================================================================================
Changeset 143 @ 2011.07.08

Drop protection.

What to say more... It's the retail drop protection, which block others players to pickup your loots for 15 seconds. If someone is in your party or is from same clan, he got priority aswell.

====================================================================================================
Changeset 142 @ 2011.07.08

Quests!

8 quests related to fishing, all have been tested and corrected comparing to L2J, but if you found some errors, you know what to do.

Ty to DiNoR for scripts.cfg && initial share of 2 of them than I corrected, others are clones made by me.

I didn't test the fact to fish. I poped items in my inventory. Report if fishing is broken somehow (you have to get the GOOD LEVEL OF FISHING before trying, it depends of the quest).

====================================================================================================
Changeset 141 @ 2011.07.07

Some formulas rework.

    - Shields are supposed to block both magic && physic skills (L2Guru 2007 topics). I thought it was post IL, and for so, when I refactored skills I kicked this part of code. Now I got the good infos, I add it. So yeah, tanks aren't so weak in this chronicle :). For info, it works exactly like pdef, but add mdef and can do critic success (1 damage).
    - Seeds have been corrected. I did 2-3 tests only but it worked for one fire/wind seeds combo, and 2 fire seeds, no reason it doesn't work for others combos. So from now, all skills are supposed to work correctly.
    - Improved/reworked Attack serverpacket.
    - Completion (removed quoted stuff from skillhandlers) of the NPC soulshot system. Current AI table is kinda messed in this case, as mobs with soulshots haven't any chance to use it, and mobs with chance haven't any soulshot. Freya, freya...

====================================================================================================
Changeset 140 @ 2011.07.06

One quest, glad formula, misc

    - Deletion of one useless lib (removed then added back at rev 69-70, kept for old qengine only).
    - Glad formula is more retail like. Damages are really heavy with 7 charges, around xx + 1 it's normal power (xx is the number of charges the skill uses). Compared to PDAM skills damage, the result seems appropriated.
    - Addition of one quest, Q166. Ty DiNoR for initial share.
    - Correction of all quests considering onAdvEvent() method. Please refer to existing quests in order to get a good template.

====================================================================================================
Changeset 139 @ 2011.07.05

Boats system
    - Boats have been refactored using Freya. It removes the 2 .csv, corrects all related packets, kick players without a good ticket, announce using client strings.
    - Paths seem ok, I tested 2 boats on 5 (go and back).
    - Boats enable config is now enabled by default.
    - Fix a Freya issue when you got only one ticket (inventory glitch at item destroy).

Misc
    - CreatureSay serverpacket allows the use of client strings from now, as I already said higher.

====================================================================================================
Changeset 138 @ 2011.07.05

Quests stuff, and misc.

Quests
    - Rename "Help My..." serie for "Help The...", following client infos.
    - Apply min/max level restriction on quests.
    - Addition of Q003_WillTheSealBeBroken (old name was refering to nothing existing).
    - Cleaned Q045, addition of (qitem, previous quest, level) restrictions, following L2OFF htms. Race condition must be made at quest 006.

Misc
    - 3 NPCs HTMs have been corrected (DE village).
    - NPCs aren't effected by effects (except buffs and debuffs).
    - Walking/run spd set to 0 isn't a problem anymore. You normally can spawn anything you want. That doesn't mean the db doesn't need a correction.

====================================================================================================
Changeset 128 @ 2011.06.25

Items variables cleanup
    - Drop of "is_questitem" and "is_herb". It's now handled directly by etcitem type.
    - Ty Dinor for suggestion.
    - Differenciation between isHerb() (item) and isHerbEffect() (effect).

You have to change all your items XMLs.

====================================================================================================
Changeset 127 @ 2011.06.25

Misc changes
    - Change SQL table format of npc_ai_data table, as some people couldn't install it correctly.
    - Correct HTMs and internal issues for following custom/quests: shadowWeapon, heroCirclet and heroWeapon.
    - Set the rb pdef/mdef multiplier config to 100 instead of 300. Any RB had x3 pdef/mdef.
    - You can't give anymore a castle via the admin command if the target already got a castle (fix a bug).
    - Fix the getExp/Sp rewards formulas (use of MaxHP in formula ? Lol).
    - Tweak the //zone_visual admincommand in order to get less adenas dropped when creating the zoning visual (x2 faster at draw/clean).

Ty SweeTs for many reports, and TheLastHero for the recall: don't forget to change HTMs' quests bypasses.

PS to quests helpers: you have to change HTMs aswell in order to make quests working. It's kinda easy: search for IL name of the quest over the whole "data/html" folder, and use "replace" tool with the corrected quest's name.

====================================================================================================
Changeset 126 @ 2011.06.24

DONT UPDATE IF YOU DONT READ THE WHOLE CRAP.

Quest engine / AIs, part I

Quest engine.
    - Rework of quests engine, using the unstable L2J trunk, in order to be able to use java files (mainly AIs).
    - Deletion of the jscript folder. If you want to help refactoring quests, save this folder anywhere else, or dl back IL quests. "scripts" folder is added, with some AIs.
    - Some AIs added. They're supposed to be final and working. Report all you can about them. I only tested chests and Gordon.
    - Addition of many configs, mainly about World/Grand Bosses and quest rates. Report bosses respawn timers on the forum, as they seem all wrong.

PS: The engine has been stripped of the compiled cache stuff (.rar-ed events and such). ON_SKILL_LEARN has been dropped too.

AIs
    - Reworked AIs. Mobs can know support, heal when low HPs, use skills (they spam them those bitches...)
    - npc_ai_data.sql has been added. It is supposed to get all AIs stuff concerning NPCs templates.
    - Some infos of npc.sql have been deleted, and moved to npc_ai_data (mainly faction => clan).

MISC
    - npcskills.sql is renamed npc_skills.sql
    - L2MinionInstance is dropped. Now all minions are normal L2Monsters. They're still linked to the leader via the minions.sql
    - Datapack is now parametered to see java errors. Allow easy debug on java quests.
    - NpcSat, TutorialCloseHtml, TutorialEnableClientEvent serverpackets added.
    - Core support for tutorial quest (Q255).

MANY LIBS HAVE BEEN ADDED/MODIFIED/DELETED. YOU HAVE TO REINSTALL ENTIRELY YOUR SERVER IF YOU DON'T KNOW WHAT TO CHANGE. TOPICS WITH "CLASSNOTFOUND" ERROR WILL BE DELETED WITHOUT WARNINGS.

Two issues exist on hardcoded AIs:
    - Minions dont appear back, even if the leader is alive (whatever mobs, general AI issue).
    - Mobs with caster types skills don't attack back if their casting range is higher than the distance of the player. Saying it differently, they stay without moving at their position until you reach the good distance. Kinda strange.

No issue has been found currently about the quest engine itself (loading Python/Java correctly).

====================================================================================================
Changeset 125 @ 2011.06.20

Misc fixes.
    - Correct all skills values "cAtk" from 1.3/1.4/1.5 to 1.3/1.325/1.35. Ty Zerador for the report.
    - Fixes buggy entrance message on arenaZone.
    - Add 2 Arena managers on Giran and Gludin arenas. Move the Derby Monster Track one outside the arena. Corrects the hardcoded CP recovery for a buff use, and add a popup if you haven't enough adenas (ty Zerador for the initial code).
    - Crests refactor, should correct all problems of crests for clan/ally (staying crests after ally kick).
    - Added back ToI and coliseum doors as opened at server start.
    - Added the passive buff "Equip Set Items", which is added/removed in same time than a set passive skill. Verified from a L2Off.

Report if you still got problems with crests, I only managed to put/remove/change one to see if I have broken something :P.

====================================================================================================
Changeset 124 @ 2011.06.20

Items refactor, part II

    - Replace all differences in terms of values and names typos from Freya to IL.
    - Added back pet armor/weapons type, and bodypart related to pet's race. Drop of is_petitem boolean.
    - Added all missing onCast skills.
    - Correct tatoos/cloaks, add pDef to cloaks.
    - Added missing SAs.
    - Corrected all typos.
    - And many more...

DP part entirely made by DiNoR, thanks him for the amazing work :).

Items DP is supposed to be finished. Consider report any strange item. Ty in advance.

====================================================================================================
Changeset 123 @ 2011.06.18

Misc
    - Add core support && DP for Court Magician (allow to use castle crown's skill), currently fully working.
    - Correct shields item restriction (as they migrated from L2Weapon to L2Armor).
    - Improve EffectFear (geodata check). I still don't know why mobs take time to be affected. It's not due to effect anyway.

If by any hazard, the Court Magician got other stuff, consider send as much infos as you got on forum, and if possible with proofs about what you say. I didn't manage to find any decent IL infos, except the clan gate part.

====================================================================================================
Changeset 122 @ 2011.06.18

Items, part 1.5 ^^

Correct following errors:
    - Stackable items (5 missing);
    - Herbs effects (both DP && core issue);
    - SoE castles/clans (it was using the old itemhandler, used for backward compatibility, but now it was bypassing real effects so bb old itemhandler and welcome new generation :));

Misc:
    - Added a config for bosses items drop rate;
    - Fixed the targeting issue when sitting (when you double protect something sometimes that bugs, lol).
    - Added Dummy skillhandler, correct "the DUMMY skillType isn't implemented". You can launch fireworks without bugs! Eweussaumeu!


====================================================================================================
Changeset 121 @ 2011.06.18

Fix hennas typos problems. Additionally improve DB structure for those tables.

Ty stanus for report.

PS: prices have been updated aswell. When they seem more... normal (from my player's PoV), if you got proofs old prices were retail, send screen / cry on forum ^^.

====================================================================================================
Changeset 120 @ 2011.06.18

Some little fixes.
    - Core support for isClanSkill().
    - Add an effect on Grade Penalty skill (-50% runspd/atkspd/cstspd).
    - Update correctly passive skill list when Grade Penalty occurs.
    - Update/complete 2 serverpackets.
    - Change calcLvlDependModifier formula method.

Experimental: Point3D doesn't use "synchronize" anymore, which means less used ressources. Such points are used for signets casting as exemple. If you handle strange behavior on signets positioning or such, please contact on forum asap. This fix has been released recently on L2J.

====================================================================================================
Changeset 119 @ 2011.06.18

AdminCommands refactor.

Here are fresh commands for you, mighty admins ^^.

ADDED COMMANDS
    - cameramode: same as retail //camera, thx to Airin (L2J User contribution) http://www.l2jserver.com/forum/viewtopic.php?f=69&t=19618
    - admin_summon_info: displays an information window about target summon
    - admin_unsummon: unsummon target's pet/summon or target
    - admin_summon_setlvl: set the pet's level
    - admin_show_pet_inv: show pet's inventory (currently NOT WORKING)
    - admin_party_info: find party infos of targeted character, if any
    - admin_clan_info: find clan infos of the character, if any
    - admin_remove_clan_penalty: removes clan penalties

DELETED COMMANDS
    - save_modifications, part of the "Edit" button panel of the selected character.
    - visible/invisible, deprecated cause of the existence of vis/invis.

PANELS
    - Many panels are improved. Some holes have been filled aswell with the new commands.
    - Main panel have "dualbox" and "pet infos" buttons
    - "List" > select a character got a fresh panel with new added commands.
    - "Edit" button panel has been seriously revisited. It got only useful stuff.

MISC
    - Cleaned 2 skills. Nothing for you.
    - L2ClanMember typos.

====================================================================================================
Changeset 118 @ 2011.06.16

[SpartaCis] Items refactor - part I

Many has been done those last days. Thx to DiNoR for incredible fast work on DP ^^.

    - Items don't use anymore SQLs. All engine and DP is made for/of XMLs. All items can be found on data/stats/items, and follow original game system (melting armors, weapons, and etcitems in same files).
    - SkillHolder implementation.
    - Duals got now their +4 passive skills.
    - shortBuffTask implementation (healing potions icons).
    - Apprentice PK && CW drop restrictions are now handled in DP.
    - Full rework of shots, + 2 fixes (1 due to Freya, 1 old).
    - Items icons now fade if the item is of same sharedReuse group. Item shortcuts timers are still buggy (as Freya).
    - Potions / Elixirs can be casted during casting. Thx momo61 for initial share.
    - Some beginning rework on petItem. isPetItem() => isPetCollar(), isPetItem() implementation (consider pet armors/weapons as pet items). This chapter is buggy, even on current L2J Freya. More work will come soon or later.
    - Update for BroadcastStatusUpdate, in order to get less sent packets (limit mana updates)
    - L2ExtractableItems are ported from initial .csv to existing skills XMLs. No more loading process for it.

The second part of items refactor will come once people tested and report eventual problems with part I. So you know what you have to do: TEST!

====================================================================================================
Changeset 117 @ 2011.06.16

Multiple little fixes

    - Danse of medusa got anew a time.
    - Some packets modifications (added some packets infos, etc).

Nothing to kill yourself.

====================================================================================================
Changeset 116 @ 2011.06.07

Correct all recipes for IL values, ty DiNoR for initial work.

If some are still missing, you're allowed to cry on forum.

====================================================================================================
Changeset 115 @ 2011.06.07

Seal of Ruler zoning restriction.

Ty DiNoR for initial XML/SQL values, and Ferb for idea/report.

Work better with geodata on. Don't report if you got zoning error without the use of geodata... If players respect zones, zones respect players :P.

====================================================================================================
Changeset 114 @ 2011.06.07

- Duel refactor
- singletons
- one case of permaduel fixed
- code clean, typo
- less packets update

The "error" at withdrawal is related to client side. It could (and read the "could") be related to server, but it's not supported at all else. Variable $s1 should be $s2.

====================================================================================================
Changeset 113 @ 2011.06.07

DayNightSpawnManager? refactor.

====================================================================================================
Changeset 112 @ 2011.06.01

Some deletions, circlets/crowns fix

    - Deletion of L2ControllableMob (as the poll shows it, no one knew the existence of this feature).
    - Deletion of WayPointNode? (old code, no idea why it's still on Freya), and the 5 related variables in Config.java
    - Fix the NPE scenario about circlets/crowns removal. Surely due to NPC owning castle.
    - Admin panel reorganization: move of strider/wyvern from "effects" to "teleport" panel, add of unride option.

If there are still errors at removal circlets/crowns, please consider to give full infos, such as actual people on, who's attacker/defender, etc. Try to test with not defenders on.

====================================================================================================
Changeset 111 @ 2011.05.29

Sieges fixes + weapons cAtk fix

All the code from sieges is entirely from me. That means yeah, I can do other things than c/p, but that means yeah, it can have after-effects as it has been tested only by me, and on a short time laps. So feel free to test all possibilities and report on forum for eventual NPEs/errors I didn't think about.

Sieges
    - Admin commands about sieges won't bypass anymore conditions (can't reg 50 times same clan as attacker/etc).
    - The SQL code to include clan on sieges has been improved (avoid duplicate).
    - Replaced circlets for crown at chamberlain "Give a crown" option. My bad.
    - Remove both crowns and circlets (before only circlets were removed);
    - Crowns and circlets are removed only at the end of a siege (and not at middle time victory like before), and only if the initial castle's owner differs from the end owning castle's owner.
    - Corrected restriction to avoid to register on multiple sieges at the same time (retail confirmed).
    - Added alliance restriction, clan A/B of the same alliance can't anymore register on different side of a castle's siege. They have to be both on attack/defense.
    - Added message for people who aren't clan leaders and try to register to a siege (You aren't authorized...).

Weapons
    - Replace all buggy "cAtk" for "cAtkAdd" in order to correct bugged critical damages, credits to SweeTs.

----

Issues:
    - L2J Freya bug: the skill "Seal of Ruler" (seems) bugged, if you changed of target at cast's end it will try to take the objectID of your ACTUAL target, not on the previous one (so if your actual target isn't an artifact, the entire cast process fails). I got already an idea to fix it, which could be used in order to make some others actions (trade, etc) secured aswell.

I would like informations about missing stuff from sieges, in order to make another refactor part. I would like to add artifact zones mainly. So give ideas on forums, with eventually proofs about what you say.

====================================================================================================
Changeset 110 @ 2011.05.20

Zone update
    - L2PoisonZone is renamed for L2EffectZone (and reworked...).
    - Skills affect only L2Playable instances type (summons and players).
    - Remove a warning on L2DamageZone (no effects).

DP
    - Add an debuff effect on Orfen Lair ;p. Added to the swamp effect, you're really lame now.
    - Renamed the 167 PoisonZones?, nothing more.

Should correct this issue: http://img541.imageshack.us/img541/3423/erroria.jpg
If skills XMLs end didn't do it.

====================================================================================================
Changeset 109 @ 2011.05.19

Skills fixes (signets restrictions, ChanceSkillTrigger)

    - ChanceSkillTrigger debug (work now on any L2Character instead of L2Playable). Debug mirage and all augments using this type of effects.
    - RemoveTarget effect now deletes completely the attackstance (it was keeping attacking even with target off, lol).
    - Added back Battle/SpellForce.
    - Deleted EffectForce. Old ruin of past memories. Or something like "very very old thing" :).
    - Added right conditions for signets cast. They now work (near) as they should.

I decided to use the generic "work everywhere" systemMessage 113 for skill's unavailable forces number condition. If you find a cooler or the exact message (if it's the wrong message), tell me.

In another hand, if you think I missed a check on FusionSkill, tell me aswell. Don't wait 40 revs to say "hey, you got a problem here". It normally checks following states: death, under attack, party break, subclass change.

====================================================================================================
Changeset 108 @ 2011.05.19

AdminCommands? refactor, HTMs spring clean
    - Deletion of //set (if I got many whines on forum, I will add it back, but not on this version anyway). I know it can be useful (modifying configs ingame directly), but not this form (or you have to memorize each godamn config).
    - Drop of AdminTest?; the only survivor, //st, has been moved to AdminSkill?.
    - Merge of AdminShutdown? && AdminLogin? (read DP side).

DP
    - Remove of //recall_npc ghost button
    - accountinfo cleaned, charskills updated (add of removereuse button + broken link fix)
    - Merge of shutdown && login, to maintenance

====================================================================================================
Changeset 107 @ 2011.05.19

ConfirmDlg? refactor, SummonFriend? fix
    - You can now add multiple things in ConfirmDlg? (popups for ress, summon friends, wedding accept). Timer, Zone area and many more are now supported.
    - Timer (30 seconds) and requesterId (fix bugged accept issue) added for Summon Friend. The popup shows too the zone where the requester is.
    - Corrected an issue (when charm of courage will work, it would make the accept button buggy aswell).
    - Modified the generic wedding popup generic for another (normally correct the "?" typo).


Misc
    - IsInCombat? fix. Fix "pets stuck in combat" issue (couldn't unsummon if you "attack" then "stop" the attack before the pet attacks).

====================================================================================================
Changeset 106 @ 2011.05.19

Last skill XML is now commited: 4700-4799.

From now, and for any skill behavior/values, you can post problems on the unique topic "skills problem", in "reports CORE errors" section.

====================================================================================================
Changeset 105 @ 2011.05.19

4600-4699 XML + core support

====================================================================================================
Changeset 104 @ 2011.05.18

Cursed weapons refactor, 1 skill XML

CWs
    - Added propers messages at cursed owner login;
    - Debugged cw_add (missing time task activation, and bug when you added 2 weapons on same character);
    - Singletonizations, typos, missing checks, code actualization;
    - cursedWeapons.xml renamed cursed_weapons.xml, following the general XML naming convention.
    - GrandBosses, feeded beasts and guards can't drop them.

Misc
    - All freakin typos errors "equiped"/"unequiped" are now "equipped"/"unequipped".
    - "DropIt" => "dropIt"
    - Refreshed the reward method (doItemDrop) in L2Attackable.
    - Added 5100-5199 (signets working without force condition, but they work);

Go post "Tryskell is right, you're all noobs" here: http://www.l2jserver.com/forum/viewtopic.php?f=82&t=22092

====================================================================================================
Changeset 103 @ 2011.05.15

ClanHalls refactor + Singletons

Well, it begun with a correction of singletons, and it ends by a clanhall update :).

CHs / Auctions
    - Added the missing 22th auction, (Gludio or gludin) Moonstone Hall.
    - Corrected CHs loading process (Contestable aren't considered as auctionable)
    - Corrected week leases of all CHs (c/p freya), and descriptions.
    - Many typos, improvements and singletonizations of related instances.

Misc
    - Some singletonizations.
    - Added RequestExMagicSkillUseGround packet content (signets), ty Zerador for info.
    - Manufacturing checks are now made in clientpacket, not in serverpacket.

====================================================================================================
Changeset 102 @ 2011.05.14

Augmentations refactor

Yeah, fully working. What more to say...
    - Augmentations are added when unequip/equip items, and loaded with inventory.
    - I used Freya, and deleted all accessories part, plus useless stuff (yellow array, useless method,...)
    - Augments are now deleted with items, when a character is deleted aswell.
    - Active augments got their cooltime stored.
    - Some security checks added in concerned packets.

About DP:
    - c/p of the skillmap (go from 58ko to ~530ko)
    - If there are problems about eventual postIL skills, tell me on forum. But from what I know, all are in the 3100/3200/3300.
    - Added a couple of configs.

Misc:
    - Drop of getItemGrade(), which called getCrystalType(). Why it existed, I have sincerly no idea. And you can't say dev was drunked, because he did the javadoc, and said on it "it is the same". Lol.
    - Mini reorganization in Config.java, in order to make lines less big. Just spaces basically.

====================================================================================================
Changeset 101 @ 2011.05.13

FishTable XMLization, ty treaser for initial share.

    - XMLization of fish.sql => fishes.xml
    - To respect naming conventions in the XML folder, zone.xml => zones.xml

====================================================================================================
Changeset 100 @ 2011.05.13

Pets refactor, part II

    - Reorganization of the XML and loading process
    - Update of the FeedTask?, with now the possibility of pet deletion if it is hungry (30% => 5% luck, 10% => 30% luck).
    - Some stuff which will be used when items refactor will come.
    - Hungry state setup to 55% (will be used for autoconsumption of food).

Pets are still heavily broken (3 major problems), and they need items refactors from now (currently, food isn't considered as pet item).

====================================================================================================
Changeset 99 @ 2011.05.12

4200-4299, ty SweeTs? for initial work.

====================================================================================================
Changeset 98 @ 2011.05.11

Move of zone.xml in xml folder, plus a little clean on ZoneManager?.

====================================================================================================
Changeset 97 @ 2011.05.11

XMLization of pet_stats, plus a couple of rework.

Many values are now automatically calculated, not loaded from table. I need to experiment and debug a lot on this side, as calculations seem incorrect.

Pets got many problems anyway.

====================================================================================================
Changeset 96 @ 2011.05.08

ArmorSets? table XMLization, ty treaser (my treasure ;o) for initial share.

====================================================================================================
Changeset 95 @ 2011.05.08

Inventories update, part III

Warehouses
    - Warehouses clientpackets updates

ClanHalls?
    - ClanHallManager? refactor
    - Mana consumption for CH buffs corrected
    - Teleports lists corrected and/or added (schuttgard was missing) using Freya.

Misc
    - StatusUpdate? update.

====================================================================================================
Changeset 94 @ 2011.05.06

Inventories update, part II

I warn you: this update is pretty huge. Well, you could think "he says that to each commit nowadays", lol, and the worst is: you're right, as I'm right saying it's huge :D.

Inventory refactor
    - Paperdolls refactors, LRHAND dissapears (not the slot! ). Bows/staff are now considered as RHAND.
    - DHAIR => HAIRALL. Just to understand better 'what the hell is this crap'.
    - Inventories instanciation. Should make sad some exploiters.
    - Formal wear retail way (alldress slot).

TradeList refactor
    - Refactor the buylists loading (no more .csv support).
    - Correct and improve (adding checks, using fun stuff) packets using them. Add some checks, those sorts of stuff.

"Wear/Try on" system
    - Drop of the old "wear/try on" system, and of all old methods (isWear, and such).
    - The new one is buggy as I miss packets infos, and the only infos come from Freya (this stuff has been implemented on L2J around rev 44xx). WearList > ShopPreviewList, and added a new packet, ShopPreviewInfo.
    - The new system doesn't need checks as it's only a packet which change the appearance of your stuff. Basically not exploitable, and extremely light in ressources' usages (before an item was created, used, then deleted).

Misc
    - L2ManorManager refactor (warning: as I suck with manors uses, I didn't manage to test crops/seeds sell/buy etc. I would like someone teach me how this crap works one day, lol).
    - Refactor of the way to count arrows.
    - Some packets refactors (mainly RequestCrystallizeItem), and many cleans.
    - A GM can't use hero weapons anymore if he isn't a hero himself, in order to avoid the "stupid bug" at relog, which made me lose 30min to find why it happened (and when a inventory refactor comes, you're pretty nervous about "WHY THE FOCK THIS STUPID HERO BOW IS REMOVED AT RELOG AND NOT OTHERS WEAPONS ?).
    - Correction of a couple (around 10) of logs names... Ty Sentinel to open my eyes on this awful critical issue which could destroy the Earth and humanity. Which isn't a awful critical issue which could destroy the Earth and humanity, but still make you cry.

Admin commands
    - Ended the refactor of AdminEditNpc (both "edit" and "shop" parts have been corrected and improved).
    - AdminEnchant send only one message if you're the target.

And once again:
REPORT ON GODAMN FORUM IF ERRORS OCCUR, DONT CRY ON MXC THREAD XAXA.

====================================================================================================
Changeset 93 @ 2011.05.03

Inventories update, part I

    - Update each type of inventory.
    - Correct items consumption problems.
    - Fix around 10 different issues, such as bad synchronizing, freight exploits && missing checks.
    - Inventories (mainly normal inventory and freight) are loaded FAR faster.
    - Added not 1, not 2, but 3 configs! Ooooohhhhh!

Break definitively augmentations, which still need a complete refactor. The pet inventory isn't supported yet aswell (need PetTable? and model entire refactor).

Tested skills consumptions, and the triforce (WH, CWH, and freight). Anyway, report if errors occur.

====================================================================================================
Changeset 92 @ 2011.04.30

XMLization!

We got another XMLlizer, treaser :P. Ty to him for those 2 shares.
    - 2 tables are now XMLs, teleport and newbie buffs.
    - Reorganisation of XMLs (data/xml).
    - Couple of little fixes, such as Config.DATAPACK_ROOT and unification of XMLs errors messages.

Added protection blessing core support. Wait for 5100-5199 for effect.

====================================================================================================
Changeset 91 @ 2011.04.29

Couple of fixes for pets/summons
    - L2SummonAI refactor (enjoy the 10sec Freya copy-paste), which adds the "avoidTask" feature (when your pet is hitted, he moves around you);
    - Teleport is fixed with a pet (pet is ported with you);
    - If the pet is 20 lvls more than you or a wyvern/sin eater, you can't make it attack;
    - Couple of fixes in the different summons/pets actions aswell (follow, stop, attack);
    - Pet follows you when you summon him for the first time (before it was standing like a tree);

Misc
    - Some cleanings in L2NpcWalkerAI.

====================================================================================================
Changeset 90 @ 2011.04.29

NoStore? implementation + 2 messages, ty Zerador for initial patch.

NoStore?
    - Only the jail and both Oracles (dusk/dawn) are setup as NoStore? zones.
    - Both private stores (buy/sell) and private manufactures (dwarven/general) are blocked.

Privates stores/manufactures
    - Got more and shared conditions (must be unmounted, not in nostore zone, be alive,...)
    - Some packets clean, and one exploit fix.

2 messages added
    - When one of your blow fails;
    - When you avoid the attack of character xx.

====================================================================================================
Changeset 89 @ 2011.04.28

Multiple fixes.

IA
    - Correct problem concerning the broken animation on NPC cast skills.
    - Correct guards non-attacking in towns.
    - Add the running state to a mob who hitted you (once the first 30s period is down, the mob is walking but he never run back if you don't hit him).

Commands
    - AdminCreateItem? refactor (ty TheLastHero? for nice Freya rework).
    - //areacancel debug (ty Ferb for report)

Misc
    - Daggers blows no longer use P.atk in calcul, but they got now critical vulnerability counted in the calcul.
    - Multisells have been cleaned (ty Sentinel)
    - isOnline is now a boolean from A to Z (ty TheLastHero? anew)
    - 2 pledges packets have been completed, L2ClanMember registers now the race and sex.

====================================================================================================
Changeset 88 @ 2011.04.28

was a single XML :]

====================================================================================================
Changeset 87 @ 2011.04.25

I believe I can fly + 1 XML

FlyToLocation? implementation.
core support for 5000-5099, ty DarthVader? for the good work on XML part.

====================================================================================================
Changeset 86 @ 2011.04.25

Couple of fix, L2Npc shift-click refactor

    - Renamed MagicEffectsIcons packet -> AbnormalStatusUpdate
    - Corrected the skills bar refresh at death (when buffs are retained for example).
    - Beginning of L2Shift click refactor: added 4 news commands to add/remove skills to a Npc template (change ALL current monsters using this template), improved droplist view/add (added color system, ty to Vampir from MxC for original idea). The shoplists stuff will be refactored after a L2TradeItem refactor, for the moment it uses old stuff.

====================================================================================================
Changeset 85 @ 2011.04.25

This is... SpartaCis!

Status refactor
    - All status have been corrected, and 2 have been added (Folk and Attackable).
    - Noblesse is fixed (only a visual bug left, but I wait next rev to correct)

Pets
    - PetInfo packet refactor (many useful infos added, but reachable only in a next rev :D)
    - Karma/pvpflag stuff have been entirely dropped (it uses owner values)

Entire Death refactor (Ask that to Chuck Norris, he can't)
    - isKilledAlready => isDead
    - isFakeDead moved to L2PcInstance
    - Correct //res command (from what I tested), and add anti-exploits.

setCurrentHp refactor
    - You can selfDoT using meditation now (tyrant toggle bug + meditation which break the meditation is corrected)
    - When you're invul, selfDoT and selfHP consumption skills still damage you.

Misc
    - NPCWalker cleaning
    - killByDOT implementation (only one skill uses it)
    - L2Character doAttack() method: your attack is canceled if your target enters in peace zone, can't attack with wyvern on melee)
    - Typos: isImobilised )> isImmobilized, and others
    - Corrected isHeroItem() method (any non droppable items (Manacle Penitent and such) were considered as hero items...)
    - getEquipSlot -> getLocationSlot.
    - Doors can't be DoT anymore.
    - L2Npc canInteract() method improved.
    - Mobs can anew launch skills, but their animation is a little broken.

WARNING: I tested as much as I can, but it needs a shitload of tests in order to see if I didn't mess something. Changes are heavy, and touch general ingame behavior.

====================================================================================================
Changeset 81 @ 2011.04.20

2 others XMLs, ty DarthVader? (but take care about element next time :D).

====================================================================================================
Changeset 80 @ 2011.04.20

2 XMLs + core support.

====================================================================================================
Changeset 74 @ 2011.04.10

WeddingManager? refactor, VoicedCommands? deletion.

I decided to delete VoicedCommandHandler?, which was only used for wedding commands (the .commands).

Divorce and GoToLove? are now directly handled by the Wedding manager (id 50007). The config AllowWedding? has to be active to make the instance works. Configs have been reduced to the "strict minimum". The system needs more tests in order to find possible exploits, but from what I think, I made it secure.

If you got ideas of code improvement, or find an error/exploit, post in forum please.

I added too the character_raid_points table in installation setup, my bad.

====================================================================================================
Changeset 73 @ 2011.04.06

    - Corrected all possible issues where the total of reputation points wasn't updated.
    - Updated some clan packets.
    - 3 NPEs fixed;
    - Refactored entirely acquireSkillList/acquireSkillInfo;
    - Corrected a missing thing on accessLevel (didn't do problems so far, but better to put as it should be);
    - Cleaned the last 8 errors, and 8 warnings (part of warnings were NPEs, and explained stuff);
    - Refactored Hero model.
    - L2FishermanInstance inherits from L2MerchantInstance right now.
    - Deleted the "missing skill: can't store blabla" NPE issue at any character loading (FrequentSkill? wasn't loaded o_o).
    - Refactored the WeddingManager?
    - Added config for Divine Inspiration spellbooks, and make the original "allow spellbook" config work properly.

COMMENT:
I didn't test Hero refactor. Nothing should make you cry, except when the new heroes are named, as it uses a "not-tested-at-all but cleaner" way to unequip then delete all hero stuff from previous heroes. So consider testing this and report if a problem occurs, screenshots appreciated.
In another way, the wedding manager haven't been tested at all, mainly because I count to delete the voicecommandhandler system, and fusion marriage commands on wedding manager HTMs.

====================================================================================================
Changeset 72 @ 2011.04.06

Multiple refactors, RBPoints manager, and more.

Instances refactors
    - L2SiegeGuard (easier returnHome() method)
    - L2RaidBoss

Refactors
    - IDFactory + the different types (Stack / Bitset cleaned, Compaction have been dropped)
    - RaidBossManager?;

RaidBossPoints? Manager / Task
    - Open your Map > "raid" tab is now available, showing you your actual rank, RBs, and point over those RBs.
    - System which give a amount of points according to numbers of killed RBs ((RBlvl / 2) +- 5), according to your rank you can earn Reputation points for your clan.
    - Task is running every week (monday at 00h10), ranks and overall points are reseted.

Issues / Misc
    - Corrected typos;
    - Corrected db cleaning (friendlist), and added the clean of skills' timestamps;
    - Subpledge leader is no more using a string, but the objectId. Same for all methods using private map "_members" from L2Clan.
    - Drop of serverpacket "AllyInfo?", merged in "RequestAllyInfo?" clientpacket + refactor on it.

====================================================================================================
Changeset 71 @ 2011.04.01

Multiple datatables refactors, and corrections.

    - Reorganization of many datatables (use of singletons/Trove, load/reload options, some improvements, and many cleaning)
    - Fixed a NPE at subclass change option, and added a weight limit (80%) for both add && change subclass options.
    - "Fixed" 35-40 warnings.
    - Added "//reload door" possibility, and fixed "//reload zone".

More singleton-ations soon :).

====================================================================================================
Changeset 70 @ 2011.03.30

Fix 30 warnings and added back the missing lib.

    - 30 warnings fixed, going from "not used variables" to "private -> protected".
    - Activated the curse raid feature (higher than 9 lvl, blabla). Don't cry for missing skill 4515, it's not done yet.
    - Added back the .jar deleted on rev 69, sry about it, and ty for fast intervention.
    - Added back the recommendation system. IL used it as an alternative config, and in my "gogo, deleted them all" frenzy, I deleted what I think it is retail (at very beginning of the project, around rev 10). Currently and from now, player and target are stored in a table, which is cleaned up everyday at 13 (from what I rem lol). So you can't give all your rec to one people relogging everytime.

====================================================================================================
Changeset 69 @ 2011.03.30

Cleaned code, optimizations, and 3 XMLs.

    - Deleted WHCacheManager;
    - Cleaned up CrestCache?;
    - Deleted useless class/package;
    - "commons-logging" implementation switched back to "java logging";
    - config + cfg moved to separate source folder;
    - Cleaned useless imports;
    - Cleaned up around 350 warnings;

Thanks Intrepid for core patch, and ty to DarthVader? for 2/3 XMLs.

====================================================================================================
Changeset 68 @ 2011.03.29

2 XMLs and associated core support.

Thx Vrugar for 4100-4199.

====================================================================================================
Changeset 67 @ 2011.03.29

Doors / StaticObjects? refactors.

Doors / StaticObjects?
    - Optimized and clean both instances and loading tables;
    - Added/cleaned shift-clicking panels for both of those instances;
    - Doors (from a CH you own) can now be opened like retail;

XMLs skills
    - Corrected 0-99 skills values and some skills behaviors;

SQLs
    - Corrected a critical issue where NPCs templates provoke a 100% client critical error. Ty SweeTs? for report, and FighterBoss? for ollllddd one too. Some NPCs still got a template with 0 run/walk speed (less than 20 NPCs, before 77). Don't try to spawn them, you will got a direct disconnection, and couldn't log back with this character until you cleaned the NPC.

Misc
    - Normally (only suggestion, as it's not a 100% issue) corrected an issue when you try to revive.
    - Added missing accept button result for summoning friend action. It couldn't work without.

====================================================================================================
Changeset 66 @ 2011.03.27

Knownlists, AIs, misc

Well, it fixes a critical issue came around geodata/move refactor. Basically, knownlists (lists which list surrounding objects) were called during move and stop actions. Refactoring geodata, I deleted the move part. So you could only see people/monsters when you stop to run.

Now knownlists are refreshed using a single task. Knownlists have been refactored aswell.

Misc part:
    - Some AIs improvements, like guards can now hit invulnerable people (before, they just didn't care).
    - GeoEditor? clean;
    - SiegeManager? uses a singleton;
    - Some cleaning and code move from L2Character to L2PcInstance. Use of Collection when possible.
    - dropMe() refactor + geodata checks.
    - NpcInfo? packet rework.

    - Added back engine=myISAM for etcitems.sql. Hope it will stop database installer problems. You have to know this table will disappear in a next future.
    - Cleaning the .classpath

====================================================================================================
Changeset 65 @ 2011.03.24

Xmls, refactors & misc

    - Three more XMLs & core support (valakas stuff, EffectRecovery? and <target NpcId?="">).
    - You can now //play_sound using packages (try "//play_sound systemmsg_e.char_creation" to understand).
    - CrestCache? refactor.
    - L2GuardInstance && RaidBossInstance? use a simplier code to return to initial position. No more "anti-exploit" full heal for bosses.
    - Added support to mobs which mustn't random move (guards, raids, chests, etc).

Thanks Wdemon for systemmsg sounds initial idea. All will come with time.
Tanks to SweeTs? for XML rework.

----

IMPORTANT: many skills we're doing right now are not used. In fact, an item is supposed to be attached to a skill. An skill can be itself attached to another skill (like active augments skills or signets). L2J IL made it differently, hardcoding skills effects directly on itemhandlers (SoEs? for example). For backward compatibility, I use all old code, but refactor skills the new way.

Once the time of items refactor will come, each item will use its own skill. For the moment all (or near, as some hardcoded code already dissapeared) is supposed to work IL way on this side.

So if you understand all right, some stuff I'm doing actually is pointless until items are refactored. Still, it's a lot of work, and once items are refactored the right way, all should be working. For stuff like SAs and augments, it's already working.

====================================================================================================
Changeset 64 @ 2011.03.20

1400-1499.xml and core support.

====================================================================================================
Changeset 63 @ 2011.03.20

AdminCommands && L2Party refactors

L2Party
    - Position is now broadcasted using a task, which send position of everyone every 10 seconds. Position code in clientpackets dissapeared;
    - Many null checks added, both for party and CommandChannel;
    - Add of some retail messages (party and CC);
    - The update of partyleader icon is now fine;
    - The pending invitation formula have been changed. Now, only one invitation can be sent. You have to wait this invitation ends to send another one. Before you could spam invitations, so it was ugly.

AdminTeleport
    - Added //sendhome && //instant_move (alt+G panel);
    - Cleaned commands I judged useless (gonorth/south/west, etc). //walk, what a joke command...
    - "//teleto" renamed for "//runmod". //runmod port you once, //runmod tele port you anytime, //runmod norm stop the porting state. Why a rename, it's simple: too many commands begins with "//tele" and it's hard to remember them all.

AdminMenu
    - Drop of 80% of code. All those commands are already existing in another files, and as they are outdated in this one, it's stupid to have same methods twice. So HTMs use updated commands.

HTM admin part
    - Drop of castles and towns positions HTMs. Only one port for each (to simplify).
    - Esthetic of many files.
    - Merge of move.htm & teleports.htm, drop of useless parts.

Misc
    - CW karma is now 9999999. I know, I know...
    - Some packets typos & spring clean.

====================================================================================================
Changeset 62 @ 2011.03.18

Hell's Refactdoom.

Fishing refactor
    - Use of ZoneManager (was using FishingZoneManager for backwards compatibility);
    - Many improvements (add of sounds, geodata checks,...) and typos;

MercTicketManager refactor
    - Add of the proximity formula for tickets (have to been ameliorated, but it works);
    - All retail messages for tickets;
    - Some improvements (use of iterator, etc);

Skills
    - Add of 6 XMLs and respective core changes (4 new conditions);
    - Add of Cancel skillhandler (Cancellation, touch of death, warrior/mage banes,...);
    - 3/5 cubics are working (the 2 others are only XML issue);
    - Correction of the CHARGEDAM formula, which is hardly bugged on Freya (topic on L2J server: http://www.l2jserver.com/forum/viewtopic.php?f=80&t=21356). It still need correction as infos come with time;
    - Add of creatures natural resistances formula. It's calculated using weakness formula aswell;
    - NPCs stats influences their overall stats (HPs, accuracy, critical, atkspd, etc);

Admins commands
    - Deleted 50+ freya commands (event engine, elementals, ride wolves...);
    - Corrected addlevel / setlevel;
    - Added "zone_visual" command, which is very useful;
    - Refactored all "reload" commands type to work on the same pattern. Basically 12 commands can now be typed "//reload xxxx";
    - Deleted some leftovers of rev 61 ("//admin5" and related commands);

GM Panel refactor
    - Refactored entirely the help system (FAR more simplier);
    - Reorganized many htm, typos and esthetic;
    - Drop of all TvT htms left;
    - jukebox, emotes, announce HTMs reorganisation;
    - Deletion of all customs skills in special skills.

SQLs
    - Deleted all freakin "innodb", "utf-8" and "myISAM" stuff and spring clean on all tables;
    - Reorganized skills_trees.sql;
    - Drop of zone.sql (leftover of IL zoneManager ?), which call a "tools" folder update;

Configs
    - Dropped some not used configs.
    - Put fishing to "false" by default. As explained in the config file, it needs geodata in rder to work like retail. Else it's buggy.

And many typos corrections.

====================================================================================================
Changeset 61 @ 2011.03.07

Shutdown refactor, PunishLevel?, adminCommands.

Shutdown refactor
    - Freya way. Do the same but better written.

PunishLevel?
    - Jail punishement got now a duration
    - The system is centralized (no more chatban task, ...)

adminCommands
    - Merge of AdminBan? and adminBanChat;
    - Merge of AdminDisconnect? and AdminKick?. Allow //kick on a target.
    - Drop of the whole AutoAnnouncement? system (which was already broken since low revisions, and no one cried about)

Misc:
    - "Chatting is prohibited" box on all chats when chatbanned/jailed.
    - teleToLocation correction.
    - staticPackets (ServerClose?, LeaveWorld?).
    - L2GameClient rework (avoids to logoff too fast if characters is subclassing / in attack stance.
    - Many minor corrections/typos.
    - Rework of main admin panels & announce menu. More work soon or later, it was just intended to delete useless buttons, and to format the code. Drop of "Mods panel".

====================================================================================================
Changeset 60 @ 2011.03.05

Skills refactor, part IV

L2Summon / Cubics refactor.
    * Manage duration of cubics, casting ability for summons (last haven't been tested).
    * Refactored formulas. Use of activationtime/chance.
    * Some stats have migrated from L2Skill to L2SkillSummon

AttackStanceManager? refactor
    * Debugged players stuck in attack stance.
    * Cubics use attack stance as activator.
    * Summons && players attack stances are splitted.

Skills formulas
    * Use of Freya resistances way. Will be easier to complete skills.
    * Drop of many templates (all baseVuln), which were put to 0 by default and never used. It still exists on Freya, and currently it's useless... From IL to Freya.

DP
    * correction of summons, L2Npc > L2Pet
    * added all ways to enchant summons. Dwarves powa.
    * Refactored existing skills to use Freya resistance/vulnerability way.
    * Corrected many skills, which haven't overHit or baseCritical ability in IL. ToD is now IL way (caster haven't lose of 90% CP, only 1,2k HPs).
    * Add of 1200-1299.

Warning: Seeds cast (fire/water/wind) are messy. Main fault is because those skills have seen their use changed from IL to Freya, and I didn't bother at first time. I reverted back 99% of old code about seeds, but still the cast is buggy.

Warning: cubics skills are around 41xx-43XX. They currently aren't added, but have been tested. Cubic heal is pretty oped :o.

====================================================================================================
Changeset 58 @ 2011.02.22

Spring cleaning + misc refactors.

Well, ok, it's not yet the spring, but hey, I decide if it is spring when I want!

Util cleaning
    - Well, before L2World refactor GS was using stuff, and now it doesn't anymore. Lol.
    - Rnd refactor.

Config cleaning
    - AGAIN? Yeah, I will leech out all heretic configs :D.
    - Deleted "not used anymore" IdFactory options, put survivors in server.properties. Burned IdFactory.properties.
    - Deleted the assert config, true by default from now.

ItemsOnGround refactor
    - Some cleaning, some improvements.

All others files (mainly L2ItemInstance, preparing the next battlefield)
    - Typos

I need review on ItemsOnGroundManager mainly.

====================================================================================================
Changeset 57 @ 2011.02.22

GeoEngine / PathFinding refactor

Needed refactor ended :). Works wonderful using Stazis.

Well, I suppose all know what is geodata. So I explain things you surely don't know:
    - GeoEngine load geodata files, when PathFinding load pathnodes.
    - The way to calcule pathnodes can be made differently:
        - Using GeoPathFinding method, which load pathnodes (need geodata + pathnodes then);
        - Using CellPathFinding method, which uses geodata data and calculate "on the fly".

Both ways got pros/cons, explained on the ".properties".

From those last informations and the comments of .properties, you shouldn't fail activating geodata :). Anyway, here are some good settings.

For both configs: geodata = 2, ForceGeodata = True, CoordSynchronize = 2
    - Using geodata w/o pathnodes: CellPathfind = True. For fun, put "DebugPath = True" to see if it's works, or to check your geodata doesn't sux. You have to make a collision to activate it (wall, tree, whatever).
    - Using geodata && pathnodes: CellPathfind = False.

Be clever and read godamn comments. I splitted options according to their uses.

---------------------

Added to that:
    - I debugged multiple clicks on a player, which made you stuck.
    - Moved 3 options concerning IAs and not GeoData from "server" to "npcs" config file.

====================================================================================================
Changeset 56 @ 2011.02.21

L2Spawn / SpawnTable? refactor.

I think this is the end of this error: http://acis.i-live.eu/index.php?topic=9.0

SpawnTable?
    * The Map/FastMap use have been changed for a FastSet?.
    * The id and getTemplate of L2Spawns have been dropped. It need a refresh of your "spawnlist" table.

ItemHandlers?
    * Use of TIntObjectHashMap instead of MapTree?.
    * The summonsItems type (hatchling, X-mas trees, wolves,...) have been refactored. The cast is 5 seconds, you're considered casting, and many checks + improvements have been made.
    * no more errors saying "the object exists already in OID map".

spawnlist.sql
    * 3 columns have been dropped (id, randomx and randomy).
    * table's format have been improved.

====================================================================================================
Changeset 55 @ 2011.02.19

Skills, part III

You will be happy with this one :) Items restriction is finally working. You need to replace armor and & weapon tables, plus some weapons XMLs. The only missing part to make all skills work is more or less XMLs now.

Items restriction
    * retained formula is a mix between old and new coding style. This is the best waiting items refactor, cause skills won't be affected in future.
    * 7 errors are still shown, and around 200 weapons aren't loaded. It's due to the fact skills are missing (as SAs use skills). Wait skills are rewritten.

Skills engine
    * TARGET_PARTY_CLAN have been deleted, which got interest only postIL (OL skills used for both clans/party members, not in IL);
    * TARGET_AREA_SUMMON activated, core side for mass surrenders of summons.
    * some sleeping codes awaken due to previous revisions.

====================================================================================================
Changeset 54 @ 2011.02.18

Skills - part II
    * Signets engine - as you perhaps don't know, signets use others skills. So it works (cast) without working (effect) atm.
    * Signets don't use BattleForce/SpellForce? because of Freya implementation. Anyway, those skills (BF/SF) will come at 5xxx... I will correct at time.
    * Dodge core side. Works for blows, charges skills and PDAM skills (minus bows types skills). This last implementation is self-made, so need to test.
    * Mirage uses skill 5xxx in order to trigger. So like signets, it works without working.
    * Meditation core side (it's from hellbound, at Freya you're just paralyzed...).
    * PlayerState? olympiad added, used to verify if a skill is allowed in olympiad.

Config
    * suppression of AltGameViewNpc?.

Packets
    * renamed MagicSkillUser? -> MagcSkillUse?.

====================================================================================================
Changeset 53 @ 2011.02.15

Refactor & fixes.
    - GameTimeController? refactor;
    - Corrected a bug at any character creation, based on setOnline value problem (why no one reported it, I ask it myself);
    - ShowScreenMessage? serverpacket (I try to search any retail use of it, already found some);
    - Added ShadowSense? messages (at enterworld). Messages based on time cycle are for the moment not available.

====================================================================================================
Changeset 52 @ 2011.02.11

Organisation & fixes || affects many files again.

Configs
    - AutoLearnSkills set to False by default

Skills
    - Removed 2 useless craps from L2Skill, getCanLearn() && canTeachBy().

Organisation
    - Moved L2Character, L2Summon, L2Attackable, L2Npc, L2Playable from previous locations to "actor" folder.
    - Renamed L2PlayableInstance to L2Playable, and L2NpcInstance to L2Npc.
    - Renamed L2FolkInstance to L2NpcInstance.

So if you followed all, before it was "L2NpcInstance & L2FolkInstance", now it's "L2Npc & L2NpcInstance".

Instances
    - Drop of L2BlacksmithInstance, not used.
    - Refactor of L2NpcInstance (previously named L2FolkInstance) using StringBuild instead of TextBuilder.

Clan traders
    - Fixed multisell preview for those characters, ty rebelstrike for report and Chr.Trance for initial commit.

====================================================================================================
Changeset 51 @ 2011.02.10

Debugged animation/sound effect of dropped items, and surely more than that (PK drops must work now, only a supposition but it's normal to be related). Affects all dropMe effects.

This bug have been first introduced with the L2World refactor (rev 22 if I remember well). Unfortunately to make the whole mecanism working, I need to completely refactor knownlists. The good new is I got the "howto scout manual" from L2J revisions (aka, the precise revision refactoring knownlist). The bad part is I don't want to begin another big refactor (and even if it isn't as big as skills, it's still a lot of work) before ending skills one.

So I decided to revert some parts of my previous work, to make it less buggy and don't melt possible bugs between them.

Need confirmation about player's drops when you die as a PK. But as I already said, it should be related.

====================================================================================================
Changeset 50 @ 2011.02.09

50th commit guys :D.

This one is special "helpers reports" :). I want to thank all people which have/will contribute to the project. This 50th commit is a "pot-pourri" of many problems you reported. The right people will recognize themselves, I hope :).

Please remember reports you do are NEVER out of my mind. I just got priorities, that's all. All will be corrected soon or later.

Skills
    - TargetMe effect (aggro type skills) got 2side effects: if victim haven't target, victim targets aggroer, and the second aggro will make victim attacks aggroer. If victim de-targets the aggroer, the next will only retarget aggroer.
    - "Incorrect items count" message + a little fix about name of used skills. Affects all consumables type skills (quiver arrow, blabla).
    - Wrath shows now the generic damage system message for the victim.
    - Toggles are now usable even sit. It's stupid to stand up to remove Vicious Stance.
    - Skillhandlers SummonFriend, TakeCastle && StrSiegeAssault got now cast conditions working, and are refactored.

SystemMessages
    - SystemMessageId refactor, using c/p of Hellbound (all is organized and seems to be all right).
    - Added 5 messages about sieges (cast on artifact, artifact taken, loose/add of reputation points through sieges && change of castle owner).

Sieges
    - updateClanReputation() method "use" have been moved from removeOwner() (castle.java) to endSiege() (siege.java).

Ty again for support, and long life to aCis! :)

====================================================================================================
Changeset 49 @ 2011.02.09

Organization of templates && - complete - dyes refactor.

Okay, it's seems huge but it isn't.
Different templates types have been simply organized in folders, to make it clean. This is 90% of modified files.

The real work comes with hennas refactor (known as dyes or symbols):
    - Added 2 missing retail messages;
    - Fixed an exploit when you add a symbol;
    - Added the real way to remove dyes (added 3 clientpackets && 2 serverpackets) instead of the html way;
    - Optimized hennaTable && hennaTreeTable loadings.

An know issue still exists, but it's not only for this add: when you remove dyes, 5 go back in inventory. They actually REALLY go in inventory, but there a missing inventory refresh on addItem (the academy circlet given at kickout from clan when 2nd class change occurs should actually have the same problem). You can refresh inventory buying an item from a shop as example. If you buy 5 others dyes, it will show correctly 10 then.

Consider testing symbols and low symbols for pre-40 too, and report errors. About "text going out of window" && "text isn't the good one for my dye" issue, this is NOT a core bug, but client side. Blame NC$oft to forget to check what they do.

====================================================================================================
Changeset 48 @ 2011.02.07

Libraries
    - Updated mysql-connector lib from 5.0.7 to 5.1.4 (must change both for ls and gs, you know the music...);

Configs
    - Deletion of nondroppablelist config, which wasn't used (FighterBoss, you missed it I think :D);
    - Others droppable lists (for chaotic players / pets) are kept and improved (use of arrays);

L2PcInstance
    - setKarma and broadcastKarma now use collections in order to be broadcasted.
    - "Your Karma has been changed to" message extended (not only for admin command use now);
    - onDieDropItem() method improved (should be same rule than before);
    - get/setCharmOfCourage dropped. Effect is handled directly from the L2EffectType, so it was old ruins from past empire;

Packets / Misc
    - Boolean -> boolean. Blablabla;
    - Corrected an self-added bug (my bad arg), which made GMs buggy shift-clicking on a corpse-like player. It was boring, so I revert it. Strange than no one reported it, it's common action on test servers w_w;

This commit was - at first - to find an issue to SweeTs report bug about pk drops. But it seems it's another big rework which await me, as knowlist need a full update due to my rev 22 L2World refactor. Well, you got some things corrected so don't cry.

====================================================================================================
Changeset 47 @ 2011.02.07

Deletion of stuffs dating of Noe's Arch (or even older, depending of Coriolis force on the Newton's apple).

Nothing to hurt a dancing cow in the moonlight of a hot but wet 13 July night, but still, it deletes a crappy useless stuff in gameserver loading. Happy ? Yes, you are.

Gameserver and GameStatusThread (but who use telnet ?) are affected.

And tell me if I missed removing classes from those lost && useless things. They're not even used between themselves...

====================================================================================================
Changeset 46 @ 2011.02.07

I will do short, cause current comment have been deleted and... Fock eclipse.

Friends && blocklist refactor
    - character_friends.sql have been updated. The relation column equals 0 for friend, 1 for blocked.
    - Blocklist is now stored in database, before it wasn't.
    - A blocked player can't invite or trade you, and you can't hear him from any chat.
    - The "Chat with Friends" option have been updated. When you add or remove a friend, it updates in real time.
    - Many checks && fixes have been added to /friendinvite && /frienddel packets.
    - Friendlist loading is now only located to L2PcInstance, operations are made on the fastlist when needed. Before it was messy.

SetReputation refactor (from L2Clan)
    - "splitted" in 2 options, TakeReputation and AddReputation. SetReputation got now private access.
    - Simplier to use && to read.

L2PcInstance
    - Refactored the code about clan wars in doDie method (corrected the number of added/removed reputation points).
    - Subclasses are now locked during the process. No more exploits possible on it. You can't delog/restart during the process.
    - Many fixes for classes (autoskilllearn if config, send of packet for refresh partyicon, etc)

Packets rework
    - Many concerned "friends" packets have been renamed && refactored to L2J actual names.
    - Logout && RequestRestart packets have been totally refactored to fit with subclass lock.
    - setToLocation serverpacket dropped, we won't miss it.
    - SystemMessage corrected for addPcName. This is the same problem for bugged skills messages.
    - /partyinvite have new checks && more retail messages, depending of the situation.
    - RestartResponse serverpacket is now static type.

====================================================================================================
Changeset 45 @ 2011.02.03

Refactor Enterworld
    * deleted customs (announce hero & castle lords at login)
    * migrated some infos in others packets / initializing stuff (pledges, sethero, setonlinestatus, signssky)
    * added seal of strife effect (buff / debuff according to winner/loser side)

Deleted 2 useless tables. You're right, they were both useless + same content.

Deleted the "ProtectionIP", basically show if you were connecting from another IP. Sort of useless stuff as IPs are 90% time dynamics, so when you reboot your inet box you got an alert message "beware your last IP wasn't the same"...

Report if any error at login occurs.

====================================================================================================
Changeset 44 @ 2011.02.02

Some reworks:
    * CharTemplate? rework (and many files related to race/class)
    * Classmaster rework (new configs)
        - Give available skills
        - Give noblesse
        - Do the old stuff he did before but better :D
    * VillageMaster? rework
        - Give now the possibility to rename pledges
        - All subclass options are reworked
        - One VillageMaster? as "core" of multiple VillageMaster? instances (to handle class/race restrictions).

DP side:
    * npc.sql to drop and change
    * many htm to put in good place.

The classmaster have been verified, about subclass I'm not in fond of admin commands so I didn't know how to give quests items (lol), so couldn't test (arg).

Htm have been c/ped from Freya and put in form, so shouldn't have problem.

Didn't test pledges names, but should work, if I didn't miss anything database sided.

====================================================================================================
Changeset 43 @ 2011.01.30

- Refactor of DecayTaskManager? (added different delays according of RB/spoiled-seeded/normal mobs);
- Moved pvpflag from L2Character to L2PcInstance;
- Added the condition to drain corpse ("corpse is too old" message if you drain too late).
- *forgotten to say on commit* Animation timer for NPC social actions (6 seconds minimum before each packet send)

I just saw some effects like Sting still continue to show a "has resisted your" blank message. Don't cry on forum then :P.[/list]

====================================================================================================
Changeset 42 @ 2011.01.30

- summons cast formulas changed (need to recode XML to get summons and see if I don't fock soemthing...)
- "has resisted" messages corrected
- isUndead() have been modified. No more values in SQL, it directly does the calcul on Race.UNDEAD. If you don't want to drop your npc.sql, design your table and remove the isUndead column.

====================================================================================================
Changeset 41 @ 2011.01.28

Some random corrections

Ty SweeTs for skills reports, I wait more :).

- Insane damage on some skills: cAtk => cAtkAdd (corrected 2 skills);
- Relax effect debugged (chameleon rest is affected aswell).
- Added an aggression intention on TargetMe? effect (affect only L2PcInstance, mobs have their own aggro system based on points);

- Added some L2SkillTypes as pvpskills (aggression, manadamage,...). Check L2Skill.
- Deletion of Universe (useless stuff). Even Chuck Norris can't do it.
- Basic (-'"*correction*"'-) for statBonus, but I had a whiner for that. Better to (-'"*correct*"'-) before I got a second.
- Added back the 2 peaceful areas (ITower and central rift room), ty Sim.
- Added the database_installer for linux type. Ty Vrugar for complete rework/tests.

====================================================================================================
Changeset 40 @ 2011.01.26

Skill refactor, part 1 on... Dunno

Sooo, here it is: skills refactor.

Where to begin... Well, I won't do a list of what is it corrected. Just understand it's a 13k patch line (without counting datapack, modifying AIs, L2Character, L2Skill in their globality). Let's jump directly to issues I know, and what you haven't to report.

- "storeSkill() couldn't store blabla" message is because many skills are missing. It comes only at load of any characters.
- the huge list of GS errors is due to restricted items which need a full refactor. Basically I have to refactor entirely items load (use XMLs instead of SQLs tables).
- ingame, you should miss many skills. Once again skills aren't all rewritten, you got 1/6 of skills (or so ?). So test skills you see, and don't bother with missing ones.
- an issue about monsters exists. You have to stop to make mobs spawn. If you walk/run all time, you won't met any mob. This is due to ValidatePosition? rework, some other work is needed to make it work back. You will live until I rework, aren't you ?
- as you perhaps don't know, many items (soe, etc) use skills to be casted. As they miss, the result is a NPE each time you use an item using a skill. In the same order of idea, as armors sets / weapons SAs use skills, some GS infos can come about missing datapack skill (armorlistener blabla).

Now the good part:

test each rewritten skill, and tell me if the current behavior should be modified. You have to test each skill one by one, and if possible to check XML about effects (as I used Freya XMLs, I know some errors are existing).

I have to remember to you each XML have to be rewritten, and items have to be refactored (so others XMLs...). Topic about missing skill or error reported in this comment will be eradicated from forum without any type of warning.

Old XMLs skills have to been deleted, and replaced by the 4 shared in this commit. Two SQLs tables have to be deleted aswell and replaced with new ones. There aren't issues to delete them.

If you find errors about:

XML: post in datapack section.
GS errors launching a *REWRITTEN* skill: post in core section.

====================================================================================================
Changeset 38 / 39 @ 2011.01.18

Augmentation packets rework, Max lvl fix

Can loose % if reached lvl 80 & 100%;
Can apply all types of LS on any type of weapon.

====================================================================================================
Changeset 37 @ 2011.01.10

Zones updates (692 overall)

- deletion of many useless vertices from Gracia++;
- deletion of some areas which aren't supposed to be Peace Zone (rift public room, Ivory Tower).
- correction of the 2 stupids castle areas which asked for cuboid parameters when they where NPoly. No more areas bugs logs.

====================================================================================================
Changeset 36 @ 2011.01.10

BaseStats add
    - Basically, go with the 2 last commits in the "don't care" section o_o.
    - It uses a new file, located in data/stats, and named statBonus.xml (else you got massive error, so easy to remember it).

Others
    - Remove of double setCurrent(HP/CP/MP) in L2PcInstance restore() method (need perhaps more tests about);
    - "Debug" of AutoLootRaid (it was a missing space, don't write "true "... I tested it is working);
    - Added some limits which were missing (max runspd limit was totally missing, max critical rate was fixed to 500);

====================================================================================================
Changeset 34/35 @ 2011.01.10

L2SkillType / L2EffectType refactor

Both are needed in future. Check changesets if you want, there shouldn't have nothing to test about.

====================================================================================================
Changeset 33 @ 2011.01.08

ChatHandlers refactor

As PartyMatching doesn't move '-_- (no one help with those packets), I commit a little one.

Add blocklist check on all, trade and shout trades.
Add checks on Say2, rewrite some parts of chat handlers aswell (using collections, this sort of stuff).
Add L2Walker protection, based on keywords. Option put on "False" by default, server.properties.
Finally, deletion of social actions custom. It was too much primitive and bad coded.

About L2W protection, if it isn't working, give me IL L2W commands. I based my hope they didn't change it from IL to Freya. Share section is your friend else.

====================================================================================================
Changeset 32 @ 2011.01.07

Trade commit

Fix a lot of things, add many checks, "freeze" many data. Thx to Chr.Trance about scam exploit report & some parts of fix code.

You have to test Trade, Buy & Sell shop. Do a lot of tests, as code is "semi-experimental". Be aware about both seller and buyer amount of adenas. I did a couple of tests and normally all work fine, but still, test :>.

The maximum amount in a trade is 1,999,999,999. It takes in consideration both price and amount. You can't sell 1 item for 2kkk, as you can't sell 4 items 500kk each, etc.

====================================================================================================
Changeset 31 @ 2011.01.06

Logs rework
    - Refactored (use StringUtil instead of TextBuilder)
    - Cleaned (moved them into log folder).

====================================================================================================
Changeset 30 @ 2011.01.06

Faenor & events deletion

Who uses that anyway ? Delete both event engine and Faenor (compiledScript like Valentines.zip) stuff. You're now free to put any event engine you like.

Report on forum if anything occurs.

====================================================================================================
Changeset 29 @ 2011.01.06

CharacterCreate packet rework.

====================================================================================================
Changeset 28 @ 2011.01.04

AccessLevel rework
    - Deletion of the two ancient systems to add the new one. It uses 2 new tables, one for admincommandhandlers, the other for the different access states.
    - By default, the "root" access is 127. He got all rights, and can't be modified via configs. Others accesses are from 1 to 5, you can customize them as you want (rights, colors, title names,...). 0 is for normal user.
    - By default, all commands are put to 1. Need more infos about the child access system. Well, play with buttons to make priviledges work.
    - At your first login, and if you didn't change your access in characters table, your access should be reseted to 0, as 100 isn't a right access number (by default: 1, 2, 3, 4, 5 & 127). So before log, change it in your db.

Others changes:
    - GMAudit model have been moved to util folder. It's used actually only for admincommandhandler.
    - getMessageRefusal() & setMessageRefusal() have been modified to isInRefusalMode() & setInRefusalMode()
    - dietMode have been deleted (GM stuff). If you want to wear a lot of items, MAKE A DWARF! Their dances are funny too...
    - Deleted FightCalculator? stuff. Except if someone explain me the use of it.

I have to warn you: many "links" to commands are bugged. As I use the Freya SQLs, and as many commands have been modified between this time and IL, some commands will be shown as "non existing handler for command admin_xxxxx". I wait the commands refactor to care about (and the html part need a total relook too).

So make a single error thread in forum, & report all missing commands to help all users.

====================================================================================================
